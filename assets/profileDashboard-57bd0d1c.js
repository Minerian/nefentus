import{r as t,e as R,M as z,f as L,v as j,j as s,C as G,S as H,z as O,q as Q}from"./index-c9329193.js";import{S as W}from"./signupByEmail-82a12497.js";import"./recaptcha-wrapper-ed08ea1d.js";import"./zod-759f93f6.js";import"./error-3c144da9.js";const X="_card_104qm_1",Y="_button_104qm_7",Z={card:X,button:Y},ee=()=>{const[r,u]=t.useState(localStorage.getItem("firstName")),[i,p]=t.useState(localStorage.getItem("lastName")),[g,f]=t.useState(localStorage.getItem("business")),[n,m]=t.useState(localStorage.getItem("phoneNumber")),[o,d]=t.useState(localStorage.getItem("country")),[S,b]=t.useState(localStorage.getItem("email")),[P,N]=t.useState(null),[y,C]=t.useState(localStorage.getItem("marketingUpdates")==="true"),[$,q]=t.useState(localStorage.getItem("emailNotifications")==="true"),[w,_]=t.useState(localStorage.getItem("appNotifications")==="true"),[h,U]=t.useState(localStorage.getItem("notificationLanguage")),[k,A]=t.useState(localStorage.getItem("enableInvoicing")==="true"),[V,v]=t.useState(!1),[l,M]=t.useState(null),[I,x]=t.useState(!1),{t:e}=R(),{setErrorMessage:D,setInfoMessage:K}=t.useContext(z),c=new L,F=j(),T=async()=>{const a={firstName:r,lastName:i,phoneNumber:n,email:S,country:o,business:g||"",marketingUpdates:y,emailNotifications:$,appNotifications:w,notificationLanguage:h,enableInvoicing:k},E=await c.update(a);E==null&&(D(e("messages.error.updateData")),await c.signout(),setTimeout(()=>{F("/")},1e3)),E!==null&&K(e("messages.success.updateSettings")),v(!1)},B=async()=>{if(I){let a;l?a=await c.uploadFile(l):a=await c.deleteProfileImage(l),a==null&&D(e("messages.error.uploadPicture")),x(!1),v(!1)}};t.useEffect(()=>{V&&(I?B():T())},[V]);const J=[{label:`${e("profile.firstName").concat("*")}`,description:"",value:r,setValue:u,type:"edit"},{label:`${e("profile.lastName").concat("*")}`,description:"",value:i,setValue:p,type:"edit"},{label:`${e("profile.business").concat("*")}`,description:`${e("profile.businessDescription")}`,value:g,setValue:f,type:"edit"},{label:`${e("profile.email").concat("*")}`,description:"",value:S,setValue:b,type:"edit"},{label:`${e("profile.phoneNumber").concat("*")}`,description:"",value:n,setValue:m,type:"edit"},{label:`${e("profile.country").concat("*")}`,description:"",value:o,setValue:d,type:"select"},{label:`${e("profile.avatar")}`,description:`${e("profile.avatarDescription").concat("*")}`,value:P,setValue:N,type:"image",file:l,setFile:M,imageChanged:I,setImageChanged:x},{label:`${e("profile.marketingUpdates")}`,description:`${e("profile.marketingUpdatesDescription")}`,value:y,setValue:C,type:"enable"},{label:`${e("profile.emailNotifications")}`,description:`${e("profile.emailNotificationsDescription")}`,value:$,setValue:q,type:"enable"},{label:`${e("profile.appNotifications")}`,description:`${e("profile.appNotificationsDescription")}`,value:w,setValue:_,type:"enable"},{label:`${e("profile.notificationLanguage")}`,description:`${e("profile.notificationLanguageDescription")}`,value:h,setValue:U,popup:"language",type:"edit"},{label:`${e("profile.enableInvoicing")}`,description:`${e("profile.enableInvoicingDescription")}`,value:k,setValue:A,type:"enable"}];return t.useEffect(()=>{const a=localStorage.getItem("profile_pic");a!=="null"&&N(a)},[]),s.jsxs(G,{className:Z.card,children:[s.jsx(H,{title:e("profile.title"),description:e("profile.description")}),J.map(a=>s.jsx(O,{data:a,setIsSaveData:v}))]})},ne=()=>{const[r,u]=t.useState(localStorage.getItem("requireKyc")),[i,p]=t.useState(0),[g,f]=t.useState(null),n=j(),m=new L;return t.useEffect(()=>{const o=()=>{setProfilePicUrl(localStorage.getItem("profile_pic")),p(i+1),u(localStorage.setItem("requireKyc"))};async function d(){if(await m.checkJwt()){const b=Q(localStorage);f(b)}else n("/login")}return d(),window.addEventListener("storage",o),()=>{window.removeEventListener("storage",o)}},[i]),s.jsxs("div",{children:[s.jsx(ee,{}),s.jsx(W,{})]})};export{ne as default};
