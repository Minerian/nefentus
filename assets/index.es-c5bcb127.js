import{cm as Ai,cn as Sr,co as _m,cp as ym,cq as _r,cr,cs as Vc,ct as vm,aH as mm,cu as kl,aT as bm}from"./index-c9329193.js";import{e as jr,N as Iu}from"./events-92bfd099.js";var Ko={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kc=function(n,e){return kc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},kc(n,e)};function wm(n,e){kc(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Wc=function(){return Wc=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Wc.apply(this,arguments)};function Em(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Sm(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var d=n.length-1;d>=0;d--)(l=n[d])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Im(n,e){return function(t,s){e(t,s,n)}}function Om(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function xm(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(w){try{p(s.next(w))}catch(T){l(T)}}function _(w){try{p(s.throw(w))}catch(T){l(T)}}function p(w){w.done?c(w.value):o(w.value).then(d,_)}p((s=s.apply(n,e||[])).next())})}function Pm(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(w){return _([p,w])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Tm(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function Am(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Yc(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Id(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(d){l={error:d}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Rm(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Id(arguments[e]));return n}function Nm(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,d=c.length;l<d;l++,o++)s[o]=c[l];return s}function ps(n){return this instanceof ps?(this.v=n,this):new ps(n)}function Cm(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||d(S,P)})})}function d(S,P){try{_(s[S](P))}catch(M){T(c[0][3],M)}}function _(S){S.value instanceof ps?Promise.resolve(S.value.v).then(p,w):T(c[0][2],S)}function p(S){d("next",S)}function w(S){d("throw",S)}function T(S,P){S(P),c.shift(),c.length&&d(c[0][0],c[0][1])}}function $m(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:ps(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function Dm(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Yc=="function"?Yc(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(d,_){l=n[c](l),o(d,_,l.done,l.value)})}}function o(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function Um(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Lm(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function jm(n){return n&&n.__esModule?n:{default:n}}function Fm(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function Mm(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const Hm=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Wc},__asyncDelegator:$m,__asyncGenerator:Cm,__asyncValues:Dm,__await:ps,__awaiter:xm,__classPrivateFieldGet:Fm,__classPrivateFieldSet:Mm,__createBinding:Tm,__decorate:Sm,__exportStar:Am,__extends:wm,__generator:Pm,__importDefault:jm,__importStar:Lm,__makeTemplateObject:Um,__metadata:Om,__param:Im,__read:Id,__rest:Em,__spread:Rm,__spreadArrays:Nm,__values:Yc},Symbol.toStringTag,{value:"Module"})),Od=Ai(Hm);var ws={};Object.defineProperty(ws,"__esModule",{value:!0});function qm(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}ws.safeJsonParse=qm;function zm(n){return typeof n=="string"?n:JSON.stringify(n,(e,t)=>typeof t>"u"?null:t)}ws.safeJsonStringify=zm;var Zi={exports:{}},Wl;function Bm(){return Wl||(Wl=1,function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,s){this[t]=String(s)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Sr<"u"&&Sr.localStorage?Zi.exports=Sr.localStorage:typeof window<"u"&&window.localStorage?Zi.exports=window.localStorage:Zi.exports=new e}()),Zi.exports}var Pc={},es={},Yl;function Km(){if(Yl)return es;Yl=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IKeyValueStorage=void 0;class n{}return es.IKeyValueStorage=n,es}var ts={},Jl;function Gm(){if(Jl)return ts;Jl=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.parseEntry=void 0;const n=ws;function e(t){var s;return[t[0],n.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return ts.parseEntry=e,ts}var Xl;function Vm(){return Xl||(Xl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Od;e.__exportStar(Km(),n),e.__exportStar(Gm(),n)}(Pc)),Pc}Object.defineProperty(Ko,"__esModule",{value:!0});Ko.KeyValueStorage=void 0;const Oi=Od,Ql=ws,km=Oi.__importDefault(Bm()),Wm=Vm();class xd{constructor(){this.localStorage=km.default}getKeys(){return Oi.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Oi.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Wm.parseEntry)})}getItem(e){return Oi.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return Ql.safeJsonParse(t)})}setItem(e,t){return Oi.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Ql.safeJsonStringify(t))})}removeItem(e){return Oi.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Ko.KeyValueStorage=xd;var Ym=Ko.default=xd,Ri={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Jc=function(n,e){return Jc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Jc(n,e)};function Jm(n,e){Jc(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Xc=function(){return Xc=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Xc.apply(this,arguments)};function Xm(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Qm(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var d=n.length-1;d>=0;d--)(l=n[d])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Zm(n,e){return function(t,s){e(t,s,n)}}function eb(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function tb(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(w){try{p(s.next(w))}catch(T){l(T)}}function _(w){try{p(s.throw(w))}catch(T){l(T)}}function p(w){w.done?c(w.value):o(w.value).then(d,_)}p((s=s.apply(n,e||[])).next())})}function rb(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(w){return _([p,w])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function nb(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function ib(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Qc(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pd(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(d){l={error:d}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function sb(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Pd(arguments[e]));return n}function ob(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,d=c.length;l<d;l++,o++)s[o]=c[l];return s}function gs(n){return this instanceof gs?(this.v=n,this):new gs(n)}function ab(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||d(S,P)})})}function d(S,P){try{_(s[S](P))}catch(M){T(c[0][3],M)}}function _(S){S.value instanceof gs?Promise.resolve(S.value.v).then(p,w):T(c[0][2],S)}function p(S){d("next",S)}function w(S){d("throw",S)}function T(S,P){S(P),c.shift(),c.length&&d(c[0][0],c[0][1])}}function cb(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:gs(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function ub(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Qc=="function"?Qc(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(d,_){l=n[c](l),o(d,_,l.done,l.value)})}}function o(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function hb(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function lb(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function fb(n){return n&&n.__esModule?n:{default:n}}function db(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function pb(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const gb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Xc},__asyncDelegator:cb,__asyncGenerator:ab,__asyncValues:ub,__await:gs,__awaiter:tb,__classPrivateFieldGet:db,__classPrivateFieldSet:pb,__createBinding:nb,__decorate:Qm,__exportStar:ib,__extends:Jm,__generator:rb,__importDefault:fb,__importStar:lb,__makeTemplateObject:hb,__metadata:eb,__param:Zm,__read:Pd,__rest:Xm,__spread:sb,__spreadArrays:ob,__values:Qc},Symbol.toStringTag,{value:"Module"})),Go=Ai(gb);var rs={},_e={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Zc=function(n,e){return Zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Zc(n,e)};function _b(n,e){Zc(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var eu=function(){return eu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},eu.apply(this,arguments)};function yb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function vb(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var d=n.length-1;d>=0;d--)(l=n[d])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function mb(n,e){return function(t,s){e(t,s,n)}}function bb(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function wb(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(w){try{p(s.next(w))}catch(T){l(T)}}function _(w){try{p(s.throw(w))}catch(T){l(T)}}function p(w){w.done?c(w.value):o(w.value).then(d,_)}p((s=s.apply(n,e||[])).next())})}function Eb(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(w){return _([p,w])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Sb(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function Ib(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function tu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Td(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(d){l={error:d}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Ob(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Td(arguments[e]));return n}function xb(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,d=c.length;l<d;l++,o++)s[o]=c[l];return s}function _s(n){return this instanceof _s?(this.v=n,this):new _s(n)}function Pb(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||d(S,P)})})}function d(S,P){try{_(s[S](P))}catch(M){T(c[0][3],M)}}function _(S){S.value instanceof _s?Promise.resolve(S.value.v).then(p,w):T(c[0][2],S)}function p(S){d("next",S)}function w(S){d("throw",S)}function T(S,P){S(P),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Tb(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:_s(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function Ab(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof tu=="function"?tu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(d,_){l=n[c](l),o(d,_,l.done,l.value)})}}function o(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function Rb(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Nb(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function Cb(n){return n&&n.__esModule?n:{default:n}}function $b(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function Db(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const Ub=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return eu},__asyncDelegator:Tb,__asyncGenerator:Pb,__asyncValues:Ab,__await:_s,__awaiter:wb,__classPrivateFieldGet:$b,__classPrivateFieldSet:Db,__createBinding:Sb,__decorate:vb,__exportStar:Ib,__extends:_b,__generator:Eb,__importDefault:Cb,__importStar:Nb,__makeTemplateObject:Rb,__metadata:bb,__param:mb,__read:Td,__rest:yb,__spread:Ob,__spreadArrays:xb,__values:tu},Symbol.toStringTag,{value:"Module"})),Vo=Ai(Ub);var Tc={},ns={},Zl;function Lb(){if(Zl)return ns;Zl=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.delay=void 0;function n(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ns.delay=n,ns}var Yn={},Ac={},Jn={},ef;function jb(){return ef||(ef=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.ONE_THOUSAND=Jn.ONE_HUNDRED=void 0,Jn.ONE_HUNDRED=100,Jn.ONE_THOUSAND=1e3),Jn}var Rc={},tf;function Fb(){return tf||(tf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Rc)),Rc}var rf;function Ad(){return rf||(rf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Vo;e.__exportStar(jb(),n),e.__exportStar(Fb(),n)}(Ac)),Ac}var nf;function Mb(){if(nf)return Yn;nf=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.fromMiliseconds=Yn.toMiliseconds=void 0;const n=Ad();function e(s){return s*n.ONE_THOUSAND}Yn.toMiliseconds=e;function t(s){return Math.floor(s/n.ONE_THOUSAND)}return Yn.fromMiliseconds=t,Yn}var sf;function Hb(){return sf||(sf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Vo;e.__exportStar(Lb(),n),e.__exportStar(Mb(),n)}(Tc)),Tc}var Ii={},of;function qb(){if(of)return Ii;of=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Ii.Watch=n,Ii.default=n,Ii}var Nc={},is={},af;function zb(){if(af)return is;af=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IWatch=void 0;class n{}return is.IWatch=n,is}var cf;function Bb(){return cf||(cf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Vo.__exportStar(zb(),n)}(Nc)),Nc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Vo;e.__exportStar(Hb(),n),e.__exportStar(qb(),n),e.__exportStar(Bb(),n),e.__exportStar(Ad(),n)})(_e);var Cc={},ss={};let ei=class{};const Kb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ei},Symbol.toStringTag,{value:"Module"})),Gb=Ai(Kb);var uf;function Vb(){if(uf)return ss;uf=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.IHeartBeat=void 0;const n=Gb;class e extends n.IEvents{constructor(s){super()}}return ss.IHeartBeat=e,ss}var hf;function Rd(){return hf||(hf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Go.__exportStar(Vb(),n)}(Cc)),Cc}var $c={},Xn={},lf;function kb(){if(lf)return Xn;lf=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.HEARTBEAT_EVENTS=Xn.HEARTBEAT_INTERVAL=void 0;const n=_e;return Xn.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Xn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Xn}var ff;function Nd(){return ff||(ff=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Go.__exportStar(kb(),n)}($c)),$c}var df;function Wb(){if(df)return rs;df=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.HeartBeat=void 0;const n=Go,e=jr,t=_e,s=Rd(),o=Nd();class c extends s.IHeartBeat{constructor(d){super(d),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||o.HEARTBEAT_INTERVAL}static init(d){return n.__awaiter(this,void 0,void 0,function*(){const _=new c(d);return yield _.init(),_})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,_){this.events.on(d,_)}once(d,_){this.events.once(d,_)}off(d,_){this.events.off(d,_)}removeListener(d,_){this.events.removeListener(d,_)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return rs.HeartBeat=c,rs}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Go;e.__exportStar(Wb(),n),e.__exportStar(Rd(),n),e.__exportStar(Nd(),n)})(Ri);var Ze={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ru=function(n,e){return ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},ru(n,e)};function Yb(n,e){ru(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var nu=function(){return nu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},nu.apply(this,arguments)};function Jb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Xb(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var d=n.length-1;d>=0;d--)(l=n[d])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Qb(n,e){return function(t,s){e(t,s,n)}}function Zb(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function ew(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(w){try{p(s.next(w))}catch(T){l(T)}}function _(w){try{p(s.throw(w))}catch(T){l(T)}}function p(w){w.done?c(w.value):o(w.value).then(d,_)}p((s=s.apply(n,e||[])).next())})}function tw(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(w){return _([p,w])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function rw(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function nw(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function iu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cd(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(d){l={error:d}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function iw(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Cd(arguments[e]));return n}function sw(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,d=c.length;l<d;l++,o++)s[o]=c[l];return s}function ys(n){return this instanceof ys?(this.v=n,this):new ys(n)}function ow(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||d(S,P)})})}function d(S,P){try{_(s[S](P))}catch(M){T(c[0][3],M)}}function _(S){S.value instanceof ys?Promise.resolve(S.value.v).then(p,w):T(c[0][2],S)}function p(S){d("next",S)}function w(S){d("throw",S)}function T(S,P){S(P),c.shift(),c.length&&d(c[0][0],c[0][1])}}function aw(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:ys(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function cw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof iu=="function"?iu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(d,_){l=n[c](l),o(d,_,l.done,l.value)})}}function o(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function uw(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function hw(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function lw(n){return n&&n.__esModule?n:{default:n}}function fw(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function dw(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const pw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return nu},__asyncDelegator:aw,__asyncGenerator:ow,__asyncValues:cw,__await:ys,__awaiter:ew,__classPrivateFieldGet:fw,__classPrivateFieldSet:dw,__createBinding:rw,__decorate:Xb,__exportStar:nw,__extends:Yb,__generator:tw,__importDefault:lw,__importStar:hw,__makeTemplateObject:uw,__metadata:Zb,__param:Qb,__read:Cd,__rest:Jb,__spread:iw,__spreadArrays:sw,__values:iu},Symbol.toStringTag,{value:"Module"})),gw=Ai(pw);var Dc,pf;function _w(){if(pf)return Dc;pf=1;function n(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Dc=e;function e(t,s,o){var c=o&&o.stringify||n,l=1;if(typeof t=="object"&&t!==null){var d=s.length+l;if(d===1)return t;var _=new Array(d);_[0]=c(t);for(var p=1;p<d;p++)_[p]=c(s[p]);return _.join(" ")}if(typeof t!="string")return t;var w=s.length;if(w===0)return t;for(var T="",S=1-l,P=-1,M=t&&t.length||0,B=0;B<M;){if(t.charCodeAt(B)===37&&B+1<M){switch(P=P>-1?P:0,t.charCodeAt(B+1)){case 100:case 102:if(S>=w||s[S]==null)break;P<B&&(T+=t.slice(P,B)),T+=Number(s[S]),P=B+2,B++;break;case 105:if(S>=w||s[S]==null)break;P<B&&(T+=t.slice(P,B)),T+=Math.floor(Number(s[S])),P=B+2,B++;break;case 79:case 111:case 106:if(S>=w||s[S]===void 0)break;P<B&&(T+=t.slice(P,B));var K=typeof s[S];if(K==="string"){T+="'"+s[S]+"'",P=B+2,B++;break}if(K==="function"){T+=s[S].name||"<anonymous>",P=B+2,B++;break}T+=c(s[S]),P=B+2,B++;break;case 115:if(S>=w)break;P<B&&(T+=t.slice(P,B)),T+=String(s[S]),P=B+2,B++;break;case 37:P<B&&(T+=t.slice(P,B)),T+="%",P=B+2,B++,S--;break}++S}++B}return P===-1?t:(P<M&&(T+=t.slice(P)),T)}return Dc}var Uc,gf;function yw(){if(gf)return Uc;gf=1;const n=_w();Uc=o;const e=R().console||{},t={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:M,res:M,err:S};function s(b,h){return Array.isArray(b)?b.filter(function(k){return k!=="!stdSerializers.err"}):b===!0?Object.keys(h):!1}function o(b){b=b||{},b.browser=b.browser||{};const h=b.browser.transmit;if(h&&typeof h.send!="function")throw Error("pino: transmit option must have a send function");const m=b.browser.write||e;b.browser.write&&(b.browser.asObject=!0);const k=b.serializers||{},V=s(b.browser.serialize,k);let se=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof m=="function"&&(m.error=m.fatal=m.warn=m.info=m.debug=m.trace=m),b.enabled===!1&&(b.level="silent");const ge=b.level||"info",$=Object.create(m);$.log||($.log=K),Object.defineProperty($,"levelVal",{get:le}),Object.defineProperty($,"level",{get:te,set:W});const q={transmit:h,serialize:V,asObject:b.browser.asObject,levels:ce,timestamp:P(b)};$.levels=o.levels,$.level=ge,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=K,$.serializers=k,$._serialize=V,$._stdErrSerialize=se,$.child=ee,h&&($._logEvent=T());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c(q,$,"error","log"),c(q,$,"fatal","error"),c(q,$,"warn","error"),c(q,$,"info","log"),c(q,$,"debug","log"),c(q,$,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},V&&Y.serializers&&(re.serializers=Y.serializers);const xe=re.serializers;if(V&&xe){var ne=Object.assign({},k,xe),be=b.browser.serialize===!0?Object.keys(ne):V;delete Y.serializers,_([Y],be,ne,this._stdErrSerialize)}function he(ve){this._childLevel=(ve._childLevel|0)+1,this.error=p(ve,Y,"error"),this.fatal=p(ve,Y,"fatal"),this.warn=p(ve,Y,"warn"),this.info=p(ve,Y,"info"),this.debug=p(ve,Y,"debug"),this.trace=p(ve,Y,"trace"),ne&&(this.serializers=ne,this._serialize=be),h&&(this._logEvent=T([].concat(ve._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return $}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:oe,epochTime:C,unixTime:j,isoTime:O});function c(b,h,m,k){const V=Object.getPrototypeOf(h);h[m]=h.levelVal>h.levels.values[m]?K:V[m]?V[m]:e[m]||e[k]||K,l(b,h,m)}function l(b,h,m){!b.transmit&&h[m]===K||(h[m]=function(k){return function(){const se=b.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<ce.length;$++)ce[$]=arguments[$];if(b.serialize&&!b.asObject&&_(ce,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?k.call(ge,d(this,m,ce,se)):k.apply(ge,ce),b.transmit){const q=b.transmit.level||h.level,le=o.levels.values[q],te=o.levels.values[m];if(te<le)return;w(this,{ts:se,methodLevel:m,methodValue:te,transmitLevel:q,transmitValue:o.levels.values[b.transmit.level||h.level],send:b.transmit.send,val:h.levelVal},ce)}}}(h[m]))}function d(b,h,m,k){b._serialize&&_(m,b._serialize,b.serializers,b._stdErrSerialize);const V=m.slice();let se=V[0];const ce={};k&&(ce.time=k),ce.level=o.levels.values[h];let ge=(b._childLevel|0)+1;if(ge<1&&(ge=1),se!==null&&typeof se=="object"){for(;ge--&&typeof V[0]=="object";)Object.assign(ce,V.shift());se=V.length?n(V.shift(),V):void 0}else typeof se=="string"&&(se=n(V.shift(),V));return se!==void 0&&(ce.msg=se),ce}function _(b,h,m,k){for(const V in b)if(k&&b[V]instanceof Error)b[V]=o.stdSerializers.err(b[V]);else if(typeof b[V]=="object"&&!Array.isArray(b[V]))for(const se in b[V])h&&h.indexOf(se)>-1&&se in m&&(b[V][se]=m[se](b[V][se]))}function p(b,h,m){return function(){const k=new Array(1+arguments.length);k[0]=h;for(var V=1;V<k.length;V++)k[V]=arguments[V-1];return b[m].apply(this,k)}}function w(b,h,m){const k=h.send,V=h.ts,se=h.methodLevel,ce=h.methodValue,ge=h.val,$=b._logEvent.bindings;_(m,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=V,b._logEvent.messages=m.filter(function(q){return $.indexOf(q)===-1}),b._logEvent.level.label=se,b._logEvent.level.value=ce,k(se,b._logEvent,ge),b._logEvent=T($)}function T(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function S(b){const h={type:b.constructor.name,msg:b.message,stack:b.stack};for(const m in b)h[m]===void 0&&(h[m]=b[m]);return h}function P(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?oe:C}function M(){return{}}function B(b){return b}function K(){}function oe(){return!1}function C(){return Date.now()}function j(){return Math.round(Date.now()/1e3)}function O(){return new Date(Date.now()).toISOString()}function R(){function b(h){return typeof h<"u"&&h}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return Uc}var Qn={},_f;function $d(){return _f||(_f=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.PINO_CUSTOM_CONTEXT_KEY=Qn.PINO_LOGGER_DEFAULTS=void 0,Qn.PINO_LOGGER_DEFAULTS={level:"info"},Qn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Qn}var sr={},yf;function vw(){if(yf)return sr;yf=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.generateChildLogger=sr.formatChildLoggerContext=sr.getLoggerContext=sr.setBrowserLoggerContext=sr.getBrowserLoggerContext=sr.getDefaultLoggerOptions=void 0;const n=$d();function e(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||n.PINO_LOGGER_DEFAULTS.level})}sr.getDefaultLoggerOptions=e;function t(d,_=n.PINO_CUSTOM_CONTEXT_KEY){return d[_]||""}sr.getBrowserLoggerContext=t;function s(d,_,p=n.PINO_CUSTOM_CONTEXT_KEY){return d[p]=_,d}sr.setBrowserLoggerContext=s;function o(d,_=n.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof d.bindings>"u"?p=t(d,_):p=d.bindings().context||"",p}sr.getLoggerContext=o;function c(d,_,p=n.PINO_CUSTOM_CONTEXT_KEY){const w=o(d,p);return w.trim()?`${w}/${_}`:_}sr.formatChildLoggerContext=c;function l(d,_,p=n.PINO_CUSTOM_CONTEXT_KEY){const w=c(d,_,p),T=d.child({context:w});return s(T,w,p)}return sr.generateChildLogger=l,sr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=gw,t=e.__importDefault(yw());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar($d(),n),e.__exportStar(vw(),n)})(Ze);class mw extends ei{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class bw extends ei{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class ww{constructor(e,t){this.logger=e,this.core=t}}let Ew=class extends ei{constructor(e,t){super(),this.relayer=e,this.logger=t}},Sw=class extends ei{constructor(e){super()}},Iw=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class Ow extends ei{constructor(e,t){super(),this.relayer=e,this.logger=t}}let xw=class extends ei{constructor(e,t){super(),this.core=e,this.logger=t}},Pw=class{constructor(e,t){this.projectId=e,this.logger=t}},Tw=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},Aw=class{constructor(e){this.client=e}};const Rw=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Nw=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ou(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Nw(n)}catch{return n}}function vs(n){return typeof n=="string"?n:Rw(n)||""}var xu={},Ni={},ko={},Wo={};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.BrowserRandomSource=void 0;const vf=65536;class Cw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=vf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,vf)));return t}}Wo.BrowserRandomSource=Cw;var Yo={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});function $w(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Ir.wipe=$w;Object.defineProperty(Yo,"__esModule",{value:!0});Yo.NodeRandomSource=void 0;const Dw=Ir;class Uw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof _m<"u"){const e=ym;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,Dw.wipe)(t),s}}Yo.NodeRandomSource=Uw;Object.defineProperty(ko,"__esModule",{value:!0});ko.SystemRandomSource=void 0;const Lw=Wo,jw=Yo;class Fw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Lw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new jw.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ko.SystemRandomSource=Fw;var Le={},Dd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(d,_){var p=d>>>16&65535,w=d&65535,T=_>>>16&65535,S=_&65535;return w*S+(p*S+w*T<<16>>>0)|0}n.mul=Math.imul||e;function t(d,_){return d+_|0}n.add=t;function s(d,_){return d-_|0}n.sub=s;function o(d,_){return d<<_|d>>>32-_}n.rotl=o;function c(d,_){return d<<32-_|d>>>_}n.rotr=c;function l(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}n.isInteger=Number.isInteger||l,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(d){return n.isInteger(d)&&d>=-n.MAX_SAFE_INTEGER&&d<=n.MAX_SAFE_INTEGER}})(Dd);Object.defineProperty(Le,"__esModule",{value:!0});var Ud=Dd;function Mw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Le.readInt16BE=Mw;function Hw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Le.readUint16BE=Hw;function qw(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Le.readInt16LE=qw;function zw(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Le.readUint16LE=zw;function Ld(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>8,e[t+1]=n>>>0,e}Le.writeUint16BE=Ld;Le.writeInt16BE=Ld;function jd(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e}Le.writeUint16LE=jd;Le.writeInt16LE=jd;function su(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Le.readInt32BE=su;function ou(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Le.readUint32BE=ou;function au(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Le.readInt32LE=au;function cu(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Le.readUint32LE=cu;function Lo(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>24,e[t+1]=n>>>16,e[t+2]=n>>>8,e[t+3]=n>>>0,e}Le.writeUint32BE=Lo;Le.writeInt32BE=Lo;function jo(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e[t+2]=n>>>16,e[t+3]=n>>>24,e}Le.writeUint32LE=jo;Le.writeInt32LE=jo;function Bw(n,e){e===void 0&&(e=0);var t=su(n,e),s=su(n,e+4);return t*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=Bw;function Kw(n,e){e===void 0&&(e=0);var t=ou(n,e),s=ou(n,e+4);return t*4294967296+s}Le.readUint64BE=Kw;function Gw(n,e){e===void 0&&(e=0);var t=au(n,e),s=au(n,e+4);return s*4294967296+t-(t>>31)*4294967296}Le.readInt64LE=Gw;function Vw(n,e){e===void 0&&(e=0);var t=cu(n,e),s=cu(n,e+4);return s*4294967296+t}Le.readUint64LE=Vw;function Fd(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Lo(n/4294967296>>>0,e,t),Lo(n>>>0,e,t+4),e}Le.writeUint64BE=Fd;Le.writeInt64BE=Fd;function Md(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),jo(n>>>0,e,t),jo(n/4294967296>>>0,e,t+4),e}Le.writeUint64LE=Md;Le.writeInt64LE=Md;function kw(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=n/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Le.readUintBE=kw;function Ww(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+n/8;c++)s+=e[c]*o,o*=256;return s}Le.readUintLE=Ww;function Yw(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ud.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=n/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Le.writeUintBE=Yw;function Jw(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ud.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+n/8;c++)t[c]=e/o&255,o*=256;return t}Le.writeUintLE=Jw;function Xw(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e)}Le.readFloat32BE=Xw;function Qw(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e,!0)}Le.readFloat32LE=Qw;function Zw(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e)}Le.readFloat64BE=Zw;function eE(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e,!0)}Le.readFloat64LE=eE;function tE(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n),e}Le.writeFloat32BE=tE;function rE(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n,!0),e}Le.writeFloat32LE=rE;function nE(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n),e}Le.writeFloat64BE=nE;function iE(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n,!0),e}Le.writeFloat64LE=iE;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=ko,t=Le,s=Ir;n.defaultRandomSource=new e.SystemRandomSource;function o(p,w=n.defaultRandomSource){return w.randomBytes(p)}n.randomBytes=o;function c(p=n.defaultRandomSource){const w=o(4,p),T=(0,t.readUint32LE)(w);return(0,s.wipe)(w),T}n.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(p,w=l,T=n.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let S="";const P=w.length,M=256-256%P;for(;p>0;){const B=o(Math.ceil(p*256/M),T);for(let K=0;K<B.length&&p>0;K++){const oe=B[K];oe<M&&(S+=w.charAt(oe%P),p--)}(0,s.wipe)(B)}return S}n.randomString=d;function _(p,w=l,T=n.defaultRandomSource){const S=Math.ceil(p/(Math.log(w.length)/Math.LN2));return d(S,w,T)}n.randomStringForEntropy=_})(Ni);var Hd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Le,t=Ir;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},d.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=_[w++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(w=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,w,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[w++],p--;return this},d.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,w=this._bufferLength,T=p/536870912|0,S=p<<3,P=p%128<112?128:256;this._buffer[w]=128;for(var M=w+1;M<P-8;M++)this._buffer[M]=0;e.writeUint32BE(T,this._buffer,P-8),e.writeUint32BE(S,this._buffer,P-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,P),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)e.writeUint32BE(this._stateHi[M],_,M*8),e.writeUint32BE(this._stateLo[M],_,M*8+4);return this},d.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},d}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(d,_,p,w,T,S,P){for(var M=p[0],B=p[1],K=p[2],oe=p[3],C=p[4],j=p[5],O=p[6],R=p[7],b=w[0],h=w[1],m=w[2],k=w[3],V=w[4],se=w[5],ce=w[6],ge=w[7],$,q,le,te,W,ee,Y,re;P>=128;){for(var xe=0;xe<16;xe++){var ne=8*xe+S;d[xe]=e.readUint32BE(T,ne),_[xe]=e.readUint32BE(T,ne+4)}for(var xe=0;xe<80;xe++){var be=M,he=B,ve=K,H=oe,F=C,N=j,f=O,x=R,ie=b,fe=h,Ie=m,ze=k,Ge=V,je=se,pt=ce,gt=ge;if($=R,q=ge,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=(C>>>14|V<<32-14)^(C>>>18|V<<32-18)^(V>>>41-32|C<<32-(41-32)),q=(V>>>14|C<<32-14)^(V>>>18|C<<32-18)^(C>>>41-32|V<<32-(41-32)),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=C&j^~C&O,q=V&se^~V&ce,W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=o[xe*2],q=o[xe*2+1],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=d[xe%16],q=_[xe%16],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,$=le,q=te,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=(M>>>28|b<<32-28)^(b>>>34-32|M<<32-(34-32))^(b>>>39-32|M<<32-(39-32)),q=(b>>>28|M<<32-28)^(M>>>34-32|b<<32-(34-32))^(M>>>39-32|b<<32-(39-32)),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,$=M&B^M&K^B&K,q=b&h^b&m^h&m,W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,x=Y&65535|re<<16,gt=W&65535|ee<<16,$=H,q=ze,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=le,q=te,W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,H=Y&65535|re<<16,ze=W&65535|ee<<16,B=be,K=he,oe=ve,C=H,j=F,O=N,R=f,M=x,h=ie,m=fe,k=Ie,V=ze,se=Ge,ce=je,ge=pt,b=gt,xe%16===15)for(var ne=0;ne<16;ne++)$=d[ne],q=_[ne],W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=d[(ne+9)%16],q=_[(ne+9)%16],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,le=d[(ne+1)%16],te=_[(ne+1)%16],$=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,q=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,le=d[(ne+14)%16],te=_[(ne+14)%16],$=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,q=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[ne]=Y&65535|re<<16,_[ne]=W&65535|ee<<16}$=M,q=b,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[0],q=w[0],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[0]=M=Y&65535|re<<16,w[0]=b=W&65535|ee<<16,$=B,q=h,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[1],q=w[1],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[1]=B=Y&65535|re<<16,w[1]=h=W&65535|ee<<16,$=K,q=m,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[2],q=w[2],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[2]=K=Y&65535|re<<16,w[2]=m=W&65535|ee<<16,$=oe,q=k,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[3],q=w[3],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[3]=oe=Y&65535|re<<16,w[3]=k=W&65535|ee<<16,$=C,q=V,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[4],q=w[4],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[4]=C=Y&65535|re<<16,w[4]=V=W&65535|ee<<16,$=j,q=se,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[5],q=w[5],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[5]=j=Y&65535|re<<16,w[5]=se=W&65535|ee<<16,$=O,q=ce,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[6],q=w[6],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[6]=O=Y&65535|re<<16,w[6]=ce=W&65535|ee<<16,$=R,q=ge,W=q&65535,ee=q>>>16,Y=$&65535,re=$>>>16,$=p[7],q=w[7],W+=q&65535,ee+=q>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[7]=R=Y&65535|re<<16,w[7]=ge=W&65535|ee<<16,S+=128,P-=128}return S}function l(d){var _=new s;_.update(d);var p=_.digest();return _.clean(),p}n.hash=l})(Hd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=Ni,t=Hd,s=Ir;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(H){const F=new Float64Array(16);if(H)for(let N=0;N<H.length;N++)F[N]=H[N];return F}const c=new Uint8Array(32);c[0]=9;const l=o(),d=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function P(H,F){for(let N=0;N<16;N++)H[N]=F[N]|0}function M(H){let F=1;for(let N=0;N<16;N++){let f=H[N]+F+65535;F=Math.floor(f/65536),H[N]=f-F*65536}H[0]+=F-1+37*(F-1)}function B(H,F,N){const f=~(N-1);for(let x=0;x<16;x++){const ie=f&(H[x]^F[x]);H[x]^=ie,F[x]^=ie}}function K(H,F){const N=o(),f=o();for(let x=0;x<16;x++)f[x]=F[x];M(f),M(f),M(f);for(let x=0;x<2;x++){N[0]=f[0]-65517;for(let fe=1;fe<15;fe++)N[fe]=f[fe]-65535-(N[fe-1]>>16&1),N[fe-1]&=65535;N[15]=f[15]-32767-(N[14]>>16&1);const ie=N[15]>>16&1;N[14]&=65535,B(f,N,1-ie)}for(let x=0;x<16;x++)H[2*x]=f[x]&255,H[2*x+1]=f[x]>>8}function oe(H,F){let N=0;for(let f=0;f<32;f++)N|=H[f]^F[f];return(1&N-1>>>8)-1}function C(H,F){const N=new Uint8Array(32),f=new Uint8Array(32);return K(N,H),K(f,F),oe(N,f)}function j(H){const F=new Uint8Array(32);return K(F,H),F[0]&1}function O(H,F){for(let N=0;N<16;N++)H[N]=F[2*N]+(F[2*N+1]<<8);H[15]&=32767}function R(H,F,N){for(let f=0;f<16;f++)H[f]=F[f]+N[f]}function b(H,F,N){for(let f=0;f<16;f++)H[f]=F[f]-N[f]}function h(H,F,N){let f,x,ie=0,fe=0,Ie=0,ze=0,Ge=0,je=0,pt=0,gt=0,Me=0,Oe=0,$e=0,De=0,He=0,Te=0,Ue=0,Se=0,Ae=0,Be=0,Pe=0,Ve=0,We=0,et=0,tt=0,Je=0,Zt=0,ur=0,Vr=0,er=0,rn=0,vn=0,Un=0,wt=N[0],_t=N[1],Et=N[2],St=N[3],mt=N[4],yt=N[5],Ut=N[6],Lt=N[7],It=N[8],jt=N[9],Ot=N[10],At=N[11],xt=N[12],ht=N[13],Ft=N[14],Mt=N[15];f=F[0],ie+=f*wt,fe+=f*_t,Ie+=f*Et,ze+=f*St,Ge+=f*mt,je+=f*yt,pt+=f*Ut,gt+=f*Lt,Me+=f*It,Oe+=f*jt,$e+=f*Ot,De+=f*At,He+=f*xt,Te+=f*ht,Ue+=f*Ft,Se+=f*Mt,f=F[1],fe+=f*wt,Ie+=f*_t,ze+=f*Et,Ge+=f*St,je+=f*mt,pt+=f*yt,gt+=f*Ut,Me+=f*Lt,Oe+=f*It,$e+=f*jt,De+=f*Ot,He+=f*At,Te+=f*xt,Ue+=f*ht,Se+=f*Ft,Ae+=f*Mt,f=F[2],Ie+=f*wt,ze+=f*_t,Ge+=f*Et,je+=f*St,pt+=f*mt,gt+=f*yt,Me+=f*Ut,Oe+=f*Lt,$e+=f*It,De+=f*jt,He+=f*Ot,Te+=f*At,Ue+=f*xt,Se+=f*ht,Ae+=f*Ft,Be+=f*Mt,f=F[3],ze+=f*wt,Ge+=f*_t,je+=f*Et,pt+=f*St,gt+=f*mt,Me+=f*yt,Oe+=f*Ut,$e+=f*Lt,De+=f*It,He+=f*jt,Te+=f*Ot,Ue+=f*At,Se+=f*xt,Ae+=f*ht,Be+=f*Ft,Pe+=f*Mt,f=F[4],Ge+=f*wt,je+=f*_t,pt+=f*Et,gt+=f*St,Me+=f*mt,Oe+=f*yt,$e+=f*Ut,De+=f*Lt,He+=f*It,Te+=f*jt,Ue+=f*Ot,Se+=f*At,Ae+=f*xt,Be+=f*ht,Pe+=f*Ft,Ve+=f*Mt,f=F[5],je+=f*wt,pt+=f*_t,gt+=f*Et,Me+=f*St,Oe+=f*mt,$e+=f*yt,De+=f*Ut,He+=f*Lt,Te+=f*It,Ue+=f*jt,Se+=f*Ot,Ae+=f*At,Be+=f*xt,Pe+=f*ht,Ve+=f*Ft,We+=f*Mt,f=F[6],pt+=f*wt,gt+=f*_t,Me+=f*Et,Oe+=f*St,$e+=f*mt,De+=f*yt,He+=f*Ut,Te+=f*Lt,Ue+=f*It,Se+=f*jt,Ae+=f*Ot,Be+=f*At,Pe+=f*xt,Ve+=f*ht,We+=f*Ft,et+=f*Mt,f=F[7],gt+=f*wt,Me+=f*_t,Oe+=f*Et,$e+=f*St,De+=f*mt,He+=f*yt,Te+=f*Ut,Ue+=f*Lt,Se+=f*It,Ae+=f*jt,Be+=f*Ot,Pe+=f*At,Ve+=f*xt,We+=f*ht,et+=f*Ft,tt+=f*Mt,f=F[8],Me+=f*wt,Oe+=f*_t,$e+=f*Et,De+=f*St,He+=f*mt,Te+=f*yt,Ue+=f*Ut,Se+=f*Lt,Ae+=f*It,Be+=f*jt,Pe+=f*Ot,Ve+=f*At,We+=f*xt,et+=f*ht,tt+=f*Ft,Je+=f*Mt,f=F[9],Oe+=f*wt,$e+=f*_t,De+=f*Et,He+=f*St,Te+=f*mt,Ue+=f*yt,Se+=f*Ut,Ae+=f*Lt,Be+=f*It,Pe+=f*jt,Ve+=f*Ot,We+=f*At,et+=f*xt,tt+=f*ht,Je+=f*Ft,Zt+=f*Mt,f=F[10],$e+=f*wt,De+=f*_t,He+=f*Et,Te+=f*St,Ue+=f*mt,Se+=f*yt,Ae+=f*Ut,Be+=f*Lt,Pe+=f*It,Ve+=f*jt,We+=f*Ot,et+=f*At,tt+=f*xt,Je+=f*ht,Zt+=f*Ft,ur+=f*Mt,f=F[11],De+=f*wt,He+=f*_t,Te+=f*Et,Ue+=f*St,Se+=f*mt,Ae+=f*yt,Be+=f*Ut,Pe+=f*Lt,Ve+=f*It,We+=f*jt,et+=f*Ot,tt+=f*At,Je+=f*xt,Zt+=f*ht,ur+=f*Ft,Vr+=f*Mt,f=F[12],He+=f*wt,Te+=f*_t,Ue+=f*Et,Se+=f*St,Ae+=f*mt,Be+=f*yt,Pe+=f*Ut,Ve+=f*Lt,We+=f*It,et+=f*jt,tt+=f*Ot,Je+=f*At,Zt+=f*xt,ur+=f*ht,Vr+=f*Ft,er+=f*Mt,f=F[13],Te+=f*wt,Ue+=f*_t,Se+=f*Et,Ae+=f*St,Be+=f*mt,Pe+=f*yt,Ve+=f*Ut,We+=f*Lt,et+=f*It,tt+=f*jt,Je+=f*Ot,Zt+=f*At,ur+=f*xt,Vr+=f*ht,er+=f*Ft,rn+=f*Mt,f=F[14],Ue+=f*wt,Se+=f*_t,Ae+=f*Et,Be+=f*St,Pe+=f*mt,Ve+=f*yt,We+=f*Ut,et+=f*Lt,tt+=f*It,Je+=f*jt,Zt+=f*Ot,ur+=f*At,Vr+=f*xt,er+=f*ht,rn+=f*Ft,vn+=f*Mt,f=F[15],Se+=f*wt,Ae+=f*_t,Be+=f*Et,Pe+=f*St,Ve+=f*mt,We+=f*yt,et+=f*Ut,tt+=f*Lt,Je+=f*It,Zt+=f*jt,ur+=f*Ot,Vr+=f*At,er+=f*xt,rn+=f*ht,vn+=f*Ft,Un+=f*Mt,ie+=38*Ae,fe+=38*Be,Ie+=38*Pe,ze+=38*Ve,Ge+=38*We,je+=38*et,pt+=38*tt,gt+=38*Je,Me+=38*Zt,Oe+=38*ur,$e+=38*Vr,De+=38*er,He+=38*rn,Te+=38*vn,Ue+=38*Un,x=1,f=ie+x+65535,x=Math.floor(f/65536),ie=f-x*65536,f=fe+x+65535,x=Math.floor(f/65536),fe=f-x*65536,f=Ie+x+65535,x=Math.floor(f/65536),Ie=f-x*65536,f=ze+x+65535,x=Math.floor(f/65536),ze=f-x*65536,f=Ge+x+65535,x=Math.floor(f/65536),Ge=f-x*65536,f=je+x+65535,x=Math.floor(f/65536),je=f-x*65536,f=pt+x+65535,x=Math.floor(f/65536),pt=f-x*65536,f=gt+x+65535,x=Math.floor(f/65536),gt=f-x*65536,f=Me+x+65535,x=Math.floor(f/65536),Me=f-x*65536,f=Oe+x+65535,x=Math.floor(f/65536),Oe=f-x*65536,f=$e+x+65535,x=Math.floor(f/65536),$e=f-x*65536,f=De+x+65535,x=Math.floor(f/65536),De=f-x*65536,f=He+x+65535,x=Math.floor(f/65536),He=f-x*65536,f=Te+x+65535,x=Math.floor(f/65536),Te=f-x*65536,f=Ue+x+65535,x=Math.floor(f/65536),Ue=f-x*65536,f=Se+x+65535,x=Math.floor(f/65536),Se=f-x*65536,ie+=x-1+37*(x-1),x=1,f=ie+x+65535,x=Math.floor(f/65536),ie=f-x*65536,f=fe+x+65535,x=Math.floor(f/65536),fe=f-x*65536,f=Ie+x+65535,x=Math.floor(f/65536),Ie=f-x*65536,f=ze+x+65535,x=Math.floor(f/65536),ze=f-x*65536,f=Ge+x+65535,x=Math.floor(f/65536),Ge=f-x*65536,f=je+x+65535,x=Math.floor(f/65536),je=f-x*65536,f=pt+x+65535,x=Math.floor(f/65536),pt=f-x*65536,f=gt+x+65535,x=Math.floor(f/65536),gt=f-x*65536,f=Me+x+65535,x=Math.floor(f/65536),Me=f-x*65536,f=Oe+x+65535,x=Math.floor(f/65536),Oe=f-x*65536,f=$e+x+65535,x=Math.floor(f/65536),$e=f-x*65536,f=De+x+65535,x=Math.floor(f/65536),De=f-x*65536,f=He+x+65535,x=Math.floor(f/65536),He=f-x*65536,f=Te+x+65535,x=Math.floor(f/65536),Te=f-x*65536,f=Ue+x+65535,x=Math.floor(f/65536),Ue=f-x*65536,f=Se+x+65535,x=Math.floor(f/65536),Se=f-x*65536,ie+=x-1+37*(x-1),H[0]=ie,H[1]=fe,H[2]=Ie,H[3]=ze,H[4]=Ge,H[5]=je,H[6]=pt,H[7]=gt,H[8]=Me,H[9]=Oe,H[10]=$e,H[11]=De,H[12]=He,H[13]=Te,H[14]=Ue,H[15]=Se}function m(H,F){h(H,F,F)}function k(H,F){const N=o();let f;for(f=0;f<16;f++)N[f]=F[f];for(f=253;f>=0;f--)m(N,N),f!==2&&f!==4&&h(N,N,F);for(f=0;f<16;f++)H[f]=N[f]}function V(H,F){const N=o();let f;for(f=0;f<16;f++)N[f]=F[f];for(f=250;f>=0;f--)m(N,N),f!==1&&h(N,N,F);for(f=0;f<16;f++)H[f]=N[f]}function se(H,F){const N=o(),f=o(),x=o(),ie=o(),fe=o(),Ie=o(),ze=o(),Ge=o(),je=o();b(N,H[1],H[0]),b(je,F[1],F[0]),h(N,N,je),R(f,H[0],H[1]),R(je,F[0],F[1]),h(f,f,je),h(x,H[3],F[3]),h(x,x,p),h(ie,H[2],F[2]),R(ie,ie,ie),b(fe,f,N),b(Ie,ie,x),R(ze,ie,x),R(Ge,f,N),h(H[0],fe,Ie),h(H[1],Ge,ze),h(H[2],ze,Ie),h(H[3],fe,Ge)}function ce(H,F,N){for(let f=0;f<4;f++)B(H[f],F[f],N)}function ge(H,F){const N=o(),f=o(),x=o();k(x,F[2]),h(N,F[0],x),h(f,F[1],x),K(H,f),H[31]^=j(N)<<7}function $(H,F,N){P(H[0],l),P(H[1],d),P(H[2],d),P(H[3],l);for(let f=255;f>=0;--f){const x=N[f/8|0]>>(f&7)&1;ce(H,F,x),se(F,H),se(H,H),ce(H,F,x)}}function q(H,F){const N=[o(),o(),o(),o()];P(N[0],w),P(N[1],T),P(N[2],d),h(N[3],w,T),$(H,N,F)}function le(H){if(H.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const F=(0,t.hash)(H);F[0]&=248,F[31]&=127,F[31]|=64;const N=new Uint8Array(32),f=[o(),o(),o(),o()];q(f,F),ge(N,f);const x=new Uint8Array(64);return x.set(H),x.set(N,32),{publicKey:N,secretKey:x}}n.generateKeyPairFromSeed=le;function te(H){const F=(0,e.randomBytes)(32,H),N=le(F);return(0,s.wipe)(F),N}n.generateKeyPair=te;function W(H){if(H.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}n.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(H,F){let N,f,x,ie;for(f=63;f>=32;--f){for(N=0,x=f-32,ie=f-12;x<ie;++x)F[x]+=N-16*F[f]*ee[x-(f-32)],N=Math.floor((F[x]+128)/256),F[x]-=N*256;F[x]+=N,F[f]=0}for(N=0,x=0;x<32;x++)F[x]+=N-(F[31]>>4)*ee[x],N=F[x]>>8,F[x]&=255;for(x=0;x<32;x++)F[x]-=N*ee[x];for(f=0;f<32;f++)F[f+1]+=F[f]>>8,H[f]=F[f]&255}function re(H){const F=new Float64Array(64);for(let N=0;N<64;N++)F[N]=H[N];for(let N=0;N<64;N++)H[N]=0;Y(H,F)}function xe(H,F){const N=new Float64Array(64),f=[o(),o(),o(),o()],x=(0,t.hash)(H.subarray(0,32));x[0]&=248,x[31]&=127,x[31]|=64;const ie=new Uint8Array(64);ie.set(x.subarray(32),32);const fe=new t.SHA512;fe.update(ie.subarray(32)),fe.update(F);const Ie=fe.digest();fe.clean(),re(Ie),q(f,Ie),ge(ie,f),fe.reset(),fe.update(ie.subarray(0,32)),fe.update(H.subarray(32)),fe.update(F);const ze=fe.digest();re(ze);for(let Ge=0;Ge<32;Ge++)N[Ge]=Ie[Ge];for(let Ge=0;Ge<32;Ge++)for(let je=0;je<32;je++)N[Ge+je]+=ze[Ge]*x[je];return Y(ie.subarray(32),N),ie}n.sign=xe;function ne(H,F){const N=o(),f=o(),x=o(),ie=o(),fe=o(),Ie=o(),ze=o();return P(H[2],d),O(H[1],F),m(x,H[1]),h(ie,x,_),b(x,x,H[2]),R(ie,H[2],ie),m(fe,ie),m(Ie,fe),h(ze,Ie,fe),h(N,ze,x),h(N,N,ie),V(N,N),h(N,N,x),h(N,N,ie),h(N,N,ie),h(H[0],N,ie),m(f,H[0]),h(f,f,ie),C(f,x)&&h(H[0],H[0],S),m(f,H[0]),h(f,f,ie),C(f,x)?-1:(j(H[0])===F[31]>>7&&b(H[0],l,H[0]),h(H[3],H[0],H[1]),0)}function be(H,F,N){const f=new Uint8Array(32),x=[o(),o(),o(),o()],ie=[o(),o(),o(),o()];if(N.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ne(ie,H))return!1;const fe=new t.SHA512;fe.update(N.subarray(0,32)),fe.update(H),fe.update(F);const Ie=fe.digest();return re(Ie),$(x,ie,Ie),q(ie,N.subarray(32)),se(x,ie),ge(f,x),!oe(N,f)}n.verify=be;function he(H){let F=[o(),o(),o(),o()];if(ne(F,H))throw new Error("Ed25519: invalid public key");let N=o(),f=o(),x=F[1];R(N,d,x),b(f,d,x),k(f,f),h(N,N,f);let ie=new Uint8Array(32);return K(ie,N),ie}n.convertPublicKeyToX25519=he;function ve(H){const F=(0,t.hash)(H.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const N=new Uint8Array(F.subarray(0,32));return(0,s.wipe)(F),N}n.convertSecretKeyToX25519=ve})(xu);const sE="EdDSA",oE="JWT",qd=".",zd="base64url",aE="utf8",cE="utf8",uE=":",hE="did",lE="key",mf="base58btc",fE="z",dE="K36",pE=32;function Fo(n){return cr(_r(vs(n),aE),zd)}function Bd(n){const e=_r(dE,mf),t=fE+cr(Vc([e,n]),mf);return[hE,lE,t].join(uE)}function gE(n){return cr(n,zd)}function _E(n){return _r([Fo(n.header),Fo(n.payload)].join(qd),cE)}function yE(n){return[Fo(n.header),Fo(n.payload),gE(n.signature)].join(qd)}function bf(n=Ni.randomBytes(pE)){return xu.generateKeyPairFromSeed(n)}async function vE(n,e,t,s,o=_e.fromMiliseconds(Date.now())){const c={alg:sE,typ:oE},l=Bd(s.publicKey),d=o+t,_={iss:l,sub:n,aud:e,iat:o,exp:d},p=_E({header:c,payload:_}),w=xu.sign(s.secretKey,p);return yE({header:c,payload:_,signature:w})}var Pu={},Jo={};Object.defineProperty(Jo,"__esModule",{value:!0});var Qt=Le,uu=Ir,mE=20;function bE(n,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,d=t[3]<<24|t[2]<<16|t[1]<<8|t[0],_=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],w=t[15]<<24|t[14]<<16|t[13]<<8|t[12],T=t[19]<<24|t[18]<<16|t[17]<<8|t[16],S=t[23]<<24|t[22]<<16|t[21]<<8|t[20],P=t[27]<<24|t[26]<<16|t[25]<<8|t[24],M=t[31]<<24|t[30]<<16|t[29]<<8|t[28],B=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],oe=e[11]<<24|e[10]<<16|e[9]<<8|e[8],C=e[15]<<24|e[14]<<16|e[13]<<8|e[12],j=s,O=o,R=c,b=l,h=d,m=_,k=p,V=w,se=T,ce=S,ge=P,$=M,q=B,le=K,te=oe,W=C,ee=0;ee<mE;ee+=2)j=j+h|0,q^=j,q=q>>>32-16|q<<16,se=se+q|0,h^=se,h=h>>>32-12|h<<12,O=O+m|0,le^=O,le=le>>>32-16|le<<16,ce=ce+le|0,m^=ce,m=m>>>32-12|m<<12,R=R+k|0,te^=R,te=te>>>32-16|te<<16,ge=ge+te|0,k^=ge,k=k>>>32-12|k<<12,b=b+V|0,W^=b,W=W>>>32-16|W<<16,$=$+W|0,V^=$,V=V>>>32-12|V<<12,R=R+k|0,te^=R,te=te>>>32-8|te<<8,ge=ge+te|0,k^=ge,k=k>>>32-7|k<<7,b=b+V|0,W^=b,W=W>>>32-8|W<<8,$=$+W|0,V^=$,V=V>>>32-7|V<<7,O=O+m|0,le^=O,le=le>>>32-8|le<<8,ce=ce+le|0,m^=ce,m=m>>>32-7|m<<7,j=j+h|0,q^=j,q=q>>>32-8|q<<8,se=se+q|0,h^=se,h=h>>>32-7|h<<7,j=j+m|0,W^=j,W=W>>>32-16|W<<16,ge=ge+W|0,m^=ge,m=m>>>32-12|m<<12,O=O+k|0,q^=O,q=q>>>32-16|q<<16,$=$+q|0,k^=$,k=k>>>32-12|k<<12,R=R+V|0,le^=R,le=le>>>32-16|le<<16,se=se+le|0,V^=se,V=V>>>32-12|V<<12,b=b+h|0,te^=b,te=te>>>32-16|te<<16,ce=ce+te|0,h^=ce,h=h>>>32-12|h<<12,R=R+V|0,le^=R,le=le>>>32-8|le<<8,se=se+le|0,V^=se,V=V>>>32-7|V<<7,b=b+h|0,te^=b,te=te>>>32-8|te<<8,ce=ce+te|0,h^=ce,h=h>>>32-7|h<<7,O=O+k|0,q^=O,q=q>>>32-8|q<<8,$=$+q|0,k^=$,k=k>>>32-7|k<<7,j=j+m|0,W^=j,W=W>>>32-8|W<<8,ge=ge+W|0,m^=ge,m=m>>>32-7|m<<7;Qt.writeUint32LE(j+s|0,n,0),Qt.writeUint32LE(O+o|0,n,4),Qt.writeUint32LE(R+c|0,n,8),Qt.writeUint32LE(b+l|0,n,12),Qt.writeUint32LE(h+d|0,n,16),Qt.writeUint32LE(m+_|0,n,20),Qt.writeUint32LE(k+p|0,n,24),Qt.writeUint32LE(V+w|0,n,28),Qt.writeUint32LE(se+T|0,n,32),Qt.writeUint32LE(ce+S|0,n,36),Qt.writeUint32LE(ge+P|0,n,40),Qt.writeUint32LE($+M|0,n,44),Qt.writeUint32LE(q+B|0,n,48),Qt.writeUint32LE(le+K|0,n,52),Qt.writeUint32LE(te+oe|0,n,56),Qt.writeUint32LE(W+C|0,n,60)}function Kd(n,e,t,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var d=new Uint8Array(64),_=0;_<t.length;_+=64){bE(d,c,n);for(var p=_;p<_+64&&p<t.length;p++)s[p]=t[p]^d[p-_];EE(c,0,l)}return uu.wipe(d),o===0&&uu.wipe(c),s}Jo.streamXOR=Kd;function wE(n,e,t,s){return s===void 0&&(s=0),uu.wipe(t),Kd(n,e,t,t,s)}Jo.stream=wE;function EE(n,e,t){for(var s=1;t--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Gd={},Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});function SE(n,e,t){return~(n-1)&e|n-1&t}Cn.select=SE;function IE(n,e){return(n|0)-(e|0)-1>>>31&1}Cn.lessOrEqual=IE;function Vd(n,e){if(n.length!==e.length)return 0;for(var t=0,s=0;s<n.length;s++)t|=n[s]^e[s];return 1&t-1>>>8}Cn.compare=Vd;function OE(n,e){return n.length===0||e.length===0?!1:Vd(n,e)!==0}Cn.equal=OE;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Cn,t=Ir;n.DIGEST_LENGTH=16;var s=function(){function l(d){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var _=d[0]|d[1]<<8;this._r[0]=_&8191;var p=d[2]|d[3]<<8;this._r[1]=(_>>>13|p<<3)&8191;var w=d[4]|d[5]<<8;this._r[2]=(p>>>10|w<<6)&7939;var T=d[6]|d[7]<<8;this._r[3]=(w>>>7|T<<9)&8191;var S=d[8]|d[9]<<8;this._r[4]=(T>>>4|S<<12)&255,this._r[5]=S>>>1&8190;var P=d[10]|d[11]<<8;this._r[6]=(S>>>14|P<<2)&8191;var M=d[12]|d[13]<<8;this._r[7]=(P>>>11|M<<5)&8065;var B=d[14]|d[15]<<8;this._r[8]=(M>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return l.prototype._blocks=function(d,_,p){for(var w=this._fin?0:2048,T=this._h[0],S=this._h[1],P=this._h[2],M=this._h[3],B=this._h[4],K=this._h[5],oe=this._h[6],C=this._h[7],j=this._h[8],O=this._h[9],R=this._r[0],b=this._r[1],h=this._r[2],m=this._r[3],k=this._r[4],V=this._r[5],se=this._r[6],ce=this._r[7],ge=this._r[8],$=this._r[9];p>=16;){var q=d[_+0]|d[_+1]<<8;T+=q&8191;var le=d[_+2]|d[_+3]<<8;S+=(q>>>13|le<<3)&8191;var te=d[_+4]|d[_+5]<<8;P+=(le>>>10|te<<6)&8191;var W=d[_+6]|d[_+7]<<8;M+=(te>>>7|W<<9)&8191;var ee=d[_+8]|d[_+9]<<8;B+=(W>>>4|ee<<12)&8191,K+=ee>>>1&8191;var Y=d[_+10]|d[_+11]<<8;oe+=(ee>>>14|Y<<2)&8191;var re=d[_+12]|d[_+13]<<8;C+=(Y>>>11|re<<5)&8191;var xe=d[_+14]|d[_+15]<<8;j+=(re>>>8|xe<<8)&8191,O+=xe>>>5|w;var ne=0,be=ne;be+=T*R,be+=S*(5*$),be+=P*(5*ge),be+=M*(5*ce),be+=B*(5*se),ne=be>>>13,be&=8191,be+=K*(5*V),be+=oe*(5*k),be+=C*(5*m),be+=j*(5*h),be+=O*(5*b),ne+=be>>>13,be&=8191;var he=ne;he+=T*b,he+=S*R,he+=P*(5*$),he+=M*(5*ge),he+=B*(5*ce),ne=he>>>13,he&=8191,he+=K*(5*se),he+=oe*(5*V),he+=C*(5*k),he+=j*(5*m),he+=O*(5*h),ne+=he>>>13,he&=8191;var ve=ne;ve+=T*h,ve+=S*b,ve+=P*R,ve+=M*(5*$),ve+=B*(5*ge),ne=ve>>>13,ve&=8191,ve+=K*(5*ce),ve+=oe*(5*se),ve+=C*(5*V),ve+=j*(5*k),ve+=O*(5*m),ne+=ve>>>13,ve&=8191;var H=ne;H+=T*m,H+=S*h,H+=P*b,H+=M*R,H+=B*(5*$),ne=H>>>13,H&=8191,H+=K*(5*ge),H+=oe*(5*ce),H+=C*(5*se),H+=j*(5*V),H+=O*(5*k),ne+=H>>>13,H&=8191;var F=ne;F+=T*k,F+=S*m,F+=P*h,F+=M*b,F+=B*R,ne=F>>>13,F&=8191,F+=K*(5*$),F+=oe*(5*ge),F+=C*(5*ce),F+=j*(5*se),F+=O*(5*V),ne+=F>>>13,F&=8191;var N=ne;N+=T*V,N+=S*k,N+=P*m,N+=M*h,N+=B*b,ne=N>>>13,N&=8191,N+=K*R,N+=oe*(5*$),N+=C*(5*ge),N+=j*(5*ce),N+=O*(5*se),ne+=N>>>13,N&=8191;var f=ne;f+=T*se,f+=S*V,f+=P*k,f+=M*m,f+=B*h,ne=f>>>13,f&=8191,f+=K*b,f+=oe*R,f+=C*(5*$),f+=j*(5*ge),f+=O*(5*ce),ne+=f>>>13,f&=8191;var x=ne;x+=T*ce,x+=S*se,x+=P*V,x+=M*k,x+=B*m,ne=x>>>13,x&=8191,x+=K*h,x+=oe*b,x+=C*R,x+=j*(5*$),x+=O*(5*ge),ne+=x>>>13,x&=8191;var ie=ne;ie+=T*ge,ie+=S*ce,ie+=P*se,ie+=M*V,ie+=B*k,ne=ie>>>13,ie&=8191,ie+=K*m,ie+=oe*h,ie+=C*b,ie+=j*R,ie+=O*(5*$),ne+=ie>>>13,ie&=8191;var fe=ne;fe+=T*$,fe+=S*ge,fe+=P*ce,fe+=M*se,fe+=B*V,ne=fe>>>13,fe&=8191,fe+=K*k,fe+=oe*m,fe+=C*h,fe+=j*b,fe+=O*R,ne+=fe>>>13,fe&=8191,ne=(ne<<2)+ne|0,ne=ne+be|0,be=ne&8191,ne=ne>>>13,he+=ne,T=be,S=he,P=ve,M=H,B=F,K=N,oe=f,C=x,j=ie,O=fe,_+=16,p-=16}this._h[0]=T,this._h[1]=S,this._h[2]=P,this._h[3]=M,this._h[4]=B,this._h[5]=K,this._h[6]=oe,this._h[7]=C,this._h[8]=j,this._h[9]=O},l.prototype.finish=function(d,_){_===void 0&&(_=0);var p=new Uint16Array(10),w,T,S,P;if(this._leftover){for(P=this._leftover,this._buffer[P++]=1;P<16;P++)this._buffer[P]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(w=this._h[1]>>>13,this._h[1]&=8191,P=2;P<10;P++)this._h[P]+=w,w=this._h[P]>>>13,this._h[P]&=8191;for(this._h[0]+=w*5,w=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=w,w=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=w,p[0]=this._h[0]+5,w=p[0]>>>13,p[0]&=8191,P=1;P<10;P++)p[P]=this._h[P]+w,w=p[P]>>>13,p[P]&=8191;for(p[9]-=8192,T=(w^1)-1,P=0;P<10;P++)p[P]&=T;for(T=~T,P=0;P<10;P++)this._h[P]=this._h[P]&T|p[P];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,S=this._h[0]+this._pad[0],this._h[0]=S&65535,P=1;P<8;P++)S=(this._h[P]+this._pad[P]|0)+(S>>>16)|0,this._h[P]=S&65535;return d[_+0]=this._h[0]>>>0,d[_+1]=this._h[0]>>>8,d[_+2]=this._h[1]>>>0,d[_+3]=this._h[1]>>>8,d[_+4]=this._h[2]>>>0,d[_+5]=this._h[2]>>>8,d[_+6]=this._h[3]>>>0,d[_+7]=this._h[3]>>>8,d[_+8]=this._h[4]>>>0,d[_+9]=this._h[4]>>>8,d[_+10]=this._h[5]>>>0,d[_+11]=this._h[5]>>>8,d[_+12]=this._h[6]>>>0,d[_+13]=this._h[6]>>>8,d[_+14]=this._h[7]>>>0,d[_+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(d){var _=0,p=d.length,w;if(this._leftover){w=16-this._leftover,w>p&&(w=p);for(var T=0;T<w;T++)this._buffer[this._leftover+T]=d[_+T];if(p-=w,_+=w,this._leftover+=w,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(w=p-p%16,this._blocks(d,_,w),_+=w,p-=w),p){for(var T=0;T<p;T++)this._buffer[this._leftover+T]=d[_+T];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();n.Poly1305=s;function o(l,d){var _=new s(l);_.update(d);var p=_.digest();return _.clean(),p}n.oneTimeAuth=o;function c(l,d){return l.length!==n.DIGEST_LENGTH||d.length!==n.DIGEST_LENGTH?!1:e.equal(l,d)}n.equal=c})(Gd);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Jo,t=Gd,s=Ir,o=Le,c=Cn;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var l=new Uint8Array(16),d=function(){function _(p){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,p.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return _.prototype.seal=function(p,w,T,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var P=new Uint8Array(16);P.set(p,P.length-p.length);var M=new Uint8Array(32);e.stream(this._key,P,M,4);var B=w.length+this.tagLength,K;if(S){if(S.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");K=S}else K=new Uint8Array(B);return e.streamXOR(this._key,P,w,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),M,K.subarray(0,K.length-this.tagLength),T),s.wipe(P),K},_.prototype.open=function(p,w,T,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(w.length<this.tagLength)return null;var P=new Uint8Array(16);P.set(p,P.length-p.length);var M=new Uint8Array(32);e.stream(this._key,P,M,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,M,w.subarray(0,w.length-this.tagLength),T),!c.equal(B,w.subarray(w.length-this.tagLength,w.length)))return null;var K=w.length-this.tagLength,oe;if(S){if(S.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");oe=S}else oe=new Uint8Array(K);return e.streamXOR(this._key,P,w.subarray(0,w.length-this.tagLength),oe,4),s.wipe(P),oe},_.prototype.clean=function(){return s.wipe(this._key),this},_.prototype._authenticate=function(p,w,T,S){var P=new t.Poly1305(w);S&&(P.update(S),S.length%16>0&&P.update(l.subarray(S.length%16))),P.update(T),T.length%16>0&&P.update(l.subarray(T.length%16));var M=new Uint8Array(8);S&&o.writeUint64LE(S.length,M),P.update(M),o.writeUint64LE(T.length,M),P.update(M);for(var B=P.digest(),K=0;K<B.length;K++)p[K]=B[K];P.clean(),s.wipe(B),s.wipe(M)},_}();n.ChaCha20Poly1305=d})(Pu);var kd={},Es={},Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});function xE(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Tu.isSerializableHash=xE;Object.defineProperty(Es,"__esModule",{value:!0});var Qr=Tu,PE=Cn,TE=Ir,Wd=function(){function n(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Qr.isSerializableHash(this._inner)&&Qr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),TE.wipe(s)}return n.prototype.reset=function(){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Qr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Qr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();Es.HMAC=Wd;function AE(n,e,t){var s=new Wd(n,e);s.update(t);var o=s.digest();return s.clean(),o}Es.hmac=AE;Es.equal=PE.equal;Object.defineProperty(kd,"__esModule",{value:!0});var wf=Es,Ef=Ir,RE=function(){function n(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=wf.hmac(this._hash,s,t);this._hmac=new wf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},n.prototype.clean=function(){this._hmac.clean(),Ef.wipe(this._buffer),Ef.wipe(this._counter),this._bufpos=0},n}(),NE=kd.HKDF=RE,Xo={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Le,t=Ir;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},d.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=_[w++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(w=c(this._temp,this._state,_,w,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[w++],p--;return this},d.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,w=this._bufferLength,T=p/536870912|0,S=p<<3,P=p%64<56?64:128;this._buffer[w]=128;for(var M=w+1;M<P-8;M++)this._buffer[M]=0;e.writeUint32BE(T,this._buffer,P-8),e.writeUint32BE(S,this._buffer,P-4),c(this._temp,this._state,this._buffer,0,P),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)e.writeUint32BE(this._state[M],_,M*4);return this},d.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(_){t.wipe(_.state),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},d}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(d,_,p,w,T){for(;T>=64;){for(var S=_[0],P=_[1],M=_[2],B=_[3],K=_[4],oe=_[5],C=_[6],j=_[7],O=0;O<16;O++){var R=w+O*4;d[O]=e.readUint32BE(p,R)}for(var O=16;O<64;O++){var b=d[O-2],h=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=d[O-15];var m=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;d[O]=(h+d[O-7]|0)+(m+d[O-16]|0)}for(var O=0;O<64;O++){var h=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&oe^~K&C)|0)+(j+(o[O]+d[O]|0)|0)|0,m=((S>>>2|S<<32-2)^(S>>>13|S<<32-13)^(S>>>22|S<<32-22))+(S&P^S&M^P&M)|0;j=C,C=oe,oe=K,K=B+h|0,B=M,M=P,P=S,S=h+m|0}_[0]+=S,_[1]+=P,_[2]+=M,_[3]+=B,_[4]+=K,_[5]+=oe,_[6]+=C,_[7]+=j,w+=64,T-=64}return w}function l(d){var _=new s;_.update(d);var p=_.digest();return _.clean(),p}n.hash=l})(Xo);var Au={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=Ni,t=Ir;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(O){const R=new Float64Array(16);if(O)for(let b=0;b<O.length;b++)R[b]=O[b];return R}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(O){let R=1;for(let b=0;b<16;b++){let h=O[b]+R+65535;R=Math.floor(h/65536),O[b]=h-R*65536}O[0]+=R-1+37*(R-1)}function d(O,R,b){const h=~(b-1);for(let m=0;m<16;m++){const k=h&(O[m]^R[m]);O[m]^=k,R[m]^=k}}function _(O,R){const b=s(),h=s();for(let m=0;m<16;m++)h[m]=R[m];l(h),l(h),l(h);for(let m=0;m<2;m++){b[0]=h[0]-65517;for(let V=1;V<15;V++)b[V]=h[V]-65535-(b[V-1]>>16&1),b[V-1]&=65535;b[15]=h[15]-32767-(b[14]>>16&1);const k=b[15]>>16&1;b[14]&=65535,d(h,b,1-k)}for(let m=0;m<16;m++)O[2*m]=h[m]&255,O[2*m+1]=h[m]>>8}function p(O,R){for(let b=0;b<16;b++)O[b]=R[2*b]+(R[2*b+1]<<8);O[15]&=32767}function w(O,R,b){for(let h=0;h<16;h++)O[h]=R[h]+b[h]}function T(O,R,b){for(let h=0;h<16;h++)O[h]=R[h]-b[h]}function S(O,R,b){let h,m,k=0,V=0,se=0,ce=0,ge=0,$=0,q=0,le=0,te=0,W=0,ee=0,Y=0,re=0,xe=0,ne=0,be=0,he=0,ve=0,H=0,F=0,N=0,f=0,x=0,ie=0,fe=0,Ie=0,ze=0,Ge=0,je=0,pt=0,gt=0,Me=b[0],Oe=b[1],$e=b[2],De=b[3],He=b[4],Te=b[5],Ue=b[6],Se=b[7],Ae=b[8],Be=b[9],Pe=b[10],Ve=b[11],We=b[12],et=b[13],tt=b[14],Je=b[15];h=R[0],k+=h*Me,V+=h*Oe,se+=h*$e,ce+=h*De,ge+=h*He,$+=h*Te,q+=h*Ue,le+=h*Se,te+=h*Ae,W+=h*Be,ee+=h*Pe,Y+=h*Ve,re+=h*We,xe+=h*et,ne+=h*tt,be+=h*Je,h=R[1],V+=h*Me,se+=h*Oe,ce+=h*$e,ge+=h*De,$+=h*He,q+=h*Te,le+=h*Ue,te+=h*Se,W+=h*Ae,ee+=h*Be,Y+=h*Pe,re+=h*Ve,xe+=h*We,ne+=h*et,be+=h*tt,he+=h*Je,h=R[2],se+=h*Me,ce+=h*Oe,ge+=h*$e,$+=h*De,q+=h*He,le+=h*Te,te+=h*Ue,W+=h*Se,ee+=h*Ae,Y+=h*Be,re+=h*Pe,xe+=h*Ve,ne+=h*We,be+=h*et,he+=h*tt,ve+=h*Je,h=R[3],ce+=h*Me,ge+=h*Oe,$+=h*$e,q+=h*De,le+=h*He,te+=h*Te,W+=h*Ue,ee+=h*Se,Y+=h*Ae,re+=h*Be,xe+=h*Pe,ne+=h*Ve,be+=h*We,he+=h*et,ve+=h*tt,H+=h*Je,h=R[4],ge+=h*Me,$+=h*Oe,q+=h*$e,le+=h*De,te+=h*He,W+=h*Te,ee+=h*Ue,Y+=h*Se,re+=h*Ae,xe+=h*Be,ne+=h*Pe,be+=h*Ve,he+=h*We,ve+=h*et,H+=h*tt,F+=h*Je,h=R[5],$+=h*Me,q+=h*Oe,le+=h*$e,te+=h*De,W+=h*He,ee+=h*Te,Y+=h*Ue,re+=h*Se,xe+=h*Ae,ne+=h*Be,be+=h*Pe,he+=h*Ve,ve+=h*We,H+=h*et,F+=h*tt,N+=h*Je,h=R[6],q+=h*Me,le+=h*Oe,te+=h*$e,W+=h*De,ee+=h*He,Y+=h*Te,re+=h*Ue,xe+=h*Se,ne+=h*Ae,be+=h*Be,he+=h*Pe,ve+=h*Ve,H+=h*We,F+=h*et,N+=h*tt,f+=h*Je,h=R[7],le+=h*Me,te+=h*Oe,W+=h*$e,ee+=h*De,Y+=h*He,re+=h*Te,xe+=h*Ue,ne+=h*Se,be+=h*Ae,he+=h*Be,ve+=h*Pe,H+=h*Ve,F+=h*We,N+=h*et,f+=h*tt,x+=h*Je,h=R[8],te+=h*Me,W+=h*Oe,ee+=h*$e,Y+=h*De,re+=h*He,xe+=h*Te,ne+=h*Ue,be+=h*Se,he+=h*Ae,ve+=h*Be,H+=h*Pe,F+=h*Ve,N+=h*We,f+=h*et,x+=h*tt,ie+=h*Je,h=R[9],W+=h*Me,ee+=h*Oe,Y+=h*$e,re+=h*De,xe+=h*He,ne+=h*Te,be+=h*Ue,he+=h*Se,ve+=h*Ae,H+=h*Be,F+=h*Pe,N+=h*Ve,f+=h*We,x+=h*et,ie+=h*tt,fe+=h*Je,h=R[10],ee+=h*Me,Y+=h*Oe,re+=h*$e,xe+=h*De,ne+=h*He,be+=h*Te,he+=h*Ue,ve+=h*Se,H+=h*Ae,F+=h*Be,N+=h*Pe,f+=h*Ve,x+=h*We,ie+=h*et,fe+=h*tt,Ie+=h*Je,h=R[11],Y+=h*Me,re+=h*Oe,xe+=h*$e,ne+=h*De,be+=h*He,he+=h*Te,ve+=h*Ue,H+=h*Se,F+=h*Ae,N+=h*Be,f+=h*Pe,x+=h*Ve,ie+=h*We,fe+=h*et,Ie+=h*tt,ze+=h*Je,h=R[12],re+=h*Me,xe+=h*Oe,ne+=h*$e,be+=h*De,he+=h*He,ve+=h*Te,H+=h*Ue,F+=h*Se,N+=h*Ae,f+=h*Be,x+=h*Pe,ie+=h*Ve,fe+=h*We,Ie+=h*et,ze+=h*tt,Ge+=h*Je,h=R[13],xe+=h*Me,ne+=h*Oe,be+=h*$e,he+=h*De,ve+=h*He,H+=h*Te,F+=h*Ue,N+=h*Se,f+=h*Ae,x+=h*Be,ie+=h*Pe,fe+=h*Ve,Ie+=h*We,ze+=h*et,Ge+=h*tt,je+=h*Je,h=R[14],ne+=h*Me,be+=h*Oe,he+=h*$e,ve+=h*De,H+=h*He,F+=h*Te,N+=h*Ue,f+=h*Se,x+=h*Ae,ie+=h*Be,fe+=h*Pe,Ie+=h*Ve,ze+=h*We,Ge+=h*et,je+=h*tt,pt+=h*Je,h=R[15],be+=h*Me,he+=h*Oe,ve+=h*$e,H+=h*De,F+=h*He,N+=h*Te,f+=h*Ue,x+=h*Se,ie+=h*Ae,fe+=h*Be,Ie+=h*Pe,ze+=h*Ve,Ge+=h*We,je+=h*et,pt+=h*tt,gt+=h*Je,k+=38*he,V+=38*ve,se+=38*H,ce+=38*F,ge+=38*N,$+=38*f,q+=38*x,le+=38*ie,te+=38*fe,W+=38*Ie,ee+=38*ze,Y+=38*Ge,re+=38*je,xe+=38*pt,ne+=38*gt,m=1,h=k+m+65535,m=Math.floor(h/65536),k=h-m*65536,h=V+m+65535,m=Math.floor(h/65536),V=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ce+m+65535,m=Math.floor(h/65536),ce=h-m*65536,h=ge+m+65535,m=Math.floor(h/65536),ge=h-m*65536,h=$+m+65535,m=Math.floor(h/65536),$=h-m*65536,h=q+m+65535,m=Math.floor(h/65536),q=h-m*65536,h=le+m+65535,m=Math.floor(h/65536),le=h-m*65536,h=te+m+65535,m=Math.floor(h/65536),te=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=xe+m+65535,m=Math.floor(h/65536),xe=h-m*65536,h=ne+m+65535,m=Math.floor(h/65536),ne=h-m*65536,h=be+m+65535,m=Math.floor(h/65536),be=h-m*65536,k+=m-1+37*(m-1),m=1,h=k+m+65535,m=Math.floor(h/65536),k=h-m*65536,h=V+m+65535,m=Math.floor(h/65536),V=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ce+m+65535,m=Math.floor(h/65536),ce=h-m*65536,h=ge+m+65535,m=Math.floor(h/65536),ge=h-m*65536,h=$+m+65535,m=Math.floor(h/65536),$=h-m*65536,h=q+m+65535,m=Math.floor(h/65536),q=h-m*65536,h=le+m+65535,m=Math.floor(h/65536),le=h-m*65536,h=te+m+65535,m=Math.floor(h/65536),te=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=xe+m+65535,m=Math.floor(h/65536),xe=h-m*65536,h=ne+m+65535,m=Math.floor(h/65536),ne=h-m*65536,h=be+m+65535,m=Math.floor(h/65536),be=h-m*65536,k+=m-1+37*(m-1),O[0]=k,O[1]=V,O[2]=se,O[3]=ce,O[4]=ge,O[5]=$,O[6]=q,O[7]=le,O[8]=te,O[9]=W,O[10]=ee,O[11]=Y,O[12]=re,O[13]=xe,O[14]=ne,O[15]=be}function P(O,R){S(O,R,R)}function M(O,R){const b=s();for(let h=0;h<16;h++)b[h]=R[h];for(let h=253;h>=0;h--)P(b,b),h!==2&&h!==4&&S(b,b,R);for(let h=0;h<16;h++)O[h]=b[h]}function B(O,R){const b=new Uint8Array(32),h=new Float64Array(80),m=s(),k=s(),V=s(),se=s(),ce=s(),ge=s();for(let te=0;te<31;te++)b[te]=O[te];b[31]=O[31]&127|64,b[0]&=248,p(h,R);for(let te=0;te<16;te++)k[te]=h[te];m[0]=se[0]=1;for(let te=254;te>=0;--te){const W=b[te>>>3]>>>(te&7)&1;d(m,k,W),d(V,se,W),w(ce,m,V),T(m,m,V),w(V,k,se),T(k,k,se),P(se,ce),P(ge,m),S(m,V,m),S(V,k,ce),w(ce,m,V),T(m,m,V),P(k,m),T(V,se,ge),S(m,V,c),w(m,m,se),S(V,V,m),S(m,se,ge),S(se,k,h),P(k,ce),d(m,k,W),d(V,se,W)}for(let te=0;te<16;te++)h[te+16]=m[te],h[te+32]=V[te],h[te+48]=k[te],h[te+64]=se[te];const $=h.subarray(32),q=h.subarray(16);M($,$),S(q,q,$);const le=new Uint8Array(32);return _(le,q),le}n.scalarMult=B;function K(O){return B(O,o)}n.scalarMultBase=K;function oe(O){if(O.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const R=new Uint8Array(O);return{publicKey:K(R),secretKey:R}}n.generateKeyPairFromSeed=oe;function C(O){const R=(0,e.randomBytes)(32,O),b=oe(R);return(0,t.wipe)(R),b}n.generateKeyPair=C;function j(O,R,b=!1){if(O.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(R.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const h=B(O,R);if(b){let m=0;for(let k=0;k<h.length;k++)m|=h[k];if(m===0)throw new Error("X25519: invalid shared key")}return h}n.sharedKey=j})(Au);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Jd=lt.getLocation=lt.getLocationOrThrow=Ru=lt.getNavigator=lt.getNavigatorOrThrow=Yd=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function ti(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}lt.getFromWindow=ti;function Ci(n){const e=ti(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}lt.getFromWindowOrThrow=Ci;function CE(){return Ci("document")}lt.getDocumentOrThrow=CE;function $E(){return ti("document")}var Yd=lt.getDocument=$E;function DE(){return Ci("navigator")}lt.getNavigatorOrThrow=DE;function UE(){return ti("navigator")}var Ru=lt.getNavigator=UE;function LE(){return Ci("location")}lt.getLocationOrThrow=LE;function jE(){return ti("location")}var Jd=lt.getLocation=jE;function FE(){return Ci("crypto")}lt.getCryptoOrThrow=FE;function ME(){return ti("crypto")}lt.getCrypto=ME;function HE(){return Ci("localStorage")}lt.getLocalStorageOrThrow=HE;function qE(){return ti("localStorage")}lt.getLocalStorage=qE;var Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});var Xd=Nu.getWindowMetadata=void 0;const Sf=lt;function zE(){let n,e;try{n=Sf.getDocumentOrThrow(),e=Sf.getLocationOrThrow()}catch{return null}function t(){const T=n.getElementsByTagName("link"),S=[];for(let P=0;P<T.length;P++){const M=T[P],B=M.getAttribute("rel");if(B&&B.toLowerCase().indexOf("icon")>-1){const K=M.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let oe=e.protocol+"//"+e.host;if(K.indexOf("/")===0)oe+=K;else{const C=e.pathname.split("/");C.pop();const j=C.join("/");oe+=j+"/"+K}S.push(oe)}else if(K.indexOf("//")===0){const oe=e.protocol+K;S.push(oe)}else S.push(K)}}return S}function s(...T){const S=n.getElementsByTagName("meta");for(let P=0;P<S.length;P++){const M=S[P],B=["itemprop","property","name"].map(K=>M.getAttribute(K)).filter(K=>K?T.includes(K):!1);if(B.length&&B){const K=M.getAttribute("content");if(K)return K}}return""}function o(){let T=s("name","og:site_name","og:title","twitter:title");return T||(T=n.title),T}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),d=c(),_=e.origin,p=t();return{description:d,url:_,icons:p,name:l}}Xd=Nu.getWindowMetadata=zE;var ms={},BE=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Qd="%[a-f0-9]{2}",If=new RegExp("("+Qd+")|([^%]+?)","gi"),Of=new RegExp("("+Qd+")+","gi");function hu(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var t=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],hu(t),hu(s))}function KE(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(If)||[],t=1;t<e.length;t++)n=hu(e,t).join(""),e=n.match(If)||[];return n}}function GE(n){for(var e={"%FE%FF":"","%FF%FE":""},t=Of.exec(n);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=KE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Of.exec(n)}e["%C2"]="";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];n=n.replace(new RegExp(l,"g"),e[l])}return n}var VE=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return GE(n)}},kE=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const t=n.indexOf(e);return t===-1?[n]:[n.slice(0,t),n.slice(t+e.length)]},WE=function(n,e){for(var t={},s=Object.keys(n),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],d=n[l];(o?e.indexOf(l)!==-1:e(l,d,n))&&(t[l]=d)}return t};(function(n){const e=BE,t=VE,s=kE,o=WE,c=C=>C==null,l=Symbol("encodeFragmentIdentifier");function d(C){switch(C.arrayFormat){case"index":return j=>(O,R)=>{const b=O.length;return R===void 0||C.skipNull&&R===null||C.skipEmptyString&&R===""?O:R===null?[...O,[w(j,C),"[",b,"]"].join("")]:[...O,[w(j,C),"[",w(b,C),"]=",w(R,C)].join("")]};case"bracket":return j=>(O,R)=>R===void 0||C.skipNull&&R===null||C.skipEmptyString&&R===""?O:R===null?[...O,[w(j,C),"[]"].join("")]:[...O,[w(j,C),"[]=",w(R,C)].join("")];case"colon-list-separator":return j=>(O,R)=>R===void 0||C.skipNull&&R===null||C.skipEmptyString&&R===""?O:R===null?[...O,[w(j,C),":list="].join("")]:[...O,[w(j,C),":list=",w(R,C)].join("")];case"comma":case"separator":case"bracket-separator":{const j=C.arrayFormat==="bracket-separator"?"[]=":"=";return O=>(R,b)=>b===void 0||C.skipNull&&b===null||C.skipEmptyString&&b===""?R:(b=b===null?"":b,R.length===0?[[w(O,C),j,w(b,C)].join("")]:[[R,w(b,C)].join(C.arrayFormatSeparator)])}default:return j=>(O,R)=>R===void 0||C.skipNull&&R===null||C.skipEmptyString&&R===""?O:R===null?[...O,w(j,C)]:[...O,[w(j,C),"=",w(R,C)].join("")]}}function _(C){let j;switch(C.arrayFormat){case"index":return(O,R,b)=>{if(j=/\[(\d*)\]$/.exec(O),O=O.replace(/\[\d*\]$/,""),!j){b[O]=R;return}b[O]===void 0&&(b[O]={}),b[O][j[1]]=R};case"bracket":return(O,R,b)=>{if(j=/(\[\])$/.exec(O),O=O.replace(/\[\]$/,""),!j){b[O]=R;return}if(b[O]===void 0){b[O]=[R];return}b[O]=[].concat(b[O],R)};case"colon-list-separator":return(O,R,b)=>{if(j=/(:list)$/.exec(O),O=O.replace(/:list$/,""),!j){b[O]=R;return}if(b[O]===void 0){b[O]=[R];return}b[O]=[].concat(b[O],R)};case"comma":case"separator":return(O,R,b)=>{const h=typeof R=="string"&&R.includes(C.arrayFormatSeparator),m=typeof R=="string"&&!h&&T(R,C).includes(C.arrayFormatSeparator);R=m?T(R,C):R;const k=h||m?R.split(C.arrayFormatSeparator).map(V=>T(V,C)):R===null?R:T(R,C);b[O]=k};case"bracket-separator":return(O,R,b)=>{const h=/(\[\])$/.test(O);if(O=O.replace(/\[\]$/,""),!h){b[O]=R&&T(R,C);return}const m=R===null?[]:R.split(C.arrayFormatSeparator).map(k=>T(k,C));if(b[O]===void 0){b[O]=m;return}b[O]=[].concat(b[O],m)};default:return(O,R,b)=>{if(b[O]===void 0){b[O]=R;return}b[O]=[].concat(b[O],R)}}}function p(C){if(typeof C!="string"||C.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(C,j){return j.encode?j.strict?e(C):encodeURIComponent(C):C}function T(C,j){return j.decode?t(C):C}function S(C){return Array.isArray(C)?C.sort():typeof C=="object"?S(Object.keys(C)).sort((j,O)=>Number(j)-Number(O)).map(j=>C[j]):C}function P(C){const j=C.indexOf("#");return j!==-1&&(C=C.slice(0,j)),C}function M(C){let j="";const O=C.indexOf("#");return O!==-1&&(j=C.slice(O)),j}function B(C){C=P(C);const j=C.indexOf("?");return j===-1?"":C.slice(j+1)}function K(C,j){return j.parseNumbers&&!Number.isNaN(Number(C))&&typeof C=="string"&&C.trim()!==""?C=Number(C):j.parseBooleans&&C!==null&&(C.toLowerCase()==="true"||C.toLowerCase()==="false")&&(C=C.toLowerCase()==="true"),C}function oe(C,j){j=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},j),p(j.arrayFormatSeparator);const O=_(j),R=Object.create(null);if(typeof C!="string"||(C=C.trim().replace(/^[?#&]/,""),!C))return R;for(const b of C.split("&")){if(b==="")continue;let[h,m]=s(j.decode?b.replace(/\+/g," "):b,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(j.arrayFormat)?m:T(m,j),O(T(h,j),m,R)}for(const b of Object.keys(R)){const h=R[b];if(typeof h=="object"&&h!==null)for(const m of Object.keys(h))h[m]=K(h[m],j);else R[b]=K(h,j)}return j.sort===!1?R:(j.sort===!0?Object.keys(R).sort():Object.keys(R).sort(j.sort)).reduce((b,h)=>{const m=R[h];return m&&typeof m=="object"&&!Array.isArray(m)?b[h]=S(m):b[h]=m,b},Object.create(null))}n.extract=B,n.parse=oe,n.stringify=(C,j)=>{if(!C)return"";j=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},j),p(j.arrayFormatSeparator);const O=m=>j.skipNull&&c(C[m])||j.skipEmptyString&&C[m]==="",R=d(j),b={};for(const m of Object.keys(C))O(m)||(b[m]=C[m]);const h=Object.keys(b);return j.sort!==!1&&h.sort(j.sort),h.map(m=>{const k=C[m];return k===void 0?"":k===null?w(m,j):Array.isArray(k)?k.length===0&&j.arrayFormat==="bracket-separator"?w(m,j)+"[]":k.reduce(R(m),[]).join("&"):w(m,j)+"="+w(k,j)}).filter(m=>m.length>0).join("&")},n.parseUrl=(C,j)=>{j=Object.assign({decode:!0},j);const[O,R]=s(C,"#");return Object.assign({url:O.split("?")[0]||"",query:oe(B(C),j)},j&&j.parseFragmentIdentifier&&R?{fragmentIdentifier:T(R,j)}:{})},n.stringifyUrl=(C,j)=>{j=Object.assign({encode:!0,strict:!0,[l]:!0},j);const O=P(C.url).split("?")[0]||"",R=n.extract(C.url),b=n.parse(R,{sort:!1}),h=Object.assign(b,C.query);let m=n.stringify(h,j);m&&(m=`?${m}`);let k=M(C.url);return C.fragmentIdentifier&&(k=`#${j[l]?w(C.fragmentIdentifier,j):C.fragmentIdentifier}`),`${O}${m}${k}`},n.pick=(C,j,O)=>{O=Object.assign({parseFragmentIdentifier:!0,[l]:!1},O);const{url:R,query:b,fragmentIdentifier:h}=n.parseUrl(C,O);return n.stringifyUrl({url:R,query:o(b,j),fragmentIdentifier:h},O)},n.exclude=(C,j,O)=>{const R=Array.isArray(j)?b=>!j.includes(b):(b,h)=>!j(b,h);return n.pick(C,R,O)}})(ms);const YE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function JE(n,e=[]){const t=[];return Object.keys(n).forEach(s=>{if(e.length&&!e.includes(s))return;const o=n[s];t.push(...o.accounts)}),t}function Zd(n,e){return n.includes(":")?[n]:e.chains||[]}const ep="base10",ar="base16",lu="base64pad",Cu="utf8",tp=0,ri=1,XE=0,xf=1,fu=12,$u=32;function QE(){const n=Au.generateKeyPair();return{privateKey:cr(n.secretKey,ar),publicKey:cr(n.publicKey,ar)}}function du(){const n=Ni.randomBytes($u);return cr(n,ar)}function ZE(n,e){const t=Au.sharedKey(_r(n,ar),_r(e,ar)),s=new NE(Xo.SHA256,t).expand($u);return cr(s,ar)}function e6(n){const e=Xo.hash(_r(n,ar));return cr(e,ar)}function Pi(n){const e=Xo.hash(_r(n,Cu));return cr(e,ar)}function t6(n){return _r(`${n}`,ep)}function Ss(n){return Number(cr(n,ep))}function r6(n){const e=t6(typeof n.type<"u"?n.type:tp);if(Ss(e)===ri&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof n.senderPublicKey<"u"?_r(n.senderPublicKey,ar):void 0,s=typeof n.iv<"u"?_r(n.iv,ar):Ni.randomBytes(fu),o=new Pu.ChaCha20Poly1305(_r(n.symKey,ar)).seal(s,_r(n.message,Cu));return i6({type:e,sealed:o,iv:s,senderPublicKey:t})}function n6(n){const e=new Pu.ChaCha20Poly1305(_r(n.symKey,ar)),{sealed:t,iv:s}=Mo(n.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return cr(o,Cu)}function i6(n){if(Ss(n.type)===ri){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cr(Vc([n.type,n.senderPublicKey,n.iv,n.sealed]),lu)}return cr(Vc([n.type,n.iv,n.sealed]),lu)}function Mo(n){const e=_r(n,lu),t=e.slice(XE,xf),s=xf;if(Ss(t)===ri){const d=s+$u,_=d+fu,p=e.slice(s,d),w=e.slice(d,_),T=e.slice(_);return{type:t,sealed:T,iv:w,senderPublicKey:p}}const o=s+fu,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function s6(n,e){const t=Mo(n);return rp({type:Ss(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?cr(t.senderPublicKey,ar):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function rp(n){const e=(n==null?void 0:n.type)||tp;if(e===ri){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Pf(n){return n.type===ri&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var o6=Object.defineProperty,Tf=Object.getOwnPropertySymbols,a6=Object.prototype.hasOwnProperty,c6=Object.prototype.propertyIsEnumerable,Af=(n,e,t)=>e in n?o6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Rf=(n,e)=>{for(var t in e||(e={}))a6.call(e,t)&&Af(n,t,e[t]);if(Tf)for(var t of Tf(e))c6.call(e,t)&&Af(n,t,e[t]);return n};const u6="ReactNative",Rn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},h6="js";function Du(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function np(){return!Yd()&&!!Ru()&&navigator.product===u6}function Uu(){return!Du()&&!!Ru()}function Lu(){return np()?Rn.reactNative:Du()?Rn.node:Uu()?Rn.browser:Rn.unknown}function l6(n,e){let t=ms.parse(n);return t=Rf(Rf({},t),e),n=ms.stringify(t),n}function f6(){return Xd()||{name:"",description:"",url:"",icons:[""]}}function d6(){if(Lu()===Rn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const n=vm();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function p6(){var n;const e=Lu();return e===Rn.browser?[e,((n=Jd())==null?void 0:n.host)||"unknown"].join(":"):e}function g6(n,e,t){const s=d6(),o=p6();return[[n,e].join("-"),[h6,t].join("-"),s,o].join("/")}function _6({protocol:n,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l}){const d=t.split("?"),_=g6(n,e,s),p={auth:o,ua:_,projectId:c,useOnCloseEvent:l||void 0},w=l6(d[1]||"",p);return d[0]+"?"+w}function Zn(n,e){return n.filter(t=>e.includes(t)).length===n.length}function ip(n){return Object.fromEntries(n.entries())}function sp(n){return new Map(Object.entries(n))}function xi(n=_e.FIVE_MINUTES,e){const t=_e.toMiliseconds(n||_e.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,d)=>{c=setTimeout(()=>{d(new Error(e))},t),s=l,o=d})}}function Ho(n,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await n;s(l)}catch(l){o(l)}clearTimeout(c)})}function op(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function y6(n){return op("topic",n)}function v6(n){return op("id",n)}function ap(n){const[e,t]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Kr(n,e){return _e.fromMiliseconds((e||Date.now())+_e.toMiliseconds(n))}function An(n){return Date.now()>=_e.toMiliseconds(n)}function zt(n,e){return`${n}${e?`:${e}`:""}`}function Lc(n=[],e=[]){return[...new Set([...n,...e])]}async function m6({id:n,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${n}&sessionTopic=${e}`,l=Lu();l===Rn.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Rn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}const b6="irn";function pu(n){return(n==null?void 0:n.relay)||{protocol:b6}}function $o(n){const e=YE[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var w6=Object.defineProperty,Nf=Object.getOwnPropertySymbols,E6=Object.prototype.hasOwnProperty,S6=Object.prototype.propertyIsEnumerable,Cf=(n,e,t)=>e in n?w6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,I6=(n,e)=>{for(var t in e||(e={}))E6.call(e,t)&&Cf(n,t,e[t]);if(Nf)for(var t of Nf(e))S6.call(e,t)&&Cf(n,t,e[t]);return n};function O6(n,e="-"){const t={},s="relay"+e;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=n[o];t[c]=l}}),t}function x6(n){const e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),o=n.substring(e+1,t).split("@"),c=typeof t<"u"?n.substring(t):"",l=ms.parse(c);return{protocol:s,topic:P6(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:O6(l)}}function P6(n){return n.startsWith("//")?n.substring(2):n}function T6(n,e="-"){const t="relay",s={};return Object.keys(n).forEach(o=>{const c=t+e+o;n[o]&&(s[c]=n[o])}),s}function A6(n){return`${n.protocol}:${n.topic}@${n.version}?`+ms.stringify(I6({symKey:n.symKey},T6(n.relay)))}function $i(n){const e=[];return n.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function R6(n){const e=[];return Object.values(n).forEach(t=>{e.push(...$i(t.accounts))}),e}function N6(n,e){const t=[];return Object.values(n).forEach(s=>{$i(s.accounts).includes(e)&&t.push(...s.methods)}),t}function C6(n,e){const t=[];return Object.values(n).forEach(s=>{$i(s.accounts).includes(e)&&t.push(...s.events)}),t}function $6(n,e){const t=Uo(n,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(n))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return s}function ju(n){return n.includes(":")}function Do(n){return ju(n)?n.split(":")[0]:n}const D6={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},U6={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(n,e){const{message:t,code:s}=U6[n];return{message:e?`${t} ${e}`:t,code:s}}function $t(n,e){const{message:t,code:s}=D6[n];return{message:e?`${t} ${e}`:t,code:s}}function tn(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Ti(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function kt(n,e){return e&&or(n)?!0:typeof n=="string"&&!!n.trim().length}function Fu(n,e){return e&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function L6(n,e){const{requiredNamespaces:t}=e,s=Object.keys(n.namespaces),o=Object.keys(t);let c=!0;return Zn(o,s)?(s.forEach(l=>{const{accounts:d,methods:_,events:p}=n.namespaces[l],w=$i(d),T=t[l];(!Zn(Zd(l,T),w)||!Zn(T.methods,_)||!Zn(T.events,p))&&(c=!1)}),c):!1}function qo(n){return kt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function j6(n){if(kt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&qo(t)}}return!1}function F6(n){if(kt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function M6(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function H6(n){return n==null?void 0:n.topic}function q6(n,e){let t=null;return kt(n==null?void 0:n.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function $f(n){let e=!0;return tn(n)?n.length&&(e=n.every(t=>kt(t,!1))):e=!1,e}function z6(n,e,t){let s=null;return tn(e)&&e.length?e.forEach(o=>{s||qo(o)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):qo(n)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function B6(n,e,t){let s=null;return Object.entries(n).forEach(([o,c])=>{if(s)return;const l=z6(o,Zd(o,c),`${e} ${t}`);l&&(s=l)}),s}function K6(n,e){let t=null;return tn(n)?n.forEach(s=>{t||j6(s)||(t=$t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=$t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function G6(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=K6(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function V6(n,e){let t=null;return $f(n==null?void 0:n.methods)?$f(n==null?void 0:n.events)||(t=$t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=$t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function cp(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=V6(s,`${e}, namespace`);o&&(t=o)}),t}function k6(n,e,t){let s=null;if(n&&Ti(n)){const o=cp(n,e);o&&(s=o);const c=B6(n,e,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Uo(n,e){let t=null;if(n&&Ti(n)){const s=cp(n,e);s&&(t=s);const o=G6(n,e);o&&(t=o)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function up(n){return kt(n.protocol,!0)}function W6(n,e){let t=!1;return e&&!n?t=!0:n&&tn(n)&&n.length&&n.forEach(s=>{t=up(s)}),t}function Y6(n){return typeof n=="number"}function gr(n){return typeof n<"u"&&typeof n!==null}function J6(n){return!(!n||typeof n!="object"||!n.code||!Fu(n.code,!1)||!n.message||!kt(n.message,!1))}function X6(n){return!(or(n)||!kt(n.method,!1))}function Q6(n){return!(or(n)||or(n.result)&&or(n.error)||!Fu(n.id,!1)||!kt(n.jsonrpc,!1))}function Z6(n){return!(or(n)||!kt(n.name,!1))}function Df(n,e){return!(!qo(e)||!R6(n).includes(e))}function eS(n,e,t){return kt(t,!1)?N6(n,e).includes(t):!1}function tS(n,e,t){return kt(t,!1)?C6(n,e).includes(t):!1}function Uf(n,e,t){let s=null;const o=rS(n),c=nS(e),l=Object.keys(o),d=Object.keys(c),_=Lf(Object.keys(n)),p=Lf(Object.keys(e)),w=_.filter(T=>!p.includes(T));return w.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(e).toString()}`)),Zn(l,d)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${d.toString()}`)),Object.keys(e).forEach(T=>{if(!T.includes(":")||s)return;const S=$i(e[T].accounts);S.includes(T)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${T}
        Required: ${T}
        Approved: ${S.toString()}`))}),l.forEach(T=>{s||(Zn(o[T].methods,c[T].methods)?Zn(o[T].events,c[T].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${T}`)):s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${T}`))}),s}function rS(n){const e={};return Object.keys(n).forEach(t=>{var s;t.includes(":")?e[t]=n[t]:(s=n[t].chains)==null||s.forEach(o=>{e[o]={methods:n[t].methods,events:n[t].events}})}),e}function Lf(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function nS(n){const e={};return Object.keys(n).forEach(t=>{if(t.includes(":"))e[t]=n[t];else{const s=$i(n[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:n[t].accounts.filter(c=>c.includes(`${o}:`)),methods:n[t].methods,events:n[t].events}})}}),e}function iS(n,e){return Fu(n,!1)&&n<=e.max&&n>=e.min}const sS="PARSE_ERROR",oS="INVALID_REQUEST",aS="METHOD_NOT_FOUND",cS="INVALID_PARAMS",hp="INTERNAL_ERROR",Mu="SERVER_ERROR",uS=[-32700,-32600,-32601,-32602,-32603],ds={[sS]:{code:-32700,message:"Parse error"},[oS]:{code:-32600,message:"Invalid Request"},[aS]:{code:-32601,message:"Method not found"},[cS]:{code:-32602,message:"Invalid params"},[hp]:{code:-32603,message:"Internal error"},[Mu]:{code:-32e3,message:"Server error"}},lp=Mu;function hS(n){return uS.includes(n)}function jf(n){return Object.keys(ds).includes(n)?ds[n]:ds[lp]}function lS(n){const e=Object.values(ds).find(t=>t.code===n);return e||ds[lp]}function fp(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var dp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gu=function(n,e){return gu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},gu(n,e)};function fS(n,e){gu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var _u=function(){return _u=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},_u.apply(this,arguments)};function dS(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function pS(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var d=n.length-1;d>=0;d--)(l=n[d])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function gS(n,e){return function(t,s){e(t,s,n)}}function _S(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function yS(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function d(w){try{p(s.next(w))}catch(T){l(T)}}function _(w){try{p(s.throw(w))}catch(T){l(T)}}function p(w){w.done?c(w.value):o(w.value).then(d,_)}p((s=s.apply(n,e||[])).next())})}function vS(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(w){return _([p,w])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function mS(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function bS(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function yu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(d){l={error:d}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function wS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(pp(arguments[e]));return n}function ES(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,d=c.length;l<d;l++,o++)s[o]=c[l];return s}function bs(n){return this instanceof bs?(this.v=n,this):new bs(n)}function SS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||d(S,P)})})}function d(S,P){try{_(s[S](P))}catch(M){T(c[0][3],M)}}function _(S){S.value instanceof bs?Promise.resolve(S.value.v).then(p,w):T(c[0][2],S)}function p(S){d("next",S)}function w(S){d("throw",S)}function T(S,P){S(P),c.shift(),c.length&&d(c[0][0],c[0][1])}}function IS(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:bs(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function OS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yu=="function"?yu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(d,_){l=n[c](l),o(d,_,l.done,l.value)})}}function o(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function xS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function PS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function TS(n){return n&&n.__esModule?n:{default:n}}function AS(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function RS(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const NS=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return _u},__asyncDelegator:IS,__asyncGenerator:SS,__asyncValues:OS,__await:bs,__awaiter:yS,__classPrivateFieldGet:AS,__classPrivateFieldSet:RS,__createBinding:mS,__decorate:pS,__exportStar:bS,__extends:fS,__generator:vS,__importDefault:TS,__importStar:PS,__makeTemplateObject:xS,__metadata:_S,__param:gS,__read:pp,__rest:dS,__spread:wS,__spreadArrays:ES,__values:yu},Symbol.toStringTag,{value:"Module"})),CS=Ai(NS);var gn={},Ff;function $S(){if(Ff)return gn;Ff=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.isBrowserCryptoAvailable=gn.getSubtleCrypto=gn.getBrowerCrypto=void 0;function n(){return(Sr===null||Sr===void 0?void 0:Sr.crypto)||(Sr===null||Sr===void 0?void 0:Sr.msCrypto)||{}}gn.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}gn.getSubtleCrypto=e;function t(){return!!n()&&!!e()}return gn.isBrowserCryptoAvailable=t,gn}var _n={},Mf;function DS(){if(Mf)return _n;Mf=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.isBrowser=_n.isNode=_n.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_n.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}_n.isNode=e;function t(){return!n()&&!e()}return _n.isBrowser=t,_n}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=CS;e.__exportStar($S(),n),e.__exportStar(DS(),n)})(dp);function gp(n=3){const e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function Hu(n=6){return BigInt(gp(n))}function Qo(n,e,t){return{id:t||gp(),jsonrpc:"2.0",method:n,params:e}}function qu(n,e){return{id:n,jsonrpc:"2.0",result:e}}function Zo(n,e,t){return{id:n,jsonrpc:"2.0",error:US(e,t)}}function US(n,e){return typeof n>"u"?jf(hp):(typeof n=="string"&&(n=Object.assign(Object.assign({},jf(Mu)),{message:n})),typeof e<"u"&&(n.data=e),hS(n.code)&&(n=lS(n.code)),n)}class LS{}class jS extends LS{constructor(){super()}}class FS extends jS{constructor(e){super()}}const MS="^https?:",HS="^wss?:";function qS(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function _p(n,e){const t=qS(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function Hf(n){return _p(n,MS)}function qf(n){return _p(n,HS)}function zS(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function yp(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function zu(n){return yp(n)&&"method"in n}function ea(n){return yp(n)&&(yn(n)||Gr(n))}function yn(n){return"result"in n}function Gr(n){return"error"in n}class $n extends FS{constructor(e){super(e),this.events=new jr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Qo(e.method,e.params||[],e.id||Hu().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Gr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ea(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const BS=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),KS=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",zf=n=>n.split("?")[0],Bf=10,GS=BS();class VS{constructor(e){if(this.url=e,this.events=new jr.EventEmitter,this.registering=!1,!qf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(vs(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!qf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=dp.isReactNative()?void 0:{rejectUnauthorized:!zS(e)},c=new GS(e,[],o);KS()?c.onerror=l=>{const d=l;s(this.emitError(d.error))}:c.on("error",l=>{s(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ou(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=Zo(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return fp(e,zf(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Bf&&this.events.setMaxListeners(Bf)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${zf(this.url)}`));return this.events.emit("register_error",t),t}}var zo={exports:{}};zo.exports;(function(n,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,d="[object Arguments]",_="[object Array]",p="[object AsyncFunction]",w="[object Boolean]",T="[object Date]",S="[object Error]",P="[object Function]",M="[object GeneratorFunction]",B="[object Map]",K="[object Number]",oe="[object Null]",C="[object Object]",j="[object Promise]",O="[object Proxy]",R="[object RegExp]",b="[object Set]",h="[object String]",m="[object Symbol]",k="[object Undefined]",V="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",$="[object Float64Array]",q="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[$]=he[q]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[d]=he[_]=he[se]=he[w]=he[ce]=he[T]=he[S]=he[P]=he[B]=he[K]=he[C]=he[R]=he[b]=he[h]=he[V]=!1;var ve=typeof Sr=="object"&&Sr&&Sr.Object===Object&&Sr,H=typeof self=="object"&&self&&self.Object===Object&&self,F=ve||H||Function("return this")(),N=e&&!e.nodeType&&e,f=N&&!0&&n&&!n.nodeType&&n,x=f&&f.exports===N,ie=x&&ve.process,fe=function(){try{return ie&&ie.binding&&ie.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function ze(E,D){for(var Q=-1,de=E==null?0:E.length,at=0,Ne=[];++Q<de;){var ft=E[Q];D(ft,Q,E)&&(Ne[at++]=ft)}return Ne}function Ge(E,D){for(var Q=-1,de=D.length,at=E.length;++Q<de;)E[at+Q]=D[Q];return E}function je(E,D){for(var Q=-1,de=E==null?0:E.length;++Q<de;)if(D(E[Q],Q,E))return!0;return!1}function pt(E,D){for(var Q=-1,de=Array(E);++Q<E;)de[Q]=D(Q);return de}function gt(E){return function(D){return E(D)}}function Me(E,D){return E.has(D)}function Oe(E,D){return E==null?void 0:E[D]}function $e(E){var D=-1,Q=Array(E.size);return E.forEach(function(de,at){Q[++D]=[at,de]}),Q}function De(E,D){return function(Q){return E(D(Q))}}function He(E){var D=-1,Q=Array(E.size);return E.forEach(function(de){Q[++D]=de}),Q}var Te=Array.prototype,Ue=Function.prototype,Se=Object.prototype,Ae=F["__core-js_shared__"],Be=Ue.toString,Pe=Se.hasOwnProperty,Ve=function(){var E=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),We=Se.toString,et=RegExp("^"+Be.call(Pe).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=x?F.Buffer:void 0,Je=F.Symbol,Zt=F.Uint8Array,ur=Se.propertyIsEnumerable,Vr=Te.splice,er=Je?Je.toStringTag:void 0,rn=Object.getOwnPropertySymbols,vn=tt?tt.isBuffer:void 0,Un=De(Object.keys,Object),wt=yr(F,"DataView"),_t=yr(F,"Map"),Et=yr(F,"Promise"),St=yr(F,"Set"),mt=yr(F,"WeakMap"),yt=yr(Object,"create"),Ut=sn(wt),Lt=sn(_t),It=sn(Et),jt=sn(St),Ot=sn(mt),At=Je?Je.prototype:void 0,xt=At?At.valueOf:void 0;function ht(E){var D=-1,Q=E==null?0:E.length;for(this.clear();++D<Q;){var de=E[D];this.set(de[0],de[1])}}function Ft(){this.__data__=yt?yt(null):{},this.size=0}function Mt(E){var D=this.has(E)&&delete this.__data__[E];return this.size-=D?1:0,D}function na(E){var D=this.__data__;if(yt){var Q=D[E];return Q===s?void 0:Q}return Pe.call(D,E)?D[E]:void 0}function ia(E){var D=this.__data__;return yt?D[E]!==void 0:Pe.call(D,E)}function sa(E,D){var Q=this.__data__;return this.size+=this.has(E)?0:1,Q[E]=yt&&D===void 0?s:D,this}ht.prototype.clear=Ft,ht.prototype.delete=Mt,ht.prototype.get=na,ht.prototype.has=ia,ht.prototype.set=sa;function Or(E){var D=-1,Q=E==null?0:E.length;for(this.clear();++D<Q;){var de=E[D];this.set(de[0],de[1])}}function oa(){this.__data__=[],this.size=0}function aa(E){var D=this.__data__,Q=Ln(D,E);if(Q<0)return!1;var de=D.length-1;return Q==de?D.pop():Vr.call(D,Q,1),--this.size,!0}function ca(E){var D=this.__data__,Q=Ln(D,E);return Q<0?void 0:D[Q][1]}function ua(E){return Ln(this.__data__,E)>-1}function ha(E,D){var Q=this.__data__,de=Ln(Q,E);return de<0?(++this.size,Q.push([E,D])):Q[de][1]=D,this}Or.prototype.clear=oa,Or.prototype.delete=aa,Or.prototype.get=ca,Or.prototype.has=ua,Or.prototype.set=ha;function nn(E){var D=-1,Q=E==null?0:E.length;for(this.clear();++D<Q;){var de=E[D];this.set(de[0],de[1])}}function ii(){this.size=0,this.__data__={hash:new ht,map:new(_t||Or),string:new ht}}function la(E){var D=mn(this,E).delete(E);return this.size-=D?1:0,D}function si(E){return mn(this,E).get(E)}function fa(E){return mn(this,E).has(E)}function da(E,D){var Q=mn(this,E),de=Q.size;return Q.set(E,D),this.size+=Q.size==de?0:1,this}nn.prototype.clear=ii,nn.prototype.delete=la,nn.prototype.get=si,nn.prototype.has=fa,nn.prototype.set=da;function oi(E){var D=-1,Q=E==null?0:E.length;for(this.__data__=new nn;++D<Q;)this.add(E[D])}function Os(E){return this.__data__.set(E,s),this}function xs(E){return this.__data__.has(E)}oi.prototype.add=oi.prototype.push=Os,oi.prototype.has=xs;function Fr(E){var D=this.__data__=new Or(E);this.size=D.size}function pa(){this.__data__=new Or,this.size=0}function ga(E){var D=this.__data__,Q=D.delete(E);return this.size=D.size,Q}function _a(E){return this.__data__.get(E)}function ya(E){return this.__data__.has(E)}function Ps(E,D){var Q=this.__data__;if(Q instanceof Or){var de=Q.__data__;if(!_t||de.length<t-1)return de.push([E,D]),this.size=++Q.size,this;Q=this.__data__=new nn(de)}return Q.set(E,D),this.size=Q.size,this}Fr.prototype.clear=pa,Fr.prototype.delete=ga,Fr.prototype.get=_a,Fr.prototype.has=ya,Fr.prototype.set=Ps;function Ts(E,D){var Q=ui(E),de=!Q&&Hs(E),at=!Q&&!de&&Li(E),Ne=!Q&&!de&&!at&&Bs(E),ft=Q||de||at||Ne,Ht=ft?pt(E.length,String):[],Xe=Ht.length;for(var ct in E)(D||Pe.call(E,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Us(ct,Xe)))&&Ht.push(ct);return Ht}function Ln(E,D){for(var Q=E.length;Q--;)if(Ms(E[Q][0],D))return Q;return-1}function Di(E,D,Q){var de=D(E);return ui(E)?de:Ge(de,Q(E))}function jn(E){return E==null?E===void 0?k:oe:er&&er in Object(E)?$s(E):ba(E)}function Ui(E){return Mn(E)&&jn(E)==d}function Fn(E,D,Q,de,at){return E===D?!0:E==null||D==null||!Mn(E)&&!Mn(D)?E!==E&&D!==D:As(E,D,Q,de,Fn,at)}function As(E,D,Q,de,at,Ne){var ft=ui(E),Ht=ui(D),Xe=ft?_:kr(E),ct=Ht?_:kr(D);Xe=Xe==d?C:Xe,ct=ct==d?C:ct;var Rt=Xe==C,hr=ct==C,qt=Xe==ct;if(qt&&Li(E)){if(!Li(D))return!1;ft=!0,Rt=!1}if(qt&&!Rt)return Ne||(Ne=new Fr),ft||Bs(E)?ai(E,D,Q,de,at,Ne):ma(E,D,Xe,Q,de,at,Ne);if(!(Q&o)){var dt=Rt&&Pe.call(E,"__wrapped__"),tr=hr&&Pe.call(D,"__wrapped__");if(dt||tr){var Mr=dt?E.value():E,xr=tr?D.value():D;return Ne||(Ne=new Fr),at(Mr,xr,Q,de,Ne)}}return qt?(Ne||(Ne=new Fr),Cs(E,D,Q,de,at,Ne)):!1}function va(E){if(!zs(E)||js(E))return!1;var D=hi(E)?et:ne;return D.test(sn(E))}function Rs(E){return Mn(E)&&qs(E.length)&&!!he[jn(E)]}function Ns(E){if(!Fs(E))return Un(E);var D=[];for(var Q in Object(E))Pe.call(E,Q)&&Q!="constructor"&&D.push(Q);return D}function ai(E,D,Q,de,at,Ne){var ft=Q&o,Ht=E.length,Xe=D.length;if(Ht!=Xe&&!(ft&&Xe>Ht))return!1;var ct=Ne.get(E);if(ct&&Ne.get(D))return ct==D;var Rt=-1,hr=!0,qt=Q&c?new oi:void 0;for(Ne.set(E,D),Ne.set(D,E);++Rt<Ht;){var dt=E[Rt],tr=D[Rt];if(de)var Mr=ft?de(tr,dt,Rt,D,E,Ne):de(dt,tr,Rt,E,D,Ne);if(Mr!==void 0){if(Mr)continue;hr=!1;break}if(qt){if(!je(D,function(xr,Wr){if(!Me(qt,Wr)&&(dt===xr||at(dt,xr,Q,de,Ne)))return qt.push(Wr)})){hr=!1;break}}else if(!(dt===tr||at(dt,tr,Q,de,Ne))){hr=!1;break}}return Ne.delete(E),Ne.delete(D),hr}function ma(E,D,Q,de,at,Ne,ft){switch(Q){case ce:if(E.byteLength!=D.byteLength||E.byteOffset!=D.byteOffset)return!1;E=E.buffer,D=D.buffer;case se:return!(E.byteLength!=D.byteLength||!Ne(new Zt(E),new Zt(D)));case w:case T:case K:return Ms(+E,+D);case S:return E.name==D.name&&E.message==D.message;case R:case h:return E==D+"";case B:var Ht=$e;case b:var Xe=de&o;if(Ht||(Ht=He),E.size!=D.size&&!Xe)return!1;var ct=ft.get(E);if(ct)return ct==D;de|=c,ft.set(E,D);var Rt=ai(Ht(E),Ht(D),de,at,Ne,ft);return ft.delete(E),Rt;case m:if(xt)return xt.call(E)==xt.call(D)}return!1}function Cs(E,D,Q,de,at,Ne){var ft=Q&o,Ht=ci(E),Xe=Ht.length,ct=ci(D),Rt=ct.length;if(Xe!=Rt&&!ft)return!1;for(var hr=Xe;hr--;){var qt=Ht[hr];if(!(ft?qt in D:Pe.call(D,qt)))return!1}var dt=Ne.get(E);if(dt&&Ne.get(D))return dt==D;var tr=!0;Ne.set(E,D),Ne.set(D,E);for(var Mr=ft;++hr<Xe;){qt=Ht[hr];var xr=E[qt],Wr=D[qt];if(de)var ji=ft?de(Wr,xr,qt,D,E,Ne):de(xr,Wr,qt,E,D,Ne);if(!(ji===void 0?xr===Wr||at(xr,Wr,Q,de,Ne):ji)){tr=!1;break}Mr||(Mr=qt=="constructor")}if(tr&&!Mr){var Hn=E.constructor,Gt=D.constructor;Hn!=Gt&&"constructor"in E&&"constructor"in D&&!(typeof Hn=="function"&&Hn instanceof Hn&&typeof Gt=="function"&&Gt instanceof Gt)&&(tr=!1)}return Ne.delete(E),Ne.delete(D),tr}function ci(E){return Di(E,Sa,Ds)}function mn(E,D){var Q=E.__data__;return Ls(D)?Q[typeof D=="string"?"string":"hash"]:Q.map}function yr(E,D){var Q=Oe(E,D);return va(Q)?Q:void 0}function $s(E){var D=Pe.call(E,er),Q=E[er];try{E[er]=void 0;var de=!0}catch{}var at=We.call(E);return de&&(D?E[er]=Q:delete E[er]),at}var Ds=rn?function(E){return E==null?[]:(E=Object(E),ze(rn(E),function(D){return ur.call(E,D)}))}:ot,kr=jn;(wt&&kr(new wt(new ArrayBuffer(1)))!=ce||_t&&kr(new _t)!=B||Et&&kr(Et.resolve())!=j||St&&kr(new St)!=b||mt&&kr(new mt)!=V)&&(kr=function(E){var D=jn(E),Q=D==C?E.constructor:void 0,de=Q?sn(Q):"";if(de)switch(de){case Ut:return ce;case Lt:return B;case It:return j;case jt:return b;case Ot:return V}return D});function Us(E,D){return D=D??l,!!D&&(typeof E=="number"||be.test(E))&&E>-1&&E%1==0&&E<D}function Ls(E){var D=typeof E;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?E!=="__proto__":E===null}function js(E){return!!Ve&&Ve in E}function Fs(E){var D=E&&E.constructor,Q=typeof D=="function"&&D.prototype||Se;return E===Q}function ba(E){return We.call(E)}function sn(E){if(E!=null){try{return Be.call(E)}catch{}try{return E+""}catch{}}return""}function Ms(E,D){return E===D||E!==E&&D!==D}var Hs=Ui(function(){return arguments}())?Ui:function(E){return Mn(E)&&Pe.call(E,"callee")&&!ur.call(E,"callee")},ui=Array.isArray;function wa(E){return E!=null&&qs(E.length)&&!hi(E)}var Li=vn||st;function Ea(E,D){return Fn(E,D)}function hi(E){if(!zs(E))return!1;var D=jn(E);return D==P||D==M||D==p||D==O}function qs(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=l}function zs(E){var D=typeof E;return E!=null&&(D=="object"||D=="function")}function Mn(E){return E!=null&&typeof E=="object"}var Bs=Ie?gt(Ie):Rs;function Sa(E){return wa(E)?Ts(E):Ns(E)}function ot(){return[]}function st(){return!1}n.exports=Ea})(zo,zo.exports);var kS=zo.exports;const WS=mm(kS);function YS(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var d=n.length,_=n.charAt(0),p=Math.log(d)/Math.log(256),w=Math.log(256)/Math.log(d);function T(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var B=0,K=0,oe=0,C=M.length;oe!==C&&M[oe]===0;)oe++,B++;for(var j=(C-oe)*w+1>>>0,O=new Uint8Array(j);oe!==C;){for(var R=M[oe],b=0,h=j-1;(R!==0||b<K)&&h!==-1;h--,b++)R+=256*O[h]>>>0,O[h]=R%d>>>0,R=R/d>>>0;if(R!==0)throw new Error("Non-zero carry");K=b,oe++}for(var m=j-K;m!==j&&O[m]===0;)m++;for(var k=_.repeat(B);m<j;++m)k+=n.charAt(O[m]);return k}function S(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var B=0;if(M[B]!==" "){for(var K=0,oe=0;M[B]===_;)K++,B++;for(var C=(M.length-B)*p+1>>>0,j=new Uint8Array(C);M[B];){var O=t[M.charCodeAt(B)];if(O===255)return;for(var R=0,b=C-1;(O!==0||R<oe)&&b!==-1;b--,R++)O+=d*j[b]>>>0,j[b]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");oe=R,B++}if(M[B]!==" "){for(var h=C-oe;h!==C&&j[h]===0;)h++;for(var m=new Uint8Array(K+(C-h)),k=K;h!==C;)m[k++]=j[h++];return m}}}function P(M){var B=S(M);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:S,decode:P}}var JS=YS,XS=JS;const vp=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},QS=n=>new TextEncoder().encode(n),ZS=n=>new TextDecoder().decode(n);class e2{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class t2{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return mp(this,e)}}class r2{constructor(e){this.decoders=e}or(e){return mp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const mp=(n,e)=>new r2({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class n2{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new e2(e,t,s),this.decoder=new t2(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ta=({name:n,prefix:e,encode:t,decode:s})=>new n2(n,e,t,s),Is=({prefix:n,name:e,alphabet:t})=>{const{encode:s,decode:o}=XS(t,e);return ta({prefix:n,name:e,encode:s,decode:c=>vp(o(c))})},i2=(n,e,t,s)=>{const o={};for(let w=0;w<e.length;++w)o[e[w]]=w;let c=n.length;for(;n[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let d=0,_=0,p=0;for(let w=0;w<c;++w){const T=o[n[w]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<t|T,d+=t,d>=8&&(d-=8,l[p++]=255&_>>d)}if(d>=t||255&_<<8-d)throw new SyntaxError("Unexpected end of data");return l},s2=(n,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,d=0;for(let _=0;_<n.length;++_)for(d=d<<8|n[_],l+=8;l>t;)l-=t,c+=e[o&d>>l];if(l&&(c+=e[o&d<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Yt=({name:n,prefix:e,bitsPerChar:t,alphabet:s})=>ta({prefix:e,name:n,encode(o){return s2(o,s,t)},decode(o){return i2(o,s,t,n)}}),o2=ta({prefix:"\0",name:"identity",encode:n=>ZS(n),decode:n=>QS(n)});var a2=Object.freeze({__proto__:null,identity:o2});const c2=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var u2=Object.freeze({__proto__:null,base2:c2});const h2=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var l2=Object.freeze({__proto__:null,base8:h2});const f2=Is({prefix:"9",name:"base10",alphabet:"0123456789"});var d2=Object.freeze({__proto__:null,base10:f2});const p2=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),g2=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _2=Object.freeze({__proto__:null,base16:p2,base16upper:g2});const y2=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),v2=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),m2=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),b2=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),w2=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),E2=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),S2=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),I2=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),O2=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var x2=Object.freeze({__proto__:null,base32:y2,base32upper:v2,base32pad:m2,base32padupper:b2,base32hex:w2,base32hexupper:E2,base32hexpad:S2,base32hexpadupper:I2,base32z:O2});const P2=Is({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),T2=Is({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var A2=Object.freeze({__proto__:null,base36:P2,base36upper:T2});const R2=Is({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),N2=Is({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var C2=Object.freeze({__proto__:null,base58btc:R2,base58flickr:N2});const $2=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),D2=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),U2=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),L2=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var j2=Object.freeze({__proto__:null,base64:$2,base64pad:D2,base64url:U2,base64urlpad:L2});const bp=Array.from(""),F2=bp.reduce((n,e,t)=>(n[t]=e,n),[]),M2=bp.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function H2(n){return n.reduce((e,t)=>(e+=F2[t],e),"")}function q2(n){const e=[];for(const t of n){const s=M2[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const z2=ta({prefix:"",name:"base256emoji",encode:H2,decode:q2});var B2=Object.freeze({__proto__:null,base256emoji:z2}),K2=wp,Kf=128,G2=127,V2=~G2,k2=Math.pow(2,31);function wp(n,e,t){e=e||[],t=t||0;for(var s=t;n>=k2;)e[t++]=n&255|Kf,n/=128;for(;n&V2;)e[t++]=n&255|Kf,n>>>=7;return e[t]=n|0,wp.bytes=t-s+1,e}var W2=vu,Y2=128,Gf=127;function vu(n,s){var t=0,s=s||0,o=0,c=s,l,d=n.length;do{if(c>=d)throw vu.bytes=0,new RangeError("Could not decode varint");l=n[c++],t+=o<28?(l&Gf)<<o:(l&Gf)*Math.pow(2,o),o+=7}while(l>=Y2);return vu.bytes=c-s,t}var J2=Math.pow(2,7),X2=Math.pow(2,14),Q2=Math.pow(2,21),Z2=Math.pow(2,28),eI=Math.pow(2,35),tI=Math.pow(2,42),rI=Math.pow(2,49),nI=Math.pow(2,56),iI=Math.pow(2,63),sI=function(n){return n<J2?1:n<X2?2:n<Q2?3:n<Z2?4:n<eI?5:n<tI?6:n<rI?7:n<nI?8:n<iI?9:10},oI={encode:K2,decode:W2,encodingLength:sI},Ep=oI;const Vf=(n,e,t=0)=>(Ep.encode(n,e,t),e),kf=n=>Ep.encodingLength(n),mu=(n,e)=>{const t=e.byteLength,s=kf(n),o=s+kf(t),c=new Uint8Array(o+t);return Vf(n,c,0),Vf(t,c,s),c.set(e,o),new aI(n,t,e,c)};class aI{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Sp=({name:n,code:e,encode:t})=>new cI(n,e,t);class cI{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?mu(this.code,t):t.then(s=>mu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Ip=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),uI=Sp({name:"sha2-256",code:18,encode:Ip("SHA-256")}),hI=Sp({name:"sha2-512",code:19,encode:Ip("SHA-512")});var lI=Object.freeze({__proto__:null,sha256:uI,sha512:hI});const Op=0,fI="identity",xp=vp,dI=n=>mu(Op,xp(n)),pI={code:Op,name:fI,encode:xp,digest:dI};var gI=Object.freeze({__proto__:null,identity:pI});new TextEncoder,new TextDecoder;const Wf={...a2,...u2,...l2,...d2,..._2,...x2,...A2,...C2,...j2,...B2};({...lI,...gI});function Pp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function _I(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Tp(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const Yf=Tp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),jc=Tp("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=_I(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),yI={utf8:Yf,"utf-8":Yf,hex:Wf.base16,latin1:jc,ascii:jc,binary:jc,...Wf};function vI(n,e="utf8"){const t=yI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Pp(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}const Ap="wc",mI=2,Bu="core",Nn=`${Ap}@2:${Bu}:`,bI={name:Bu,logger:"error"},wI={database:":memory:"},EI="crypto",Jf="client_ed25519_seed",SI=_e.ONE_DAY,II="keychain",OI="0.3",xI="messages",PI="0.3",TI=_e.SIX_HOURS,AI="publisher",Rp="irn",RI="error",Np="wss://relay.walletconnect.com",Xf="wss://relay.walletconnect.org",NI="relayer",Tt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},CI="_subscription",os={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},$I=_e.ONE_SECOND/2,DI="2.9.2",UI=1e4,LI="0.3",jI="WALLETCONNECT_CLIENT_ID",en={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},FI="subscription",MI="0.3",HI=_e.FIVE_SECONDS*1e3,qI="pairing",zI="0.3",as={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},Zr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},BI="history",KI="0.3",GI="expirer",Ur={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},VI="0.3",Fc="verify-api",Qf="https://verify.walletconnect.com";class kI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=II,this.version=OI,this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ip(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sp(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class WI{constructor(e,t,s){this.core=e,this.logger=t,this.name=EI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=bf(o);return Bd(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=QE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=bf(c),d=du();return await vE(d,o,SI,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const d=this.getPrivateKey(o),_=ZE(d,c);return this.setSymKey(_,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||e6(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const d=rp(l),_=vs(c);if(Pf(d)){const S=d.senderPublicKey,P=d.receiverPublicKey;o=await this.generateSharedKey(S,P)}const p=this.getSymKey(o),{type:w,senderPublicKey:T}=d;return r6({type:w,symKey:p,message:_,senderPublicKey:T})},this.decode=async(o,c,l)=>{this.isInitialized();const d=s6(c,l);if(Pf(d)){const _=d.receiverPublicKey,p=d.senderPublicKey;o=await this.generateSharedKey(_,p)}try{const _=this.getSymKey(o),p=n6({symKey:_,encoded:c});return Ou(p)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const c=Mo(o);return Ss(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Mo(o);return c.senderPublicKey?cr(c.senderPublicKey,ar):void 0},this.core=e,this.logger=Ze.generateChildLogger(t,this.name),this.keychain=s||new kI(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Jf)}catch{e=du(),await this.keychain.set(Jf,e)}return vI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class YI extends ww{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=xI,this.version=PI,this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Pi(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=Pi(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(e,this.name),this.core=t}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ip(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sp(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class JI extends Ew{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new jr.EventEmitter,this.name=AI,this.queue=new Map,this.publishTimeout=_e.toMiliseconds(_e.TEN_SECONDS),this.queueTimeout=_e.toMiliseconds(_e.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const l=(c==null?void 0:c.ttl)||TI,d=pu(c),_=(c==null?void 0:c.prompt)||!1,p=(c==null?void 0:c.tag)||0,w=(c==null?void 0:c.id)||Hu().toString(),T={topic:s,message:o,opts:{ttl:l,relay:d,prompt:_,tag:p,id:w}},S=setTimeout(()=>this.queue.set(w,T),this.queueTimeout);try{await await Ho(this.rpcPublish(s,o,l,d,_,p,w),this.publishTimeout),clearTimeout(S),this.relayer.events.emit(Tt.publish,T)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Ze.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,d){var _,p,w,T;const S={method:$o(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:d};return or((_=S.params)==null?void 0:_.prompt)&&((p=S.params)==null||delete p.prompt),or((w=S.params)==null?void 0:w.tag)&&((T=S.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ri.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Tt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Tt.message_ack,e=>{this.onPublish(e.id.toString())})}}class XI{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var QI=Object.defineProperty,ZI=Object.defineProperties,e3=Object.getOwnPropertyDescriptors,Zf=Object.getOwnPropertySymbols,t3=Object.prototype.hasOwnProperty,r3=Object.prototype.propertyIsEnumerable,ed=(n,e,t)=>e in n?QI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,cs=(n,e)=>{for(var t in e||(e={}))t3.call(e,t)&&ed(n,t,e[t]);if(Zf)for(var t of Zf(e))r3.call(e,t)&&ed(n,t,e[t]);return n},Mc=(n,e)=>ZI(n,e3(e));class n3 extends Ow{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new XI,this.events=new jr.EventEmitter,this.name=FI,this.version=MI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Nn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=pu(o),l={topic:s,relay:c};this.pending.set(s,l);const d=await this.rpcSubscribe(s,c);return this.onSubscribe(d,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),d}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const l=new _e.Watch;l.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=HI&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ze.generateChildLogger(t,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=pu(s);await this.rpcUnsubscribe(e,t,o);const c=$t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:$o(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ho(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Tt.connection_stalled)}return Pi(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:$o(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ho(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Tt.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:$o(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,Mc(cs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,cs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,cs({},t)),this.topicMap.set(t.topic,e),this.events.emit(en.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(en.deleted,Mc(cs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(en.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(en.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);tn(t)&&this.onBatchSubscribe(t.map((s,o)=>Mc(cs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Ri.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Tt.connect,async()=>{await this.onConnect()}),this.relayer.on(Tt.disconnect,()=>{this.onDisconnect()}),this.events.on(en.created,async e=>{const t=en.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(en.deleted,async e=>{const t=en.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var i3=Object.defineProperty,td=Object.getOwnPropertySymbols,s3=Object.prototype.hasOwnProperty,o3=Object.prototype.propertyIsEnumerable,rd=(n,e,t)=>e in n?i3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,a3=(n,e)=>{for(var t in e||(e={}))s3.call(e,t)&&rd(n,t,e[t]);if(td)for(var t of td(e))o3.call(e,t)&&rd(n,t,e[t]);return n};class c3 extends Sw{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new jr.EventEmitter,this.name=NI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ze.generateChildLogger(e.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:e.logger||RI})),this.messages=new YI(this.logger,e.core),this.subscriber=new n3(this,this.logger),this.publisher=new JI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Np,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Xf}...`),await this.restartTransport(Xf)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},UI)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(c=>{this.subscriber.once(en.created,l=>{l.topic===e&&c()})}),new Promise(async c=>{o=await this.subscriber.subscribe(e,t),c()})]),o)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Tt.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(en.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,s)=>{await Ho(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>s(o)).then(()=>t()).finally(()=>this.removeListener(Tt.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(Tt.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.events.emit(Tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(os.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new $n(new VS(_6({sdkVersion:DI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),zu(e)){if(!e.method.endsWith(CI))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(a3({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else ea(e)&&this.events.emit(Tt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Tt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=qu(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(os.payload,e=>this.onProviderPayload(e)),this.provider.on(os.connect,()=>{this.events.emit(Tt.connect)}),this.provider.on(os.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(os.error,e=>{this.logger.error(e),this.events.emit(Tt.error,e)})}registerEventListeners(){this.events.on(Tt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Tt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},_e.toMiliseconds($I))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var u3=Object.defineProperty,nd=Object.getOwnPropertySymbols,h3=Object.prototype.hasOwnProperty,l3=Object.prototype.propertyIsEnumerable,id=(n,e,t)=>e in n?u3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,sd=(n,e)=>{for(var t in e||(e={}))h3.call(e,t)&&id(n,t,e[t]);if(nd)for(var t of nd(e))l3.call(e,t)&&id(n,t,e[t]);return n};class ra extends Iw{constructor(e,t,s,o=Nn,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=LI,this.cached=[],this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!or(l)?this.map.set(this.getKey(l),l):M6(l)?this.map.set(l.id,l):H6(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,d)=>{this.isInitialized(),this.map.has(l)?await this.update(l,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:d}),this.map.set(l,d),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(d=>Object.keys(l).every(_=>WS(d[_],l[_]))):this.values),this.update=async(l,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:d});const _=sd(sd({},this.getData(l)),d);this.map.set(l,_),await this.persist()},this.delete=async(l,d)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:d}),this.map.delete(l),await this.persist())},this.logger=Ze.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class f3{constructor(e,t){this.core=e,this.logger=t,this.name=qI,this.version=zI,this.events=new Iu,this.initialized=!1,this.storagePrefix=Nn,this.ignoredPayloadTypes=[ri],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=du(),o=await this.core.crypto.setSymKey(s),c=Kr(_e.FIVE_MINUTES),l={protocol:Rp},d={topic:o,expiry:c,relay:l,active:!1},_=A6({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l});return await this.pairings.set(o,d),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l}=x6(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const d=Kr(_e.FIVE_MINUTES),_={topic:o,relay:l,expiry:d,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l}),this.core.expirer.set(o,d),s.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:s})=>{this.isInitialized();const o=Kr(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:d,reject:_}=xi();this.events.once(zt("pairing_ping",c),({error:p})=>{p?_(p):d()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",$t("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=Qo(o,c),d=await this.core.crypto.encode(s,l),_=as[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,d,_),l.id},this.sendResult=async(s,o,c)=>{const l=qu(s,c),d=await this.core.crypto.encode(o,l),_=await this.core.history.get(o,s),p=as[_.request.method].res;await this.core.relayer.publish(o,d,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=Zo(s,c),d=await this.core.crypto.encode(o,l),_=await this.core.history.get(o,s),p=as[_.request.method]?as[_.request.method].res:as.unregistered_method.res;await this.core.relayer.publish(o,d,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,$t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>An(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{yn(o)?this.events.emit(zt("pairing_ping",c),{}):Gr(o)&&this.events.emit(zt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const d=$t("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,d),this.logger.error(d)}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error($t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:o}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!F6(s.uri)){const{message:o}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!gr(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(An(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Ze.generateChildLogger(t,this.name),this.pairings=new ra(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Tt.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{zu(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ea(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Ur.expired,async e=>{const{topic:t}=ap(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class d3 extends bw{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new jr.EventEmitter,this.name=BI,this.version=KI,this.cached=[],this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Kr(_e.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Zr.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Gr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Zr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Zr.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Qo(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Zr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Zr.created,e=>{const t=Zr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Zr.updated,e=>{const t=Zr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Zr.deleted,e=>{const t=Zr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Ri.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{_e.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class p3 extends xw{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new jr.EventEmitter,this.name=GI,this.version=VI,this.cached=[],this.initialized=!1,this.storagePrefix=Nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Ur.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Ur.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return y6(e);if(typeof e=="number")return v6(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ur.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Ur.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Ri.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Ur.created,e=>{const t=Ur.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Ur.expired,e=>{const t=Ur.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Ur.deleted,e=>{const t=Ur.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class g3 extends Pw{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=Fc,this.initialized=!1,this.init=async s=>{np()||!Uu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Qf,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const c=this.startAbortTimer(_e.FIVE_SECONDS),l=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?(o=await l.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(Fc))return s();const c=document.createElement("iframe");c.setAttribute("id",Fc),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,s()}),c.addEventListener("error",l=>{o(l)}),document.body.append(c),this.iframe=c}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),_e.toMiliseconds(_e.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Ze.generateChildLogger(t,this.name),this.verifyUrl=Qf,this.abortController=new AbortController,this.isDevEnv=Du()&&{GITHUB_STATE:"/home/runner/work/_temp/_runner_file_commands/save_state_8f45f85f-1337-472c-9e0b-eec3b79b4fc0",STATS_TRP:"true",DEPLOYMENT_BASEPATH:"/opt/runner",DOTNET_NOLOGO:"1",USER:"runner",npm_config_user_agent:"npm/8.19.4 node/v16.20.2 linux x64 workspaces/false ci/github-actions",CI:"true",RUNNER_ENVIRONMENT:"github-hosted",GITHUB_ENV:"/home/runner/work/_temp/_runner_file_commands/set_env_8f45f85f-1337-472c-9e0b-eec3b79b4fc0",PIPX_HOME:"/opt/pipx",npm_node_execpath:"/opt/hostedtoolcache/node/16.20.2/x64/bin/node",JAVA_HOME_8_X64:"/usr/lib/jvm/temurin-8-jdk-amd64",SHLVL:"1",npm_config_noproxy:"",HOME:"/home/runner",RUNNER_TEMP:"/home/runner/work/_temp",GITHUB_EVENT_PATH:"/home/runner/work/_temp/_github_workflow/event.json",npm_package_json:"/home/runner/work/nefentus/nefentus/package.json",JAVA_HOME_11_X64:"/usr/lib/jvm/temurin-11-jdk-amd64",PIPX_BIN_DIR:"/opt/pipx_bin",GITHUB_REPOSITORY_OWNER:"Minerian",GRADLE_HOME:"/usr/share/gradle-8.6",ANDROID_NDK_LATEST_HOME:"/usr/local/lib/android/sdk/ndk/26.2.11394342",JAVA_HOME_21_X64:"/usr/lib/jvm/temurin-21-jdk-amd64",STATS_RDCL:"true",GITHUB_RETENTION_DAYS:"90",GITHUB_REPOSITORY_OWNER_ID:"108854816",POWERSHELL_DISTRIBUTION_CHANNEL:"GitHub-Actions-ubuntu22",AZURE_EXTENSION_DIR:"/opt/az/azcliextensions",GITHUB_HEAD_REF:"",npm_config_userconfig:"/home/runner/.npmrc",npm_config_local_prefix:"/home/runner/work/nefentus/nefentus",SYSTEMD_EXEC_PID:"597",GITHUB_GRAPHQL_URL:"https://api.github.com/graphql",COLOR:"0",GOROOT_1_20_X64:"/opt/hostedtoolcache/go/1.20.14/x64",NVM_DIR:"/home/runner/.nvm",npm_config_metrics_registry:"https://registry.npmjs.org/",DOTNET_SKIP_FIRST_TIME_EXPERIENCE:"1",GOROOT_1_21_X64:"/opt/hostedtoolcache/go/1.21.7/x64",JAVA_HOME_17_X64:"/usr/lib/jvm/temurin-17-jdk-amd64",ImageVersion:"20240218.1.0",RUNNER_OS:"Linux",GITHUB_API_URL:"https://api.github.com",GOROOT_1_22_X64:"/opt/hostedtoolcache/go/1.22.0/x64",SWIFT_PATH:"/usr/share/swift/usr/bin",RUNNER_USER:"runner",STATS_V3PS:"true",CHROMEWEBDRIVER:"/usr/local/share/chromedriver-linux64",JOURNAL_STREAM:"8:19778",GITHUB_WORKFLOW:"Deploy",_:"/opt/hostedtoolcache/node/16.20.2/x64/bin/npm",npm_config_prefix:"/opt/hostedtoolcache/node/16.20.2/x64",npm_config_cache:"/home/runner/.npm",ACTIONS_RUNNER_ACTION_ARCHIVE_CACHE:"/opt/actionarchivecache",GITHUB_RUN_ID:"8044175924",GITHUB_REF_TYPE:"branch",BOOTSTRAP_HASKELL_NONINTERACTIVE:"1",GITHUB_WORKFLOW_SHA:"83f92e7b509c81ca68e1e7d693be745b5f140ef7",GITHUB_BASE_REF:"",ImageOS:"ubuntu22",GITHUB_WORKFLOW_REF:"Minerian/nefentus/.github/workflows/deploy.yml@refs/heads/master",PERFLOG_LOCATION_SETTING:"RUNNER_PERFLOG",GITHUB_ACTION_REPOSITORY:"",npm_config_node_gyp:"/opt/hostedtoolcache/node/16.20.2/x64/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",PATH:"/home/runner/work/nefentus/nefentus/node_modules/.bin:/home/runner/work/nefentus/node_modules/.bin:/home/runner/work/node_modules/.bin:/home/runner/node_modules/.bin:/home/node_modules/.bin:/node_modules/.bin:/opt/hostedtoolcache/node/16.20.2/x64/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/hostedtoolcache/node/16.20.2/x64/bin:/snap/bin:/home/runner/.local/bin:/opt/pipx_bin:/home/runner/.cargo/bin:/home/runner/.config/composer/vendor/bin:/usr/local/.ghcup/bin:/home/runner/.dotnet/tools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin",ANT_HOME:"/usr/share/ant",DOTNET_MULTILEVEL_LOOKUP:"0",RUNNER_TRACKING_ID:"github_f42c1f5f-4b2f-47b8-b733-d4456eb61b81",INVOCATION_ID:"cc2966ef2b224682b7cee5486960a0c8",RUNNER_TOOL_CACHE:"/opt/hostedtoolcache",GOROOT_1_19_X64:"/opt/hostedtoolcache/go/1.19.13/x64",NODE:"/opt/hostedtoolcache/node/16.20.2/x64/bin/node",npm_package_name:"nefentus",GITHUB_ACTION:"__run",GITHUB_RUN_NUMBER:"5",GITHUB_TRIGGERING_ACTOR:"Nemanja2912",RUNNER_ARCH:"X64",XDG_RUNTIME_DIR:"/run/user/1001",AGENT_TOOLSDIRECTORY:"/opt/hostedtoolcache",LANG:"C.UTF-8",VCPKG_INSTALLATION_ROOT:"/usr/local/share/vcpkg",CONDA:"/usr/share/miniconda",RUNNER_NAME:"GitHub Actions 27",XDG_CONFIG_HOME:"/home/runner/.config",STATS_VMD:"true",GITHUB_REF_NAME:"master",GITHUB_REPOSITORY:"Minerian/nefentus",npm_lifecycle_script:"vite build",STATS_UE:"true",ANDROID_NDK_ROOT:"/usr/local/lib/android/sdk/ndk/25.2.9519653",GITHUB_ACTION_REF:"",DEBIAN_FRONTEND:"noninteractive",GITHUB_REPOSITORY_ID:"616414967",GITHUB_ACTIONS:"true",npm_package_version:"0.1.0",npm_lifecycle_event:"build",GITHUB_REF_PROTECTED:"false",GITHUB_WORKSPACE:"/home/runner/work/nefentus/nefentus",ACCEPT_EULA:"Y",GITHUB_JOB:"build",RUNNER_PERFLOG:"/home/runner/perflog",GITHUB_SHA:"83f92e7b509c81ca68e1e7d693be745b5f140ef7",GITHUB_RUN_ATTEMPT:"1",GITHUB_REF:"refs/heads/master",GITHUB_ACTOR:"Nemanja2912",ANDROID_SDK_ROOT:"/usr/local/lib/android/sdk",LEIN_HOME:"/usr/local/lib/lein",npm_config_globalconfig:"/opt/hostedtoolcache/node/16.20.2/x64/etc/npmrc",npm_config_init_module:"/home/runner/.npm-init.js",GITHUB_PATH:"/home/runner/work/_temp/_runner_file_commands/add_path_8f45f85f-1337-472c-9e0b-eec3b79b4fc0",JAVA_HOME:"/usr/lib/jvm/temurin-11-jdk-amd64",PWD:"/home/runner/work/nefentus/nefentus",GITHUB_ACTOR_ID:"48948445",RUNNER_WORKSPACE:"/home/runner/work/nefentus",npm_execpath:"/opt/hostedtoolcache/node/16.20.2/x64/lib/node_modules/npm/bin/npm-cli.js",HOMEBREW_CLEANUP_PERIODIC_FULL_DAYS:"3650",STATS_TIS:"mining",GITHUB_EVENT_NAME:"push",HOMEBREW_NO_AUTO_UPDATE:"1",ANDROID_HOME:"/usr/local/lib/android/sdk",GITHUB_SERVER_URL:"https://github.com",GECKOWEBDRIVER:"/usr/local/share/gecko_driver",LEIN_JAR:"/usr/local/lib/lein/self-installs/leiningen-2.11.2-standalone.jar",GHCUP_INSTALL_BASE_PREFIX:"/usr/local",GITHUB_OUTPUT:"/home/runner/work/_temp/_runner_file_commands/set_output_8f45f85f-1337-472c-9e0b-eec3b79b4fc0",npm_config_global_prefix:"/opt/hostedtoolcache/node/16.20.2/x64",EDGEWEBDRIVER:"/usr/local/share/edge_driver",STATS_EXT:"true",npm_command:"run-script",ANDROID_NDK:"/usr/local/lib/android/sdk/ndk/25.2.9519653",SGX_AESM_ADDR:"1",CHROME_BIN:"/usr/bin/google-chrome",SELENIUM_JAR_PATH:"/usr/share/java/selenium-server.jar",STATS_EXTP:"https://provjobdsettingscdn.blob.core.windows.net/settings/provjobdsettings-0.5.154/provjobd.data",ANDROID_NDK_HOME:"/usr/local/lib/android/sdk/ndk/25.2.9519653",GITHUB_STEP_SUMMARY:"/home/runner/work/_temp/_runner_file_commands/step_summary_8f45f85f-1337-472c-9e0b-eec3b79b4fc0",INIT_CWD:"/home/runner/work/nefentus/nefentus",EDITOR:"vi",NODE_ENV:"production",VITE_REACT_APP_BASE_ENDPOINT_API:"http://localhost:8080/api",VITE_REACT_APP_GA_ID:"G-HRH664KZ9E",VITE_REACT_APP_RECAPTCHA_SITE_KEY:"6Leb6H8oAAAAAM0q25gltEqlMOUUymzoDobq4NLc",VITE_REACT_APP_SECRET_WORD:"AppNefentusSuperPuperSecretWord"}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(e))}}var _3=Object.defineProperty,od=Object.getOwnPropertySymbols,y3=Object.prototype.hasOwnProperty,v3=Object.prototype.propertyIsEnumerable,ad=(n,e,t)=>e in n?_3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,cd=(n,e)=>{for(var t in e||(e={}))y3.call(e,t)&&ad(n,t,e[t]);if(od)for(var t of od(e))v3.call(e,t)&&ad(n,t,e[t]);return n};class Ku extends mw{constructor(e){super(e),this.protocol=Ap,this.version=mI,this.name=Bu,this.events=new jr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Np;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||bI.logger}));this.logger=Ze.generateChildLogger(t,this.name),this.heartbeat=new Ri.HeartBeat,this.crypto=new WI(this,this.logger,e==null?void 0:e.keychain),this.history=new d3(this,this.logger),this.expirer=new p3(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Ym(cd(cd({},wI),e==null?void 0:e.storageOptions)),this.relayer=new c3({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new f3(this,this.logger),this.verify=new g3(this.projectId||"",this.logger)}static async init(e){const t=new Ku(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(jI,s),t}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const m3=Ku,Cp="wc",$p=2,Dp="client",Gu=`${Cp}@${$p}:${Dp}:`,Hc={name:Dp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},ud="WALLETCONNECT_DEEPLINK_CHOICE",b3="proposal",Up="Proposal expired",w3="session",Ro=_e.SEVEN_DAYS,E3="engine",us={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},qc={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},hs={idle:"idle",active:"active"},S3="request",I3=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var O3=Object.defineProperty,x3=Object.defineProperties,P3=Object.getOwnPropertyDescriptors,hd=Object.getOwnPropertySymbols,T3=Object.prototype.hasOwnProperty,A3=Object.prototype.propertyIsEnumerable,ld=(n,e,t)=>e in n?O3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Dr=(n,e)=>{for(var t in e||(e={}))T3.call(e,t)&&ld(n,t,e[t]);if(hd)for(var t of hd(e))A3.call(e,t)&&ld(n,t,e[t]);return n},zc=(n,e)=>x3(n,P3(e));class R3 extends Aw{constructor(e){super(e),this.name=E3,this.events=new Iu,this.initialized=!1,this.ignoredPayloadTypes=[ri],this.requestQueue={state:hs.idle,requests:[]},this.requestQueueDelay=_e.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(us)}),this.initialized=!0,setTimeout(()=>{this.requestQueue.requests=this.getPendingSessionRequests(),this.processRequestQueue()},_e.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{this.isInitialized();const s=zc(Dr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:d,relays:_}=s;let p=o,w,T=!1;if(p&&(T=this.client.core.pairing.pairings.get(p).active),!p||!T){const{topic:j,uri:O}=await this.client.core.pairing.create();p=j,w=O}const S=await this.client.core.crypto.generateKeyPair(),P=Dr({requiredNamespaces:c,optionalNamespaces:l,relays:_??[{protocol:Rp}],proposer:{publicKey:S,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:M,resolve:B,done:K}=xi(_e.FIVE_MINUTES,Up);if(this.events.once(zt("session_connect"),async({error:j,session:O})=>{if(j)M(j);else if(O){O.self.publicKey=S;const R=zc(Dr({},O),{requiredNamespaces:O.requiredNamespaces,optionalNamespaces:O.optionalNamespaces});await this.client.session.set(O.topic,R),await this.setExpiry(O.topic,O.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:O.peer.metadata}),B(R)}}),!p){const{message:j}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(j)}const oe=await this.sendRequest(p,"wc_sessionPropose",P),C=Kr(_e.FIVE_MINUTES);return await this.setProposal(oe,Dr({id:oe,expiry:C},P)),{uri:w,approval:K}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,d=this.client.proposal.get(s);let{pairingTopic:_,proposer:p,requiredNamespaces:w,optionalNamespaces:T}=d;_=_||"",Ti(w)||(w=$6(c,"approve()"));const S=await this.client.core.crypto.generateKeyPair(),P=p.publicKey,M=await this.client.core.crypto.generateSharedKey(S,P);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:p.metadata}),await this.sendResult(s,_,{relay:{protocol:o??"irn"},responderPublicKey:S}),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const B=Dr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:T,pairingTopic:_,controller:{publicKey:S,metadata:this.client.metadata},expiry:Kr(Ro)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(M),await this.sendRequest(M,"wc_sessionSettle",B);const K=zc(Dr({},B),{topic:M,pairingTopic:_,acknowledged:!1,self:B.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:S});return await this.client.session.set(M,K),await this.setExpiry(M,Kr(Ro)),{topic:M,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(M)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:l,resolve:d,reject:_}=xi();return this.events.once(zt("session_update",c),({error:p})=>{p?_(p):d()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:c,resolve:l,reject:d}=xi();return this.events.once(zt("session_extend",o),({error:_})=>{_?d(_):l()}),await this.setExpiry(s,Kr(Ro)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l}=t,d=await this.sendRequest(c,"wc_sessionRequest",{request:o,chainId:s},l),{done:_,resolve:p,reject:w}=xi(l);this.events.once(zt("session_request",d),({error:S,result:P})=>{S?w(S):p(P)}),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:d});const T=await this.client.core.storage.getItem(ud);return m6({id:d,topic:c,wcDeepLink:T}),await _()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;yn(o)?await this.sendResult(c,s,o.result):Gr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:c,resolve:l,reject:d}=xi();this.events.once(zt("session_ping",o),({error:_})=>{_?d(_):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=Hu().toString();let c;const l=d=>{(d==null?void 0:d.id.toString())===o&&(this.client.core.relayer.events.removeListener(Tt.message_ack,l),c())};await Promise.all([new Promise(d=>{c=d,this.client.core.relayer.on(Tt.message_ack,l)}),this.sendRequest(s,"wc_sessionDelete",$t("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>L6(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,d;return((l=c.peerMetadata)==null?void 0:l.url)&&((d=c.peerMetadata)==null?void 0:d.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,$t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t),this.client.core.storage.removeItem(ud).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,$t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.requestQueue.requests=this.requestQueue.requests.filter(c=>c.id!==t),o&&(this.requestQueue.state=hs.idle)},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=us.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l}),s&&this.client.core.expirer.set(o,Kr(s))},this.sendRequest=async(t,s,o,c,l)=>{const d=Qo(s,o);if(Uu()&&I3.includes(s)){const w=Pi(JSON.stringify(d));await this.client.core.verify.register({attestationId:w})}const _=await this.client.core.crypto.encode(t,d),p=us[s].req;return c&&(p.ttl=c),l&&(p.id=l),this.client.core.history.set(t,d),this.client.core.relayer.publish(t,_,p),d.id},this.sendResult=async(t,s,o)=>{const c=qu(t,o),l=await this.client.core.crypto.encode(s,c),d=await this.client.core.history.get(s,t),_=us[d.request.method].res;this.client.core.relayer.publish(s,l,_),await this.client.core.history.resolve(c)},this.sendError=async(t,s,o)=>{const c=Zo(t,o),l=await this.client.core.crypto.encode(s,c),d=await this.client.core.history.get(s,t),_=us[d.request.method].res;this.client.core.relayer.publish(s,l,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{An(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{An(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(Dr({},s.params));const l=Kr(_e.FIVE_MINUTES),d=Dr({id:c,pairingTopic:t,expiry:l},o);await this.setProposal(c,d);const _=Pi(JSON.stringify(s)),p=await this.getVerifyContext(_,d.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(yn(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const d=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const p=await this.client.core.crypto.generateSharedKey(d,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const w=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:t})}else Gr(s)&&(await this.client.proposal.delete(o,$t("USER_DISCONNECTED")),this.events.emit(zt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:d,expiry:_,namespaces:p,requiredNamespaces:w,optionalNamespaces:T,sessionProperties:S,pairingTopic:P}=s.params,M=Dr({topic:t,relay:l,expiry:_,namespaces:p,acknowledged:!0,pairingTopic:P,requiredNamespaces:w,optionalNamespaces:T,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},S&&{sessionProperties:S});await this.sendResult(s.id,t,!0),this.events.emit(zt("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;yn(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(zt("session_approve",o),{})):Gr(s)&&(await this.client.session.delete(t,$t("USER_DISCONNECTED")),this.events.emit(zt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidUpdate(Dr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:o})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;yn(s)?this.events.emit(zt("session_update",o),{}):Gr(s)&&this.events.emit(zt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Kr(Ro)),await this.sendResult(o,t,!0),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;yn(s)?this.events.emit(zt("session_extend",o),{}):Gr(s)&&this.events.emit(zt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult(o,t,!0),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{yn(s)?this.events.emit(zt("session_ping",o),{}):Gr(s)&&this.events.emit(zt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Tt.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult(o,t,!0)]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(Dr({topic:t},c)),await this.setPendingSessionRequest({id:o,topic:t,params:c}),this.addRequestToQueue({id:o,topic:t,params:c}),await this.processRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;yn(s)?this.events.emit(zt("session_request",o),{result:s.result}):Gr(s)&&this.events.emit(zt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidEmit(Dr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c})}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addRequestToQueue=t=>{this.requestQueue.requests.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.requestQueue.state=hs.idle,this.processRequestQueue()},_e.toMiliseconds(this.requestQueueDelay))},this.processRequestQueue=async()=>{if(this.requestQueue.state===hs.active){this.client.logger.info("session request queue is already active.");return}const t=this.requestQueue.requests[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:o,params:c}=t,l=Pi(JSON.stringify({id:s,params:c})),d=this.client.session.get(o),_=await this.getVerifyContext(l,d.peer.metadata);this.requestQueue.state=hs.active,this.client.events.emit("session_request",{id:s,topic:o,params:c,verifyContext:_})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async t=>{if(!gr(t)){const{message:_}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:d}=t;if(or(s)||await this.isValidPairingTopic(s),!W6(d,!0)){const{message:_}=ue("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(_)}!or(o)&&Ti(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(c)&&Ti(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),or(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=k6(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!gr(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const d=this.client.proposal.get(s),_=Uo(o,"approve()");if(_)throw new Error(_.message);const p=Uf(d.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!kt(c,!0)){const{message:w}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(w)}or(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!gr(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!J6(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!gr(t)){const{message:p}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!up(s)){const{message:p}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const d=q6(o,"onSessionSettleRequest()");if(d)throw new Error(d.message);const _=Uo(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(An(l)){const{message:p}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!gr(t)){const{message:_}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Uo(o,"update()");if(l)throw new Error(l.message);const d=Uf(c.requiredNamespaces,o,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async t=>{if(!gr(t)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!gr(t)){const{message:_}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Df(d,c)){const{message:_}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!X6(o)){const{message:_}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!eS(d,c,o.method)){const{message:_}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(l&&!iS(l,qc)){const{message:_}=ue("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${qc.min} and ${qc.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!gr(t)){const{message:c}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!Q6(o)){const{message:c}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!gr(t)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!gr(t)){const{message:d}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(d)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!Df(l,c)){const{message:d}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(d)}if(!Z6(o)){const{message:d}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}if(!tS(l,c,o.name)){const{message:d}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}},this.isValidDisconnect=async t=>{if(!gr(t)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===s.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!kt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Tt.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{zu(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ea(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Ur.expired,async e=>{const{topic:t,id:s}=ap(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!kt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(An(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!kt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(An(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(kt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Y6(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(An(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class N3 extends ra{constructor(e,t){super(e,t,b3,Gu),this.core=e,this.logger=t}}class C3 extends ra{constructor(e,t){super(e,t,w3,Gu),this.core=e,this.logger=t}}class $3 extends ra{constructor(e,t){super(e,t,S3,Gu,s=>s.id),this.core=e,this.logger=t}}let D3=class Lp extends Tw{constructor(e){super(e),this.protocol=Cp,this.version=$p,this.name=Hc.name,this.events=new jr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Hc.name,this.metadata=(e==null?void 0:e.metadata)||f6();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Hc.logger}));this.core=(e==null?void 0:e.core)||new m3(e),this.logger=Ze.generateChildLogger(t,this.name),this.session=new C3(this.core,this.logger),this.proposal=new N3(this.core,this.logger),this.pendingRequest=new $3(this.core,this.logger),this.engine=new R3(this)}static async init(e){const t=new Lp(e);return await t.initialize(),t}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const U3={Accept:"application/json","Content-Type":"application/json"},L3="POST",fd={headers:U3,method:L3},dd=10;class ni{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new jr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Hf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=vs(e),c=await(await kl(this.url,Object.assign(Object.assign({},fd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Hf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=vs({id:1,jsonrpc:"2.0",method:"test",params:[]});await kl(e,Object.assign(Object.assign({},fd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ou(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=Zo(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return fp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>dd&&this.events.setMaxListeners(dd)}}const pd="error",j3="wss://relay.walletconnect.com",F3="wc",M3="universal_provider",gd=`${F3}@2:${M3}:`,H3="https://rpc.walletconnect.com/v1",Dn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",p=500,w="__lodash_placeholder__",T=1,S=2,P=4,M=1,B=2,K=1,oe=2,C=4,j=8,O=16,R=32,b=64,h=128,m=256,k=512,V=30,se="...",ce=800,ge=16,$=1,q=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,xe=re-1,ne=re>>>1,be=[["ary",h],["bind",K],["bindKey",oe],["curry",j],["curryRight",O],["flip",k],["partial",R],["partialRight",b],["rearg",m]],he="[object Arguments]",ve="[object Array]",H="[object AsyncFunction]",F="[object Boolean]",N="[object Date]",f="[object DOMException]",x="[object Error]",ie="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",ze="[object Number]",Ge="[object Null]",je="[object Object]",pt="[object Promise]",gt="[object Proxy]",Me="[object RegExp]",Oe="[object Set]",$e="[object String]",De="[object Symbol]",He="[object Undefined]",Te="[object WeakMap]",Ue="[object WeakSet]",Se="[object ArrayBuffer]",Ae="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Zt="[object Uint16Array]",ur="[object Uint32Array]",Vr=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,rn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vn=/&(?:amp|lt|gt|quot|#39);/g,Un=/[&<>"']/g,wt=RegExp(vn.source),_t=RegExp(Un.source),Et=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,jt=RegExp(It.source),Ot=/^\s+/,At=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Ft=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,na=/[()=,{}\[\]\/\s]/,ia=/\\(\\)?/g,sa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Or=/\w*$/,oa=/^[-+]0x[0-9a-f]+$/i,aa=/^0b[01]+$/i,ca=/^\[object .+?Constructor\]$/,ua=/^0o[0-7]+$/i,ha=/^(?:0|[1-9]\d*)$/,nn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ii=/($^)/,la=/['\n\r\u2028\u2029\\]/g,si="\\ud800-\\udfff",fa="\\u0300-\\u036f",da="\\ufe20-\\ufe2f",oi="\\u20d0-\\u20ff",Os=fa+da+oi,xs="\\u2700-\\u27bf",Fr="a-z\\xdf-\\xf6\\xf8-\\xff",pa="\\xac\\xb1\\xd7\\xf7",ga="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_a="\\u2000-\\u206f",ya=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ps="A-Z\\xc0-\\xd6\\xd8-\\xde",Ts="\\ufe0e\\ufe0f",Ln=pa+ga+_a+ya,Di="[']",jn="["+si+"]",Ui="["+Ln+"]",Fn="["+Os+"]",As="\\d+",va="["+xs+"]",Rs="["+Fr+"]",Ns="[^"+si+Ln+As+xs+Fr+Ps+"]",ai="\\ud83c[\\udffb-\\udfff]",ma="(?:"+Fn+"|"+ai+")",Cs="[^"+si+"]",ci="(?:\\ud83c[\\udde6-\\uddff]){2}",mn="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+Ps+"]",$s="\\u200d",Ds="(?:"+Rs+"|"+Ns+")",kr="(?:"+yr+"|"+Ns+")",Us="(?:"+Di+"(?:d|ll|m|re|s|t|ve))?",Ls="(?:"+Di+"(?:D|LL|M|RE|S|T|VE))?",js=ma+"?",Fs="["+Ts+"]?",ba="(?:"+$s+"(?:"+[Cs,ci,mn].join("|")+")"+Fs+js+")*",sn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ms="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Hs=Fs+js+ba,ui="(?:"+[va,ci,mn].join("|")+")"+Hs,wa="(?:"+[Cs+Fn+"?",Fn,ci,mn,jn].join("|")+")",Li=RegExp(Di,"g"),Ea=RegExp(Fn,"g"),hi=RegExp(ai+"(?="+ai+")|"+wa+Hs,"g"),qs=RegExp([yr+"?"+Rs+"+"+Us+"(?="+[Ui,yr,"$"].join("|")+")",kr+"+"+Ls+"(?="+[Ui,yr+Ds,"$"].join("|")+")",yr+"?"+Ds+"+"+Us,yr+"+"+Ls,Ms,sn,As,ui].join("|"),"g"),zs=RegExp("["+$s+si+Os+Ts+"]"),Mn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Bs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sa=-1,ot={};ot[Be]=ot[Pe]=ot[Ve]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[Zt]=ot[ur]=!0,ot[he]=ot[ve]=ot[Se]=ot[F]=ot[Ae]=ot[N]=ot[x]=ot[ie]=ot[Ie]=ot[ze]=ot[je]=ot[Me]=ot[Oe]=ot[$e]=ot[Te]=!1;var st={};st[he]=st[ve]=st[Se]=st[Ae]=st[F]=st[N]=st[Be]=st[Pe]=st[Ve]=st[We]=st[et]=st[Ie]=st[ze]=st[je]=st[Me]=st[Oe]=st[$e]=st[De]=st[tt]=st[Je]=st[Zt]=st[ur]=!0,st[x]=st[ie]=st[Te]=!1;var E={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ne=parseInt,ft=typeof ls=="object"&&ls&&ls.Object===Object&&ls,Ht=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||Ht||Function("return this")(),ct=e&&!e.nodeType&&e,Rt=ct&&!0&&n&&!n.nodeType&&n,hr=Rt&&Rt.exports===ct,qt=hr&&ft.process,dt=function(){try{var U=Rt&&Rt.require&&Rt.require("util").types;return U||qt&&qt.binding&&qt.binding("util")}catch{}}(),tr=dt&&dt.isArrayBuffer,Mr=dt&&dt.isDate,xr=dt&&dt.isMap,Wr=dt&&dt.isRegExp,ji=dt&&dt.isSet,Hn=dt&&dt.isTypedArray;function Gt(U,G,z){switch(z.length){case 0:return U.call(G);case 1:return U.call(G,z[0]);case 2:return U.call(G,z[0],z[1]);case 3:return U.call(G,z[0],z[1],z[2])}return U.apply(G,z)}function Mp(U,G,z,pe){for(var Re=-1,rt=U==null?0:U.length;++Re<rt;){var Bt=U[Re];G(pe,Bt,z(Bt),U)}return pe}function Pr(U,G){for(var z=-1,pe=U==null?0:U.length;++z<pe&&G(U[z],z,U)!==!1;);return U}function Hp(U,G){for(var z=U==null?0:U.length;z--&&G(U[z],z,U)!==!1;);return U}function Wu(U,G){for(var z=-1,pe=U==null?0:U.length;++z<pe;)if(!G(U[z],z,U))return!1;return!0}function bn(U,G){for(var z=-1,pe=U==null?0:U.length,Re=0,rt=[];++z<pe;){var Bt=U[z];G(Bt,z,U)&&(rt[Re++]=Bt)}return rt}function Ks(U,G){var z=U==null?0:U.length;return!!z&&li(U,G,0)>-1}function Ia(U,G,z){for(var pe=-1,Re=U==null?0:U.length;++pe<Re;)if(z(G,U[pe]))return!0;return!1}function vt(U,G){for(var z=-1,pe=U==null?0:U.length,Re=Array(pe);++z<pe;)Re[z]=G(U[z],z,U);return Re}function wn(U,G){for(var z=-1,pe=G.length,Re=U.length;++z<pe;)U[Re+z]=G[z];return U}function Oa(U,G,z,pe){var Re=-1,rt=U==null?0:U.length;for(pe&&rt&&(z=U[++Re]);++Re<rt;)z=G(z,U[Re],Re,U);return z}function qp(U,G,z,pe){var Re=U==null?0:U.length;for(pe&&Re&&(z=U[--Re]);Re--;)z=G(z,U[Re],Re,U);return z}function xa(U,G){for(var z=-1,pe=U==null?0:U.length;++z<pe;)if(G(U[z],z,U))return!0;return!1}var zp=Pa("length");function Bp(U){return U.split("")}function Kp(U){return U.match(Mt)||[]}function Yu(U,G,z){var pe;return z(U,function(Re,rt,Bt){if(G(Re,rt,Bt))return pe=rt,!1}),pe}function Gs(U,G,z,pe){for(var Re=U.length,rt=z+(pe?1:-1);pe?rt--:++rt<Re;)if(G(U[rt],rt,U))return rt;return-1}function li(U,G,z){return G===G?rg(U,G,z):Gs(U,Ju,z)}function Gp(U,G,z,pe){for(var Re=z-1,rt=U.length;++Re<rt;)if(pe(U[Re],G))return Re;return-1}function Ju(U){return U!==U}function Xu(U,G){var z=U==null?0:U.length;return z?Aa(U,G)/z:Y}function Pa(U){return function(G){return G==null?t:G[U]}}function Ta(U){return function(G){return U==null?t:U[G]}}function Qu(U,G,z,pe,Re){return Re(U,function(rt,Bt,ut){z=pe?(pe=!1,rt):G(z,rt,Bt,ut)}),z}function Vp(U,G){var z=U.length;for(U.sort(G);z--;)U[z]=U[z].value;return U}function Aa(U,G){for(var z,pe=-1,Re=U.length;++pe<Re;){var rt=G(U[pe]);rt!==t&&(z=z===t?rt:z+rt)}return z}function Ra(U,G){for(var z=-1,pe=Array(U);++z<U;)pe[z]=G(z);return pe}function kp(U,G){return vt(G,function(z){return[z,U[z]]})}function Zu(U){return U&&U.slice(0,nh(U)+1).replace(Ot,"")}function vr(U){return function(G){return U(G)}}function Na(U,G){return vt(G,function(z){return U[z]})}function Fi(U,G){return U.has(G)}function eh(U,G){for(var z=-1,pe=U.length;++z<pe&&li(G,U[z],0)>-1;);return z}function th(U,G){for(var z=U.length;z--&&li(G,U[z],0)>-1;);return z}function Wp(U,G){for(var z=U.length,pe=0;z--;)U[z]===G&&++pe;return pe}var Yp=Ta(E),Jp=Ta(D);function Xp(U){return"\\"+de[U]}function Qp(U,G){return U==null?t:U[G]}function fi(U){return zs.test(U)}function Zp(U){return Mn.test(U)}function eg(U){for(var G,z=[];!(G=U.next()).done;)z.push(G.value);return z}function Ca(U){var G=-1,z=Array(U.size);return U.forEach(function(pe,Re){z[++G]=[Re,pe]}),z}function rh(U,G){return function(z){return U(G(z))}}function En(U,G){for(var z=-1,pe=U.length,Re=0,rt=[];++z<pe;){var Bt=U[z];(Bt===G||Bt===w)&&(U[z]=w,rt[Re++]=z)}return rt}function Vs(U){var G=-1,z=Array(U.size);return U.forEach(function(pe){z[++G]=pe}),z}function tg(U){var G=-1,z=Array(U.size);return U.forEach(function(pe){z[++G]=[pe,pe]}),z}function rg(U,G,z){for(var pe=z-1,Re=U.length;++pe<Re;)if(U[pe]===G)return pe;return-1}function ng(U,G,z){for(var pe=z+1;pe--;)if(U[pe]===G)return pe;return pe}function di(U){return fi(U)?sg(U):zp(U)}function Hr(U){return fi(U)?og(U):Bp(U)}function nh(U){for(var G=U.length;G--&&At.test(U.charAt(G)););return G}var ig=Ta(Q);function sg(U){for(var G=hi.lastIndex=0;hi.test(U);)++G;return G}function og(U){return U.match(hi)||[]}function ag(U){return U.match(qs)||[]}var cg=function U(G){G=G==null?Xe:pi.defaults(Xe.Object(),G,pi.pick(Xe,Bs));var z=G.Array,pe=G.Date,Re=G.Error,rt=G.Function,Bt=G.Math,ut=G.Object,$a=G.RegExp,ug=G.String,Tr=G.TypeError,ks=z.prototype,hg=rt.prototype,gi=ut.prototype,Ws=G["__core-js_shared__"],Ys=hg.toString,it=gi.hasOwnProperty,lg=0,ih=function(){var r=/[^.]+$/.exec(Ws&&Ws.keys&&Ws.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Js=gi.toString,fg=Ys.call(ut),dg=Xe._,pg=$a("^"+Ys.call(it).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xs=hr?G.Buffer:t,Sn=G.Symbol,Qs=G.Uint8Array,sh=Xs?Xs.allocUnsafe:t,Zs=rh(ut.getPrototypeOf,ut),oh=ut.create,ah=gi.propertyIsEnumerable,eo=ks.splice,ch=Sn?Sn.isConcatSpreadable:t,Mi=Sn?Sn.iterator:t,qn=Sn?Sn.toStringTag:t,to=function(){try{var r=Vn(ut,"defineProperty");return r({},"",{}),r}catch{}}(),gg=G.clearTimeout!==Xe.clearTimeout&&G.clearTimeout,_g=pe&&pe.now!==Xe.Date.now&&pe.now,yg=G.setTimeout!==Xe.setTimeout&&G.setTimeout,ro=Bt.ceil,no=Bt.floor,Da=ut.getOwnPropertySymbols,vg=Xs?Xs.isBuffer:t,uh=G.isFinite,mg=ks.join,bg=rh(ut.keys,ut),Kt=Bt.max,Jt=Bt.min,wg=pe.now,Eg=G.parseInt,hh=Bt.random,Sg=ks.reverse,Ua=Vn(G,"DataView"),Hi=Vn(G,"Map"),La=Vn(G,"Promise"),_i=Vn(G,"Set"),qi=Vn(G,"WeakMap"),zi=Vn(ut,"create"),io=qi&&new qi,yi={},Ig=kn(Ua),Og=kn(Hi),xg=kn(La),Pg=kn(_i),Tg=kn(qi),so=Sn?Sn.prototype:t,Bi=so?so.valueOf:t,lh=so?so.toString:t;function y(r){if(Pt(r)&&!Ce(r)&&!(r instanceof Ye)){if(r instanceof Ar)return r;if(it.call(r,"__wrapped__"))return fl(r)}return new Ar(r)}var vi=function(){function r(){}return function(i){if(!bt(i))return{};if(oh)return oh(i);r.prototype=i;var a=new r;return r.prototype=t,a}}();function oo(){}function Ar(r,i){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}y.templateSettings={escape:Et,evaluate:St,interpolate:mt,variable:"",imports:{_:y}},y.prototype=oo.prototype,y.prototype.constructor=y,Ar.prototype=vi(oo.prototype),Ar.prototype.constructor=Ar;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Ag(){var r=new Ye(this.__wrapped__);return r.__actions__=lr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=lr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=lr(this.__views__),r}function Rg(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Ng(){var r=this.__wrapped__.value(),i=this.__dir__,a=Ce(r),u=i<0,g=a?r.length:0,v=B0(0,g,this.__views__),I=v.start,A=v.end,L=A-I,J=u?A:I-1,X=this.__iteratees__,Z=X.length,ae=0,ye=Jt(L,this.__takeCount__);if(!a||!u&&g==L&&ye==L)return Uh(r,this.__actions__);var we=[];e:for(;L--&&ae<ye;){J+=i;for(var qe=-1,Ee=r[J];++qe<Z;){var ke=X[qe],Qe=ke.iteratee,wr=ke.type,ir=Qe(Ee);if(wr==q)Ee=ir;else if(!ir){if(wr==$)continue e;break e}}we[ae++]=Ee}return we}Ye.prototype=vi(oo.prototype),Ye.prototype.constructor=Ye;function zn(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var u=r[i];this.set(u[0],u[1])}}function Cg(){this.__data__=zi?zi(null):{},this.size=0}function $g(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}function Dg(r){var i=this.__data__;if(zi){var a=i[r];return a===_?t:a}return it.call(i,r)?i[r]:t}function Ug(r){var i=this.__data__;return zi?i[r]!==t:it.call(i,r)}function Lg(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=zi&&i===t?_:i,this}zn.prototype.clear=Cg,zn.prototype.delete=$g,zn.prototype.get=Dg,zn.prototype.has=Ug,zn.prototype.set=Lg;function on(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var u=r[i];this.set(u[0],u[1])}}function jg(){this.__data__=[],this.size=0}function Fg(r){var i=this.__data__,a=ao(i,r);if(a<0)return!1;var u=i.length-1;return a==u?i.pop():eo.call(i,a,1),--this.size,!0}function Mg(r){var i=this.__data__,a=ao(i,r);return a<0?t:i[a][1]}function Hg(r){return ao(this.__data__,r)>-1}function qg(r,i){var a=this.__data__,u=ao(a,r);return u<0?(++this.size,a.push([r,i])):a[u][1]=i,this}on.prototype.clear=jg,on.prototype.delete=Fg,on.prototype.get=Mg,on.prototype.has=Hg,on.prototype.set=qg;function an(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var u=r[i];this.set(u[0],u[1])}}function zg(){this.size=0,this.__data__={hash:new zn,map:new(Hi||on),string:new zn}}function Bg(r){var i=bo(this,r).delete(r);return this.size-=i?1:0,i}function Kg(r){return bo(this,r).get(r)}function Gg(r){return bo(this,r).has(r)}function Vg(r,i){var a=bo(this,r),u=a.size;return a.set(r,i),this.size+=a.size==u?0:1,this}an.prototype.clear=zg,an.prototype.delete=Bg,an.prototype.get=Kg,an.prototype.has=Gg,an.prototype.set=Vg;function Bn(r){var i=-1,a=r==null?0:r.length;for(this.__data__=new an;++i<a;)this.add(r[i])}function kg(r){return this.__data__.set(r,_),this}function Wg(r){return this.__data__.has(r)}Bn.prototype.add=Bn.prototype.push=kg,Bn.prototype.has=Wg;function qr(r){var i=this.__data__=new on(r);this.size=i.size}function Yg(){this.__data__=new on,this.size=0}function Jg(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}function Xg(r){return this.__data__.get(r)}function Qg(r){return this.__data__.has(r)}function Zg(r,i){var a=this.__data__;if(a instanceof on){var u=a.__data__;if(!Hi||u.length<o-1)return u.push([r,i]),this.size=++a.size,this;a=this.__data__=new an(u)}return a.set(r,i),this.size=a.size,this}qr.prototype.clear=Yg,qr.prototype.delete=Jg,qr.prototype.get=Xg,qr.prototype.has=Qg,qr.prototype.set=Zg;function fh(r,i){var a=Ce(r),u=!a&&Wn(r),g=!a&&!u&&Tn(r),v=!a&&!u&&!g&&Ei(r),I=a||u||g||v,A=I?Ra(r.length,ug):[],L=A.length;for(var J in r)(i||it.call(r,J))&&!(I&&(J=="length"||g&&(J=="offset"||J=="parent")||v&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||ln(J,L)))&&A.push(J);return A}function dh(r){var i=r.length;return i?r[ka(0,i-1)]:t}function e0(r,i){return wo(lr(r),Kn(i,0,r.length))}function t0(r){return wo(lr(r))}function ja(r,i,a){(a!==t&&!zr(r[i],a)||a===t&&!(i in r))&&cn(r,i,a)}function Ki(r,i,a){var u=r[i];(!(it.call(r,i)&&zr(u,a))||a===t&&!(i in r))&&cn(r,i,a)}function ao(r,i){for(var a=r.length;a--;)if(zr(r[a][0],i))return a;return-1}function r0(r,i,a,u){return In(r,function(g,v,I){i(u,g,a(g),I)}),u}function ph(r,i){return r&&Jr(i,Vt(i),r)}function n0(r,i){return r&&Jr(i,dr(i),r)}function cn(r,i,a){i=="__proto__"&&to?to(r,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[i]=a}function Fa(r,i){for(var a=-1,u=i.length,g=z(u),v=r==null;++a<u;)g[a]=v?t:vc(r,i[a]);return g}function Kn(r,i,a){return r===r&&(a!==t&&(r=r<=a?r:a),i!==t&&(r=r>=i?r:i)),r}function Rr(r,i,a,u,g,v){var I,A=i&T,L=i&S,J=i&P;if(a&&(I=g?a(r,u,g,v):a(r)),I!==t)return I;if(!bt(r))return r;var X=Ce(r);if(X){if(I=G0(r),!A)return lr(r,I)}else{var Z=Xt(r),ae=Z==ie||Z==fe;if(Tn(r))return Fh(r,A);if(Z==je||Z==he||ae&&!g){if(I=L||ae?{}:nl(r),!A)return L?D0(r,n0(I,r)):$0(r,ph(I,r))}else{if(!st[Z])return g?r:{};I=V0(r,Z,A)}}v||(v=new qr);var ye=v.get(r);if(ye)return ye;v.set(r,I),Cl(r)?r.forEach(function(Ee){I.add(Rr(Ee,i,a,Ee,r,v))}):Rl(r)&&r.forEach(function(Ee,ke){I.set(ke,Rr(Ee,i,a,ke,r,v))});var we=J?L?ic:nc:L?dr:Vt,qe=X?t:we(r);return Pr(qe||r,function(Ee,ke){qe&&(ke=Ee,Ee=r[ke]),Ki(I,ke,Rr(Ee,i,a,ke,r,v))}),I}function i0(r){var i=Vt(r);return function(a){return gh(a,r,i)}}function gh(r,i,a){var u=a.length;if(r==null)return!u;for(r=ut(r);u--;){var g=a[u],v=i[g],I=r[g];if(I===t&&!(g in r)||!v(I))return!1}return!0}function _h(r,i,a){if(typeof r!="function")throw new Tr(l);return Xi(function(){r.apply(t,a)},i)}function Gi(r,i,a,u){var g=-1,v=Ks,I=!0,A=r.length,L=[],J=i.length;if(!A)return L;a&&(i=vt(i,vr(a))),u?(v=Ia,I=!1):i.length>=o&&(v=Fi,I=!1,i=new Bn(i));e:for(;++g<A;){var X=r[g],Z=a==null?X:a(X);if(X=u||X!==0?X:0,I&&Z===Z){for(var ae=J;ae--;)if(i[ae]===Z)continue e;L.push(X)}else v(i,Z,u)||L.push(X)}return L}var In=Bh(Yr),yh=Bh(Ha,!0);function s0(r,i){var a=!0;return In(r,function(u,g,v){return a=!!i(u,g,v),a}),a}function co(r,i,a){for(var u=-1,g=r.length;++u<g;){var v=r[u],I=i(v);if(I!=null&&(A===t?I===I&&!br(I):a(I,A)))var A=I,L=v}return L}function o0(r,i,a,u){var g=r.length;for(a=Fe(a),a<0&&(a=-a>g?0:g+a),u=u===t||u>g?g:Fe(u),u<0&&(u+=g),u=a>u?0:Dl(u);a<u;)r[a++]=i;return r}function vh(r,i){var a=[];return In(r,function(u,g,v){i(u,g,v)&&a.push(u)}),a}function Wt(r,i,a,u,g){var v=-1,I=r.length;for(a||(a=W0),g||(g=[]);++v<I;){var A=r[v];i>0&&a(A)?i>1?Wt(A,i-1,a,u,g):wn(g,A):u||(g[g.length]=A)}return g}var Ma=Kh(),mh=Kh(!0);function Yr(r,i){return r&&Ma(r,i,Vt)}function Ha(r,i){return r&&mh(r,i,Vt)}function uo(r,i){return bn(i,function(a){return fn(r[a])})}function Gn(r,i){i=xn(i,r);for(var a=0,u=i.length;r!=null&&a<u;)r=r[Xr(i[a++])];return a&&a==u?r:t}function bh(r,i,a){var u=i(r);return Ce(r)?u:wn(u,a(r))}function rr(r){return r==null?r===t?He:Ge:qn&&qn in ut(r)?z0(r):t_(r)}function qa(r,i){return r>i}function a0(r,i){return r!=null&&it.call(r,i)}function c0(r,i){return r!=null&&i in ut(r)}function u0(r,i,a){return r>=Jt(i,a)&&r<Kt(i,a)}function za(r,i,a){for(var u=a?Ia:Ks,g=r[0].length,v=r.length,I=v,A=z(v),L=1/0,J=[];I--;){var X=r[I];I&&i&&(X=vt(X,vr(i))),L=Jt(X.length,L),A[I]=!a&&(i||g>=120&&X.length>=120)?new Bn(I&&X):t}X=r[0];var Z=-1,ae=A[0];e:for(;++Z<g&&J.length<L;){var ye=X[Z],we=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(ae?Fi(ae,we):u(J,we,a))){for(I=v;--I;){var qe=A[I];if(!(qe?Fi(qe,we):u(r[I],we,a)))continue e}ae&&ae.push(we),J.push(ye)}}return J}function h0(r,i,a,u){return Yr(r,function(g,v,I){i(u,a(g),v,I)}),u}function Vi(r,i,a){i=xn(i,r),r=al(r,i);var u=r==null?r:r[Xr(Cr(i))];return u==null?t:Gt(u,r,a)}function wh(r){return Pt(r)&&rr(r)==he}function l0(r){return Pt(r)&&rr(r)==Se}function f0(r){return Pt(r)&&rr(r)==N}function ki(r,i,a,u,g){return r===i?!0:r==null||i==null||!Pt(r)&&!Pt(i)?r!==r&&i!==i:d0(r,i,a,u,ki,g)}function d0(r,i,a,u,g,v){var I=Ce(r),A=Ce(i),L=I?ve:Xt(r),J=A?ve:Xt(i);L=L==he?je:L,J=J==he?je:J;var X=L==je,Z=J==je,ae=L==J;if(ae&&Tn(r)){if(!Tn(i))return!1;I=!0,X=!1}if(ae&&!X)return v||(v=new qr),I||Ei(r)?el(r,i,a,u,g,v):H0(r,i,L,a,u,g,v);if(!(a&M)){var ye=X&&it.call(r,"__wrapped__"),we=Z&&it.call(i,"__wrapped__");if(ye||we){var qe=ye?r.value():r,Ee=we?i.value():i;return v||(v=new qr),g(qe,Ee,a,u,v)}}return ae?(v||(v=new qr),q0(r,i,a,u,g,v)):!1}function p0(r){return Pt(r)&&Xt(r)==Ie}function Ba(r,i,a,u){var g=a.length,v=g,I=!u;if(r==null)return!v;for(r=ut(r);g--;){var A=a[g];if(I&&A[2]?A[1]!==r[A[0]]:!(A[0]in r))return!1}for(;++g<v;){A=a[g];var L=A[0],J=r[L],X=A[1];if(I&&A[2]){if(J===t&&!(L in r))return!1}else{var Z=new qr;if(u)var ae=u(J,X,L,r,i,Z);if(!(ae===t?ki(X,J,M|B,u,Z):ae))return!1}}return!0}function Eh(r){if(!bt(r)||J0(r))return!1;var i=fn(r)?pg:ca;return i.test(kn(r))}function g0(r){return Pt(r)&&rr(r)==Me}function _0(r){return Pt(r)&&Xt(r)==Oe}function y0(r){return Pt(r)&&Po(r.length)&&!!ot[rr(r)]}function Sh(r){return typeof r=="function"?r:r==null?pr:typeof r=="object"?Ce(r)?xh(r[0],r[1]):Oh(r):Gl(r)}function Ka(r){if(!Ji(r))return bg(r);var i=[];for(var a in ut(r))it.call(r,a)&&a!="constructor"&&i.push(a);return i}function v0(r){if(!bt(r))return e_(r);var i=Ji(r),a=[];for(var u in r)u=="constructor"&&(i||!it.call(r,u))||a.push(u);return a}function Ga(r,i){return r<i}function Ih(r,i){var a=-1,u=fr(r)?z(r.length):[];return In(r,function(g,v,I){u[++a]=i(g,v,I)}),u}function Oh(r){var i=oc(r);return i.length==1&&i[0][2]?sl(i[0][0],i[0][1]):function(a){return a===r||Ba(a,r,i)}}function xh(r,i){return cc(r)&&il(i)?sl(Xr(r),i):function(a){var u=vc(a,r);return u===t&&u===i?mc(a,r):ki(i,u,M|B)}}function ho(r,i,a,u,g){r!==i&&Ma(i,function(v,I){if(g||(g=new qr),bt(v))m0(r,i,I,a,ho,u,g);else{var A=u?u(hc(r,I),v,I+"",r,i,g):t;A===t&&(A=v),ja(r,I,A)}},dr)}function m0(r,i,a,u,g,v,I){var A=hc(r,a),L=hc(i,a),J=I.get(L);if(J){ja(r,a,J);return}var X=v?v(A,L,a+"",r,i,I):t,Z=X===t;if(Z){var ae=Ce(L),ye=!ae&&Tn(L),we=!ae&&!ye&&Ei(L);X=L,ae||ye||we?Ce(A)?X=A:Nt(A)?X=lr(A):ye?(Z=!1,X=Fh(L,!0)):we?(Z=!1,X=Mh(L,!0)):X=[]:Qi(L)||Wn(L)?(X=A,Wn(A)?X=Ul(A):(!bt(A)||fn(A))&&(X=nl(L))):Z=!1}Z&&(I.set(L,X),g(X,L,u,v,I),I.delete(L)),ja(r,a,X)}function Ph(r,i){var a=r.length;if(a)return i+=i<0?a:0,ln(i,a)?r[i]:t}function Th(r,i,a){i.length?i=vt(i,function(v){return Ce(v)?function(I){return Gn(I,v.length===1?v[0]:v)}:v}):i=[pr];var u=-1;i=vt(i,vr(me()));var g=Ih(r,function(v,I,A){var L=vt(i,function(J){return J(v)});return{criteria:L,index:++u,value:v}});return Vp(g,function(v,I){return C0(v,I,a)})}function b0(r,i){return Ah(r,i,function(a,u){return mc(r,u)})}function Ah(r,i,a){for(var u=-1,g=i.length,v={};++u<g;){var I=i[u],A=Gn(r,I);a(A,I)&&Wi(v,xn(I,r),A)}return v}function w0(r){return function(i){return Gn(i,r)}}function Va(r,i,a,u){var g=u?Gp:li,v=-1,I=i.length,A=r;for(r===i&&(i=lr(i)),a&&(A=vt(r,vr(a)));++v<I;)for(var L=0,J=i[v],X=a?a(J):J;(L=g(A,X,L,u))>-1;)A!==r&&eo.call(A,L,1),eo.call(r,L,1);return r}function Rh(r,i){for(var a=r?i.length:0,u=a-1;a--;){var g=i[a];if(a==u||g!==v){var v=g;ln(g)?eo.call(r,g,1):Ja(r,g)}}return r}function ka(r,i){return r+no(hh()*(i-r+1))}function E0(r,i,a,u){for(var g=-1,v=Kt(ro((i-r)/(a||1)),0),I=z(v);v--;)I[u?v:++g]=r,r+=a;return I}function Wa(r,i){var a="";if(!r||i<1||i>W)return a;do i%2&&(a+=r),i=no(i/2),i&&(r+=r);while(i);return a}function Ke(r,i){return lc(ol(r,i,pr),r+"")}function S0(r){return dh(Si(r))}function I0(r,i){var a=Si(r);return wo(a,Kn(i,0,a.length))}function Wi(r,i,a,u){if(!bt(r))return r;i=xn(i,r);for(var g=-1,v=i.length,I=v-1,A=r;A!=null&&++g<v;){var L=Xr(i[g]),J=a;if(L==="__proto__"||L==="constructor"||L==="prototype")return r;if(g!=I){var X=A[L];J=u?u(X,L,A):t,J===t&&(J=bt(X)?X:ln(i[g+1])?[]:{})}Ki(A,L,J),A=A[L]}return r}var Nh=io?function(r,i){return io.set(r,i),r}:pr,O0=to?function(r,i){return to(r,"toString",{configurable:!0,enumerable:!1,value:wc(i),writable:!0})}:pr;function x0(r){return wo(Si(r))}function Nr(r,i,a){var u=-1,g=r.length;i<0&&(i=-i>g?0:g+i),a=a>g?g:a,a<0&&(a+=g),g=i>a?0:a-i>>>0,i>>>=0;for(var v=z(g);++u<g;)v[u]=r[u+i];return v}function P0(r,i){var a;return In(r,function(u,g,v){return a=i(u,g,v),!a}),!!a}function lo(r,i,a){var u=0,g=r==null?u:r.length;if(typeof i=="number"&&i===i&&g<=ne){for(;u<g;){var v=u+g>>>1,I=r[v];I!==null&&!br(I)&&(a?I<=i:I<i)?u=v+1:g=v}return g}return Ya(r,i,pr,a)}function Ya(r,i,a,u){var g=0,v=r==null?0:r.length;if(v===0)return 0;i=a(i);for(var I=i!==i,A=i===null,L=br(i),J=i===t;g<v;){var X=no((g+v)/2),Z=a(r[X]),ae=Z!==t,ye=Z===null,we=Z===Z,qe=br(Z);if(I)var Ee=u||we;else J?Ee=we&&(u||ae):A?Ee=we&&ae&&(u||!ye):L?Ee=we&&ae&&!ye&&(u||!qe):ye||qe?Ee=!1:Ee=u?Z<=i:Z<i;Ee?g=X+1:v=X}return Jt(v,xe)}function Ch(r,i){for(var a=-1,u=r.length,g=0,v=[];++a<u;){var I=r[a],A=i?i(I):I;if(!a||!zr(A,L)){var L=A;v[g++]=I===0?0:I}}return v}function $h(r){return typeof r=="number"?r:br(r)?Y:+r}function mr(r){if(typeof r=="string")return r;if(Ce(r))return vt(r,mr)+"";if(br(r))return lh?lh.call(r):"";var i=r+"";return i=="0"&&1/r==-te?"-0":i}function On(r,i,a){var u=-1,g=Ks,v=r.length,I=!0,A=[],L=A;if(a)I=!1,g=Ia;else if(v>=o){var J=i?null:F0(r);if(J)return Vs(J);I=!1,g=Fi,L=new Bn}else L=i?[]:A;e:for(;++u<v;){var X=r[u],Z=i?i(X):X;if(X=a||X!==0?X:0,I&&Z===Z){for(var ae=L.length;ae--;)if(L[ae]===Z)continue e;i&&L.push(Z),A.push(X)}else g(L,Z,a)||(L!==A&&L.push(Z),A.push(X))}return A}function Ja(r,i){return i=xn(i,r),r=al(r,i),r==null||delete r[Xr(Cr(i))]}function Dh(r,i,a,u){return Wi(r,i,a(Gn(r,i)),u)}function fo(r,i,a,u){for(var g=r.length,v=u?g:-1;(u?v--:++v<g)&&i(r[v],v,r););return a?Nr(r,u?0:v,u?v+1:g):Nr(r,u?v+1:0,u?g:v)}function Uh(r,i){var a=r;return a instanceof Ye&&(a=a.value()),Oa(i,function(u,g){return g.func.apply(g.thisArg,wn([u],g.args))},a)}function Xa(r,i,a){var u=r.length;if(u<2)return u?On(r[0]):[];for(var g=-1,v=z(u);++g<u;)for(var I=r[g],A=-1;++A<u;)A!=g&&(v[g]=Gi(v[g]||I,r[A],i,a));return On(Wt(v,1),i,a)}function Lh(r,i,a){for(var u=-1,g=r.length,v=i.length,I={};++u<g;){var A=u<v?i[u]:t;a(I,r[u],A)}return I}function Qa(r){return Nt(r)?r:[]}function Za(r){return typeof r=="function"?r:pr}function xn(r,i){return Ce(r)?r:cc(r,i)?[r]:ll(nt(r))}var T0=Ke;function Pn(r,i,a){var u=r.length;return a=a===t?u:a,!i&&a>=u?r:Nr(r,i,a)}var jh=gg||function(r){return Xe.clearTimeout(r)};function Fh(r,i){if(i)return r.slice();var a=r.length,u=sh?sh(a):new r.constructor(a);return r.copy(u),u}function ec(r){var i=new r.constructor(r.byteLength);return new Qs(i).set(new Qs(r)),i}function A0(r,i){var a=i?ec(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function R0(r){var i=new r.constructor(r.source,Or.exec(r));return i.lastIndex=r.lastIndex,i}function N0(r){return Bi?ut(Bi.call(r)):{}}function Mh(r,i){var a=i?ec(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function Hh(r,i){if(r!==i){var a=r!==t,u=r===null,g=r===r,v=br(r),I=i!==t,A=i===null,L=i===i,J=br(i);if(!A&&!J&&!v&&r>i||v&&I&&L&&!A&&!J||u&&I&&L||!a&&L||!g)return 1;if(!u&&!v&&!J&&r<i||J&&a&&g&&!u&&!v||A&&a&&g||!I&&g||!L)return-1}return 0}function C0(r,i,a){for(var u=-1,g=r.criteria,v=i.criteria,I=g.length,A=a.length;++u<I;){var L=Hh(g[u],v[u]);if(L){if(u>=A)return L;var J=a[u];return L*(J=="desc"?-1:1)}}return r.index-i.index}function qh(r,i,a,u){for(var g=-1,v=r.length,I=a.length,A=-1,L=i.length,J=Kt(v-I,0),X=z(L+J),Z=!u;++A<L;)X[A]=i[A];for(;++g<I;)(Z||g<v)&&(X[a[g]]=r[g]);for(;J--;)X[A++]=r[g++];return X}function zh(r,i,a,u){for(var g=-1,v=r.length,I=-1,A=a.length,L=-1,J=i.length,X=Kt(v-A,0),Z=z(X+J),ae=!u;++g<X;)Z[g]=r[g];for(var ye=g;++L<J;)Z[ye+L]=i[L];for(;++I<A;)(ae||g<v)&&(Z[ye+a[I]]=r[g++]);return Z}function lr(r,i){var a=-1,u=r.length;for(i||(i=z(u));++a<u;)i[a]=r[a];return i}function Jr(r,i,a,u){var g=!a;a||(a={});for(var v=-1,I=i.length;++v<I;){var A=i[v],L=u?u(a[A],r[A],A,a,r):t;L===t&&(L=r[A]),g?cn(a,A,L):Ki(a,A,L)}return a}function $0(r,i){return Jr(r,ac(r),i)}function D0(r,i){return Jr(r,tl(r),i)}function po(r,i){return function(a,u){var g=Ce(a)?Mp:r0,v=i?i():{};return g(a,r,me(u,2),v)}}function mi(r){return Ke(function(i,a){var u=-1,g=a.length,v=g>1?a[g-1]:t,I=g>2?a[2]:t;for(v=r.length>3&&typeof v=="function"?(g--,v):t,I&&nr(a[0],a[1],I)&&(v=g<3?t:v,g=1),i=ut(i);++u<g;){var A=a[u];A&&r(i,A,u,v)}return i})}function Bh(r,i){return function(a,u){if(a==null)return a;if(!fr(a))return r(a,u);for(var g=a.length,v=i?g:-1,I=ut(a);(i?v--:++v<g)&&u(I[v],v,I)!==!1;);return a}}function Kh(r){return function(i,a,u){for(var g=-1,v=ut(i),I=u(i),A=I.length;A--;){var L=I[r?A:++g];if(a(v[L],L,v)===!1)break}return i}}function U0(r,i,a){var u=i&K,g=Yi(r);function v(){var I=this&&this!==Xe&&this instanceof v?g:r;return I.apply(u?a:this,arguments)}return v}function Gh(r){return function(i){i=nt(i);var a=fi(i)?Hr(i):t,u=a?a[0]:i.charAt(0),g=a?Pn(a,1).join(""):i.slice(1);return u[r]()+g}}function bi(r){return function(i){return Oa(Bl(zl(i).replace(Li,"")),r,"")}}function Yi(r){return function(){var i=arguments;switch(i.length){case 0:return new r;case 1:return new r(i[0]);case 2:return new r(i[0],i[1]);case 3:return new r(i[0],i[1],i[2]);case 4:return new r(i[0],i[1],i[2],i[3]);case 5:return new r(i[0],i[1],i[2],i[3],i[4]);case 6:return new r(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=vi(r.prototype),u=r.apply(a,i);return bt(u)?u:a}}function L0(r,i,a){var u=Yi(r);function g(){for(var v=arguments.length,I=z(v),A=v,L=wi(g);A--;)I[A]=arguments[A];var J=v<3&&I[0]!==L&&I[v-1]!==L?[]:En(I,L);if(v-=J.length,v<a)return Jh(r,i,go,g.placeholder,t,I,J,t,t,a-v);var X=this&&this!==Xe&&this instanceof g?u:r;return Gt(X,this,I)}return g}function Vh(r){return function(i,a,u){var g=ut(i);if(!fr(i)){var v=me(a,3);i=Vt(i),a=function(A){return v(g[A],A,g)}}var I=r(i,a,u);return I>-1?g[v?i[I]:I]:t}}function kh(r){return hn(function(i){var a=i.length,u=a,g=Ar.prototype.thru;for(r&&i.reverse();u--;){var v=i[u];if(typeof v!="function")throw new Tr(l);if(g&&!I&&mo(v)=="wrapper")var I=new Ar([],!0)}for(u=I?u:a;++u<a;){v=i[u];var A=mo(v),L=A=="wrapper"?sc(v):t;L&&uc(L[0])&&L[1]==(h|j|R|m)&&!L[4].length&&L[9]==1?I=I[mo(L[0])].apply(I,L[3]):I=v.length==1&&uc(v)?I[A]():I.thru(v)}return function(){var J=arguments,X=J[0];if(I&&J.length==1&&Ce(X))return I.plant(X).value();for(var Z=0,ae=a?i[Z].apply(this,J):X;++Z<a;)ae=i[Z].call(this,ae);return ae}})}function go(r,i,a,u,g,v,I,A,L,J){var X=i&h,Z=i&K,ae=i&oe,ye=i&(j|O),we=i&k,qe=ae?t:Yi(r);function Ee(){for(var ke=arguments.length,Qe=z(ke),wr=ke;wr--;)Qe[wr]=arguments[wr];if(ye)var ir=wi(Ee),Er=Wp(Qe,ir);if(u&&(Qe=qh(Qe,u,g,ye)),v&&(Qe=zh(Qe,v,I,ye)),ke-=Er,ye&&ke<J){var Ct=En(Qe,ir);return Jh(r,i,go,Ee.placeholder,a,Qe,Ct,A,L,J-ke)}var Br=Z?a:this,pn=ae?Br[r]:r;return ke=Qe.length,A?Qe=r_(Qe,A):we&&ke>1&&Qe.reverse(),X&&L<ke&&(Qe.length=L),this&&this!==Xe&&this instanceof Ee&&(pn=qe||Yi(pn)),pn.apply(Br,Qe)}return Ee}function Wh(r,i){return function(a,u){return h0(a,r,i(u),{})}}function _o(r,i){return function(a,u){var g;if(a===t&&u===t)return i;if(a!==t&&(g=a),u!==t){if(g===t)return u;typeof a=="string"||typeof u=="string"?(a=mr(a),u=mr(u)):(a=$h(a),u=$h(u)),g=r(a,u)}return g}}function tc(r){return hn(function(i){return i=vt(i,vr(me())),Ke(function(a){var u=this;return r(i,function(g){return Gt(g,u,a)})})})}function yo(r,i){i=i===t?" ":mr(i);var a=i.length;if(a<2)return a?Wa(i,r):i;var u=Wa(i,ro(r/di(i)));return fi(i)?Pn(Hr(u),0,r).join(""):u.slice(0,r)}function j0(r,i,a,u){var g=i&K,v=Yi(r);function I(){for(var A=-1,L=arguments.length,J=-1,X=u.length,Z=z(X+L),ae=this&&this!==Xe&&this instanceof I?v:r;++J<X;)Z[J]=u[J];for(;L--;)Z[J++]=arguments[++A];return Gt(ae,g?a:this,Z)}return I}function Yh(r){return function(i,a,u){return u&&typeof u!="number"&&nr(i,a,u)&&(a=u=t),i=dn(i),a===t?(a=i,i=0):a=dn(a),u=u===t?i<a?1:-1:dn(u),E0(i,a,u,r)}}function vo(r){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=$r(i),a=$r(a)),r(i,a)}}function Jh(r,i,a,u,g,v,I,A,L,J){var X=i&j,Z=X?I:t,ae=X?t:I,ye=X?v:t,we=X?t:v;i|=X?R:b,i&=~(X?b:R),i&C||(i&=~(K|oe));var qe=[r,i,g,ye,Z,we,ae,A,L,J],Ee=a.apply(t,qe);return uc(r)&&cl(Ee,qe),Ee.placeholder=u,ul(Ee,r,i)}function rc(r){var i=Bt[r];return function(a,u){if(a=$r(a),u=u==null?0:Jt(Fe(u),292),u&&uh(a)){var g=(nt(a)+"e").split("e"),v=i(g[0]+"e"+(+g[1]+u));return g=(nt(v)+"e").split("e"),+(g[0]+"e"+(+g[1]-u))}return i(a)}}var F0=_i&&1/Vs(new _i([,-0]))[1]==te?function(r){return new _i(r)}:Ic;function Xh(r){return function(i){var a=Xt(i);return a==Ie?Ca(i):a==Oe?tg(i):kp(i,r(i))}}function un(r,i,a,u,g,v,I,A){var L=i&oe;if(!L&&typeof r!="function")throw new Tr(l);var J=u?u.length:0;if(J||(i&=~(R|b),u=g=t),I=I===t?I:Kt(Fe(I),0),A=A===t?A:Fe(A),J-=g?g.length:0,i&b){var X=u,Z=g;u=g=t}var ae=L?t:sc(r),ye=[r,i,a,u,g,X,Z,v,I,A];if(ae&&Z0(ye,ae),r=ye[0],i=ye[1],a=ye[2],u=ye[3],g=ye[4],A=ye[9]=ye[9]===t?L?0:r.length:Kt(ye[9]-J,0),!A&&i&(j|O)&&(i&=~(j|O)),!i||i==K)var we=U0(r,i,a);else i==j||i==O?we=L0(r,i,A):(i==R||i==(K|R))&&!g.length?we=j0(r,i,a,u):we=go.apply(t,ye);var qe=ae?Nh:cl;return ul(qe(we,ye),r,i)}function Qh(r,i,a,u){return r===t||zr(r,gi[a])&&!it.call(u,a)?i:r}function Zh(r,i,a,u,g,v){return bt(r)&&bt(i)&&(v.set(i,r),ho(r,i,t,Zh,v),v.delete(i)),r}function M0(r){return Qi(r)?t:r}function el(r,i,a,u,g,v){var I=a&M,A=r.length,L=i.length;if(A!=L&&!(I&&L>A))return!1;var J=v.get(r),X=v.get(i);if(J&&X)return J==i&&X==r;var Z=-1,ae=!0,ye=a&B?new Bn:t;for(v.set(r,i),v.set(i,r);++Z<A;){var we=r[Z],qe=i[Z];if(u)var Ee=I?u(qe,we,Z,i,r,v):u(we,qe,Z,r,i,v);if(Ee!==t){if(Ee)continue;ae=!1;break}if(ye){if(!xa(i,function(ke,Qe){if(!Fi(ye,Qe)&&(we===ke||g(we,ke,a,u,v)))return ye.push(Qe)})){ae=!1;break}}else if(!(we===qe||g(we,qe,a,u,v))){ae=!1;break}}return v.delete(r),v.delete(i),ae}function H0(r,i,a,u,g,v,I){switch(a){case Ae:if(r.byteLength!=i.byteLength||r.byteOffset!=i.byteOffset)return!1;r=r.buffer,i=i.buffer;case Se:return!(r.byteLength!=i.byteLength||!v(new Qs(r),new Qs(i)));case F:case N:case ze:return zr(+r,+i);case x:return r.name==i.name&&r.message==i.message;case Me:case $e:return r==i+"";case Ie:var A=Ca;case Oe:var L=u&M;if(A||(A=Vs),r.size!=i.size&&!L)return!1;var J=I.get(r);if(J)return J==i;u|=B,I.set(r,i);var X=el(A(r),A(i),u,g,v,I);return I.delete(r),X;case De:if(Bi)return Bi.call(r)==Bi.call(i)}return!1}function q0(r,i,a,u,g,v){var I=a&M,A=nc(r),L=A.length,J=nc(i),X=J.length;if(L!=X&&!I)return!1;for(var Z=L;Z--;){var ae=A[Z];if(!(I?ae in i:it.call(i,ae)))return!1}var ye=v.get(r),we=v.get(i);if(ye&&we)return ye==i&&we==r;var qe=!0;v.set(r,i),v.set(i,r);for(var Ee=I;++Z<L;){ae=A[Z];var ke=r[ae],Qe=i[ae];if(u)var wr=I?u(Qe,ke,ae,i,r,v):u(ke,Qe,ae,r,i,v);if(!(wr===t?ke===Qe||g(ke,Qe,a,u,v):wr)){qe=!1;break}Ee||(Ee=ae=="constructor")}if(qe&&!Ee){var ir=r.constructor,Er=i.constructor;ir!=Er&&"constructor"in r&&"constructor"in i&&!(typeof ir=="function"&&ir instanceof ir&&typeof Er=="function"&&Er instanceof Er)&&(qe=!1)}return v.delete(r),v.delete(i),qe}function hn(r){return lc(ol(r,t,gl),r+"")}function nc(r){return bh(r,Vt,ac)}function ic(r){return bh(r,dr,tl)}var sc=io?function(r){return io.get(r)}:Ic;function mo(r){for(var i=r.name+"",a=yi[i],u=it.call(yi,i)?a.length:0;u--;){var g=a[u],v=g.func;if(v==null||v==r)return g.name}return i}function wi(r){var i=it.call(y,"placeholder")?y:r;return i.placeholder}function me(){var r=y.iteratee||Ec;return r=r===Ec?Sh:r,arguments.length?r(arguments[0],arguments[1]):r}function bo(r,i){var a=r.__data__;return Y0(i)?a[typeof i=="string"?"string":"hash"]:a.map}function oc(r){for(var i=Vt(r),a=i.length;a--;){var u=i[a],g=r[u];i[a]=[u,g,il(g)]}return i}function Vn(r,i){var a=Qp(r,i);return Eh(a)?a:t}function z0(r){var i=it.call(r,qn),a=r[qn];try{r[qn]=t;var u=!0}catch{}var g=Js.call(r);return u&&(i?r[qn]=a:delete r[qn]),g}var ac=Da?function(r){return r==null?[]:(r=ut(r),bn(Da(r),function(i){return ah.call(r,i)}))}:Oc,tl=Da?function(r){for(var i=[];r;)wn(i,ac(r)),r=Zs(r);return i}:Oc,Xt=rr;(Ua&&Xt(new Ua(new ArrayBuffer(1)))!=Ae||Hi&&Xt(new Hi)!=Ie||La&&Xt(La.resolve())!=pt||_i&&Xt(new _i)!=Oe||qi&&Xt(new qi)!=Te)&&(Xt=function(r){var i=rr(r),a=i==je?r.constructor:t,u=a?kn(a):"";if(u)switch(u){case Ig:return Ae;case Og:return Ie;case xg:return pt;case Pg:return Oe;case Tg:return Te}return i});function B0(r,i,a){for(var u=-1,g=a.length;++u<g;){var v=a[u],I=v.size;switch(v.type){case"drop":r+=I;break;case"dropRight":i-=I;break;case"take":i=Jt(i,r+I);break;case"takeRight":r=Kt(r,i-I);break}}return{start:r,end:i}}function K0(r){var i=r.match(ht);return i?i[1].split(Ft):[]}function rl(r,i,a){i=xn(i,r);for(var u=-1,g=i.length,v=!1;++u<g;){var I=Xr(i[u]);if(!(v=r!=null&&a(r,I)))break;r=r[I]}return v||++u!=g?v:(g=r==null?0:r.length,!!g&&Po(g)&&ln(I,g)&&(Ce(r)||Wn(r)))}function G0(r){var i=r.length,a=new r.constructor(i);return i&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function nl(r){return typeof r.constructor=="function"&&!Ji(r)?vi(Zs(r)):{}}function V0(r,i,a){var u=r.constructor;switch(i){case Se:return ec(r);case F:case N:return new u(+r);case Ae:return A0(r,a);case Be:case Pe:case Ve:case We:case et:case tt:case Je:case Zt:case ur:return Mh(r,a);case Ie:return new u;case ze:case $e:return new u(r);case Me:return R0(r);case Oe:return new u;case De:return N0(r)}}function k0(r,i){var a=i.length;if(!a)return r;var u=a-1;return i[u]=(a>1?"& ":"")+i[u],i=i.join(a>2?", ":" "),r.replace(xt,`{
/* [wrapped with `+i+`] */
`)}function W0(r){return Ce(r)||Wn(r)||!!(ch&&r&&r[ch])}function ln(r,i){var a=typeof r;return i=i??W,!!i&&(a=="number"||a!="symbol"&&ha.test(r))&&r>-1&&r%1==0&&r<i}function nr(r,i,a){if(!bt(a))return!1;var u=typeof i;return(u=="number"?fr(a)&&ln(i,a.length):u=="string"&&i in a)?zr(a[i],r):!1}function cc(r,i){if(Ce(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||br(r)?!0:Ut.test(r)||!yt.test(r)||i!=null&&r in ut(i)}function Y0(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}function uc(r){var i=mo(r),a=y[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(r===a)return!0;var u=sc(a);return!!u&&r===u[0]}function J0(r){return!!ih&&ih in r}var X0=Ws?fn:xc;function Ji(r){var i=r&&r.constructor,a=typeof i=="function"&&i.prototype||gi;return r===a}function il(r){return r===r&&!bt(r)}function sl(r,i){return function(a){return a==null?!1:a[r]===i&&(i!==t||r in ut(a))}}function Q0(r){var i=Oo(r,function(u){return a.size===p&&a.clear(),u}),a=i.cache;return i}function Z0(r,i){var a=r[1],u=i[1],g=a|u,v=g<(K|oe|h),I=u==h&&a==j||u==h&&a==m&&r[7].length<=i[8]||u==(h|m)&&i[7].length<=i[8]&&a==j;if(!(v||I))return r;u&K&&(r[2]=i[2],g|=a&K?0:C);var A=i[3];if(A){var L=r[3];r[3]=L?qh(L,A,i[4]):A,r[4]=L?En(r[3],w):i[4]}return A=i[5],A&&(L=r[5],r[5]=L?zh(L,A,i[6]):A,r[6]=L?En(r[5],w):i[6]),A=i[7],A&&(r[7]=A),u&h&&(r[8]=r[8]==null?i[8]:Jt(r[8],i[8])),r[9]==null&&(r[9]=i[9]),r[0]=i[0],r[1]=g,r}function e_(r){var i=[];if(r!=null)for(var a in ut(r))i.push(a);return i}function t_(r){return Js.call(r)}function ol(r,i,a){return i=Kt(i===t?r.length-1:i,0),function(){for(var u=arguments,g=-1,v=Kt(u.length-i,0),I=z(v);++g<v;)I[g]=u[i+g];g=-1;for(var A=z(i+1);++g<i;)A[g]=u[g];return A[i]=a(I),Gt(r,this,A)}}function al(r,i){return i.length<2?r:Gn(r,Nr(i,0,-1))}function r_(r,i){for(var a=r.length,u=Jt(i.length,a),g=lr(r);u--;){var v=i[u];r[u]=ln(v,a)?g[v]:t}return r}function hc(r,i){if(!(i==="constructor"&&typeof r[i]=="function")&&i!="__proto__")return r[i]}var cl=hl(Nh),Xi=yg||function(r,i){return Xe.setTimeout(r,i)},lc=hl(O0);function ul(r,i,a){var u=i+"";return lc(r,k0(u,n_(K0(u),a)))}function hl(r){var i=0,a=0;return function(){var u=wg(),g=ge-(u-a);if(a=u,g>0){if(++i>=ce)return arguments[0]}else i=0;return r.apply(t,arguments)}}function wo(r,i){var a=-1,u=r.length,g=u-1;for(i=i===t?u:i;++a<i;){var v=ka(a,g),I=r[v];r[v]=r[a],r[a]=I}return r.length=i,r}var ll=Q0(function(r){var i=[];return r.charCodeAt(0)===46&&i.push(""),r.replace(Lt,function(a,u,g,v){i.push(g?v.replace(ia,"$1"):u||a)}),i});function Xr(r){if(typeof r=="string"||br(r))return r;var i=r+"";return i=="0"&&1/r==-te?"-0":i}function kn(r){if(r!=null){try{return Ys.call(r)}catch{}try{return r+""}catch{}}return""}function n_(r,i){return Pr(be,function(a){var u="_."+a[0];i&a[1]&&!Ks(r,u)&&r.push(u)}),r.sort()}function fl(r){if(r instanceof Ye)return r.clone();var i=new Ar(r.__wrapped__,r.__chain__);return i.__actions__=lr(r.__actions__),i.__index__=r.__index__,i.__values__=r.__values__,i}function i_(r,i,a){(a?nr(r,i,a):i===t)?i=1:i=Kt(Fe(i),0);var u=r==null?0:r.length;if(!u||i<1)return[];for(var g=0,v=0,I=z(ro(u/i));g<u;)I[v++]=Nr(r,g,g+=i);return I}function s_(r){for(var i=-1,a=r==null?0:r.length,u=0,g=[];++i<a;){var v=r[i];v&&(g[u++]=v)}return g}function o_(){var r=arguments.length;if(!r)return[];for(var i=z(r-1),a=arguments[0],u=r;u--;)i[u-1]=arguments[u];return wn(Ce(a)?lr(a):[a],Wt(i,1))}var a_=Ke(function(r,i){return Nt(r)?Gi(r,Wt(i,1,Nt,!0)):[]}),c_=Ke(function(r,i){var a=Cr(i);return Nt(a)&&(a=t),Nt(r)?Gi(r,Wt(i,1,Nt,!0),me(a,2)):[]}),u_=Ke(function(r,i){var a=Cr(i);return Nt(a)&&(a=t),Nt(r)?Gi(r,Wt(i,1,Nt,!0),t,a):[]});function h_(r,i,a){var u=r==null?0:r.length;return u?(i=a||i===t?1:Fe(i),Nr(r,i<0?0:i,u)):[]}function l_(r,i,a){var u=r==null?0:r.length;return u?(i=a||i===t?1:Fe(i),i=u-i,Nr(r,0,i<0?0:i)):[]}function f_(r,i){return r&&r.length?fo(r,me(i,3),!0,!0):[]}function d_(r,i){return r&&r.length?fo(r,me(i,3),!0):[]}function p_(r,i,a,u){var g=r==null?0:r.length;return g?(a&&typeof a!="number"&&nr(r,i,a)&&(a=0,u=g),o0(r,i,a,u)):[]}function dl(r,i,a){var u=r==null?0:r.length;if(!u)return-1;var g=a==null?0:Fe(a);return g<0&&(g=Kt(u+g,0)),Gs(r,me(i,3),g)}function pl(r,i,a){var u=r==null?0:r.length;if(!u)return-1;var g=u-1;return a!==t&&(g=Fe(a),g=a<0?Kt(u+g,0):Jt(g,u-1)),Gs(r,me(i,3),g,!0)}function gl(r){var i=r==null?0:r.length;return i?Wt(r,1):[]}function g_(r){var i=r==null?0:r.length;return i?Wt(r,te):[]}function __(r,i){var a=r==null?0:r.length;return a?(i=i===t?1:Fe(i),Wt(r,i)):[]}function y_(r){for(var i=-1,a=r==null?0:r.length,u={};++i<a;){var g=r[i];u[g[0]]=g[1]}return u}function _l(r){return r&&r.length?r[0]:t}function v_(r,i,a){var u=r==null?0:r.length;if(!u)return-1;var g=a==null?0:Fe(a);return g<0&&(g=Kt(u+g,0)),li(r,i,g)}function m_(r){var i=r==null?0:r.length;return i?Nr(r,0,-1):[]}var b_=Ke(function(r){var i=vt(r,Qa);return i.length&&i[0]===r[0]?za(i):[]}),w_=Ke(function(r){var i=Cr(r),a=vt(r,Qa);return i===Cr(a)?i=t:a.pop(),a.length&&a[0]===r[0]?za(a,me(i,2)):[]}),E_=Ke(function(r){var i=Cr(r),a=vt(r,Qa);return i=typeof i=="function"?i:t,i&&a.pop(),a.length&&a[0]===r[0]?za(a,t,i):[]});function S_(r,i){return r==null?"":mg.call(r,i)}function Cr(r){var i=r==null?0:r.length;return i?r[i-1]:t}function I_(r,i,a){var u=r==null?0:r.length;if(!u)return-1;var g=u;return a!==t&&(g=Fe(a),g=g<0?Kt(u+g,0):Jt(g,u-1)),i===i?ng(r,i,g):Gs(r,Ju,g,!0)}function O_(r,i){return r&&r.length?Ph(r,Fe(i)):t}var x_=Ke(yl);function yl(r,i){return r&&r.length&&i&&i.length?Va(r,i):r}function P_(r,i,a){return r&&r.length&&i&&i.length?Va(r,i,me(a,2)):r}function T_(r,i,a){return r&&r.length&&i&&i.length?Va(r,i,t,a):r}var A_=hn(function(r,i){var a=r==null?0:r.length,u=Fa(r,i);return Rh(r,vt(i,function(g){return ln(g,a)?+g:g}).sort(Hh)),u});function R_(r,i){var a=[];if(!(r&&r.length))return a;var u=-1,g=[],v=r.length;for(i=me(i,3);++u<v;){var I=r[u];i(I,u,r)&&(a.push(I),g.push(u))}return Rh(r,g),a}function fc(r){return r==null?r:Sg.call(r)}function N_(r,i,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&nr(r,i,a)?(i=0,a=u):(i=i==null?0:Fe(i),a=a===t?u:Fe(a)),Nr(r,i,a)):[]}function C_(r,i){return lo(r,i)}function $_(r,i,a){return Ya(r,i,me(a,2))}function D_(r,i){var a=r==null?0:r.length;if(a){var u=lo(r,i);if(u<a&&zr(r[u],i))return u}return-1}function U_(r,i){return lo(r,i,!0)}function L_(r,i,a){return Ya(r,i,me(a,2),!0)}function j_(r,i){var a=r==null?0:r.length;if(a){var u=lo(r,i,!0)-1;if(zr(r[u],i))return u}return-1}function F_(r){return r&&r.length?Ch(r):[]}function M_(r,i){return r&&r.length?Ch(r,me(i,2)):[]}function H_(r){var i=r==null?0:r.length;return i?Nr(r,1,i):[]}function q_(r,i,a){return r&&r.length?(i=a||i===t?1:Fe(i),Nr(r,0,i<0?0:i)):[]}function z_(r,i,a){var u=r==null?0:r.length;return u?(i=a||i===t?1:Fe(i),i=u-i,Nr(r,i<0?0:i,u)):[]}function B_(r,i){return r&&r.length?fo(r,me(i,3),!1,!0):[]}function K_(r,i){return r&&r.length?fo(r,me(i,3)):[]}var G_=Ke(function(r){return On(Wt(r,1,Nt,!0))}),V_=Ke(function(r){var i=Cr(r);return Nt(i)&&(i=t),On(Wt(r,1,Nt,!0),me(i,2))}),k_=Ke(function(r){var i=Cr(r);return i=typeof i=="function"?i:t,On(Wt(r,1,Nt,!0),t,i)});function W_(r){return r&&r.length?On(r):[]}function Y_(r,i){return r&&r.length?On(r,me(i,2)):[]}function J_(r,i){return i=typeof i=="function"?i:t,r&&r.length?On(r,t,i):[]}function dc(r){if(!(r&&r.length))return[];var i=0;return r=bn(r,function(a){if(Nt(a))return i=Kt(a.length,i),!0}),Ra(i,function(a){return vt(r,Pa(a))})}function vl(r,i){if(!(r&&r.length))return[];var a=dc(r);return i==null?a:vt(a,function(u){return Gt(i,t,u)})}var X_=Ke(function(r,i){return Nt(r)?Gi(r,i):[]}),Q_=Ke(function(r){return Xa(bn(r,Nt))}),Z_=Ke(function(r){var i=Cr(r);return Nt(i)&&(i=t),Xa(bn(r,Nt),me(i,2))}),ey=Ke(function(r){var i=Cr(r);return i=typeof i=="function"?i:t,Xa(bn(r,Nt),t,i)}),ty=Ke(dc);function ry(r,i){return Lh(r||[],i||[],Ki)}function ny(r,i){return Lh(r||[],i||[],Wi)}var iy=Ke(function(r){var i=r.length,a=i>1?r[i-1]:t;return a=typeof a=="function"?(r.pop(),a):t,vl(r,a)});function ml(r){var i=y(r);return i.__chain__=!0,i}function sy(r,i){return i(r),r}function Eo(r,i){return i(r)}var oy=hn(function(r){var i=r.length,a=i?r[0]:0,u=this.__wrapped__,g=function(v){return Fa(v,r)};return i>1||this.__actions__.length||!(u instanceof Ye)||!ln(a)?this.thru(g):(u=u.slice(a,+a+(i?1:0)),u.__actions__.push({func:Eo,args:[g],thisArg:t}),new Ar(u,this.__chain__).thru(function(v){return i&&!v.length&&v.push(t),v}))});function ay(){return ml(this)}function cy(){return new Ar(this.value(),this.__chain__)}function uy(){this.__values__===t&&(this.__values__=$l(this.value()));var r=this.__index__>=this.__values__.length,i=r?t:this.__values__[this.__index__++];return{done:r,value:i}}function hy(){return this}function ly(r){for(var i,a=this;a instanceof oo;){var u=fl(a);u.__index__=0,u.__values__=t,i?g.__wrapped__=u:i=u;var g=u;a=a.__wrapped__}return g.__wrapped__=r,i}function fy(){var r=this.__wrapped__;if(r instanceof Ye){var i=r;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:Eo,args:[fc],thisArg:t}),new Ar(i,this.__chain__)}return this.thru(fc)}function dy(){return Uh(this.__wrapped__,this.__actions__)}var py=po(function(r,i,a){it.call(r,a)?++r[a]:cn(r,a,1)});function gy(r,i,a){var u=Ce(r)?Wu:s0;return a&&nr(r,i,a)&&(i=t),u(r,me(i,3))}function _y(r,i){var a=Ce(r)?bn:vh;return a(r,me(i,3))}var yy=Vh(dl),vy=Vh(pl);function my(r,i){return Wt(So(r,i),1)}function by(r,i){return Wt(So(r,i),te)}function wy(r,i,a){return a=a===t?1:Fe(a),Wt(So(r,i),a)}function bl(r,i){var a=Ce(r)?Pr:In;return a(r,me(i,3))}function wl(r,i){var a=Ce(r)?Hp:yh;return a(r,me(i,3))}var Ey=po(function(r,i,a){it.call(r,a)?r[a].push(i):cn(r,a,[i])});function Sy(r,i,a,u){r=fr(r)?r:Si(r),a=a&&!u?Fe(a):0;var g=r.length;return a<0&&(a=Kt(g+a,0)),To(r)?a<=g&&r.indexOf(i,a)>-1:!!g&&li(r,i,a)>-1}var Iy=Ke(function(r,i,a){var u=-1,g=typeof i=="function",v=fr(r)?z(r.length):[];return In(r,function(I){v[++u]=g?Gt(i,I,a):Vi(I,i,a)}),v}),Oy=po(function(r,i,a){cn(r,a,i)});function So(r,i){var a=Ce(r)?vt:Ih;return a(r,me(i,3))}function xy(r,i,a,u){return r==null?[]:(Ce(i)||(i=i==null?[]:[i]),a=u?t:a,Ce(a)||(a=a==null?[]:[a]),Th(r,i,a))}var Py=po(function(r,i,a){r[a?0:1].push(i)},function(){return[[],[]]});function Ty(r,i,a){var u=Ce(r)?Oa:Qu,g=arguments.length<3;return u(r,me(i,4),a,g,In)}function Ay(r,i,a){var u=Ce(r)?qp:Qu,g=arguments.length<3;return u(r,me(i,4),a,g,yh)}function Ry(r,i){var a=Ce(r)?bn:vh;return a(r,xo(me(i,3)))}function Ny(r){var i=Ce(r)?dh:S0;return i(r)}function Cy(r,i,a){(a?nr(r,i,a):i===t)?i=1:i=Fe(i);var u=Ce(r)?e0:I0;return u(r,i)}function $y(r){var i=Ce(r)?t0:x0;return i(r)}function Dy(r){if(r==null)return 0;if(fr(r))return To(r)?di(r):r.length;var i=Xt(r);return i==Ie||i==Oe?r.size:Ka(r).length}function Uy(r,i,a){var u=Ce(r)?xa:P0;return a&&nr(r,i,a)&&(i=t),u(r,me(i,3))}var Ly=Ke(function(r,i){if(r==null)return[];var a=i.length;return a>1&&nr(r,i[0],i[1])?i=[]:a>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),Th(r,Wt(i,1),[])}),Io=_g||function(){return Xe.Date.now()};function jy(r,i){if(typeof i!="function")throw new Tr(l);return r=Fe(r),function(){if(--r<1)return i.apply(this,arguments)}}function El(r,i,a){return i=a?t:i,i=r&&i==null?r.length:i,un(r,h,t,t,t,t,i)}function Sl(r,i){var a;if(typeof i!="function")throw new Tr(l);return r=Fe(r),function(){return--r>0&&(a=i.apply(this,arguments)),r<=1&&(i=t),a}}var pc=Ke(function(r,i,a){var u=K;if(a.length){var g=En(a,wi(pc));u|=R}return un(r,u,i,a,g)}),Il=Ke(function(r,i,a){var u=K|oe;if(a.length){var g=En(a,wi(Il));u|=R}return un(i,u,r,a,g)});function Ol(r,i,a){i=a?t:i;var u=un(r,j,t,t,t,t,t,i);return u.placeholder=Ol.placeholder,u}function xl(r,i,a){i=a?t:i;var u=un(r,O,t,t,t,t,t,i);return u.placeholder=xl.placeholder,u}function Pl(r,i,a){var u,g,v,I,A,L,J=0,X=!1,Z=!1,ae=!0;if(typeof r!="function")throw new Tr(l);i=$r(i)||0,bt(a)&&(X=!!a.leading,Z="maxWait"in a,v=Z?Kt($r(a.maxWait)||0,i):v,ae="trailing"in a?!!a.trailing:ae);function ye(Ct){var Br=u,pn=g;return u=g=t,J=Ct,I=r.apply(pn,Br),I}function we(Ct){return J=Ct,A=Xi(ke,i),X?ye(Ct):I}function qe(Ct){var Br=Ct-L,pn=Ct-J,Vl=i-Br;return Z?Jt(Vl,v-pn):Vl}function Ee(Ct){var Br=Ct-L,pn=Ct-J;return L===t||Br>=i||Br<0||Z&&pn>=v}function ke(){var Ct=Io();if(Ee(Ct))return Qe(Ct);A=Xi(ke,qe(Ct))}function Qe(Ct){return A=t,ae&&u?ye(Ct):(u=g=t,I)}function wr(){A!==t&&jh(A),J=0,u=L=g=A=t}function ir(){return A===t?I:Qe(Io())}function Er(){var Ct=Io(),Br=Ee(Ct);if(u=arguments,g=this,L=Ct,Br){if(A===t)return we(L);if(Z)return jh(A),A=Xi(ke,i),ye(L)}return A===t&&(A=Xi(ke,i)),I}return Er.cancel=wr,Er.flush=ir,Er}var Fy=Ke(function(r,i){return _h(r,1,i)}),My=Ke(function(r,i,a){return _h(r,$r(i)||0,a)});function Hy(r){return un(r,k)}function Oo(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new Tr(l);var a=function(){var u=arguments,g=i?i.apply(this,u):u[0],v=a.cache;if(v.has(g))return v.get(g);var I=r.apply(this,u);return a.cache=v.set(g,I)||v,I};return a.cache=new(Oo.Cache||an),a}Oo.Cache=an;function xo(r){if(typeof r!="function")throw new Tr(l);return function(){var i=arguments;switch(i.length){case 0:return!r.call(this);case 1:return!r.call(this,i[0]);case 2:return!r.call(this,i[0],i[1]);case 3:return!r.call(this,i[0],i[1],i[2])}return!r.apply(this,i)}}function qy(r){return Sl(2,r)}var zy=T0(function(r,i){i=i.length==1&&Ce(i[0])?vt(i[0],vr(me())):vt(Wt(i,1),vr(me()));var a=i.length;return Ke(function(u){for(var g=-1,v=Jt(u.length,a);++g<v;)u[g]=i[g].call(this,u[g]);return Gt(r,this,u)})}),gc=Ke(function(r,i){var a=En(i,wi(gc));return un(r,R,t,i,a)}),Tl=Ke(function(r,i){var a=En(i,wi(Tl));return un(r,b,t,i,a)}),By=hn(function(r,i){return un(r,m,t,t,t,i)});function Ky(r,i){if(typeof r!="function")throw new Tr(l);return i=i===t?i:Fe(i),Ke(r,i)}function Gy(r,i){if(typeof r!="function")throw new Tr(l);return i=i==null?0:Kt(Fe(i),0),Ke(function(a){var u=a[i],g=Pn(a,0,i);return u&&wn(g,u),Gt(r,this,g)})}function Vy(r,i,a){var u=!0,g=!0;if(typeof r!="function")throw new Tr(l);return bt(a)&&(u="leading"in a?!!a.leading:u,g="trailing"in a?!!a.trailing:g),Pl(r,i,{leading:u,maxWait:i,trailing:g})}function ky(r){return El(r,1)}function Wy(r,i){return gc(Za(i),r)}function Yy(){if(!arguments.length)return[];var r=arguments[0];return Ce(r)?r:[r]}function Jy(r){return Rr(r,P)}function Xy(r,i){return i=typeof i=="function"?i:t,Rr(r,P,i)}function Qy(r){return Rr(r,T|P)}function Zy(r,i){return i=typeof i=="function"?i:t,Rr(r,T|P,i)}function e1(r,i){return i==null||gh(r,i,Vt(i))}function zr(r,i){return r===i||r!==r&&i!==i}var t1=vo(qa),r1=vo(function(r,i){return r>=i}),Wn=wh(function(){return arguments}())?wh:function(r){return Pt(r)&&it.call(r,"callee")&&!ah.call(r,"callee")},Ce=z.isArray,n1=tr?vr(tr):l0;function fr(r){return r!=null&&Po(r.length)&&!fn(r)}function Nt(r){return Pt(r)&&fr(r)}function i1(r){return r===!0||r===!1||Pt(r)&&rr(r)==F}var Tn=vg||xc,s1=Mr?vr(Mr):f0;function o1(r){return Pt(r)&&r.nodeType===1&&!Qi(r)}function a1(r){if(r==null)return!0;if(fr(r)&&(Ce(r)||typeof r=="string"||typeof r.splice=="function"||Tn(r)||Ei(r)||Wn(r)))return!r.length;var i=Xt(r);if(i==Ie||i==Oe)return!r.size;if(Ji(r))return!Ka(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function c1(r,i){return ki(r,i)}function u1(r,i,a){a=typeof a=="function"?a:t;var u=a?a(r,i):t;return u===t?ki(r,i,t,a):!!u}function _c(r){if(!Pt(r))return!1;var i=rr(r);return i==x||i==f||typeof r.message=="string"&&typeof r.name=="string"&&!Qi(r)}function h1(r){return typeof r=="number"&&uh(r)}function fn(r){if(!bt(r))return!1;var i=rr(r);return i==ie||i==fe||i==H||i==gt}function Al(r){return typeof r=="number"&&r==Fe(r)}function Po(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=W}function bt(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}function Pt(r){return r!=null&&typeof r=="object"}var Rl=xr?vr(xr):p0;function l1(r,i){return r===i||Ba(r,i,oc(i))}function f1(r,i,a){return a=typeof a=="function"?a:t,Ba(r,i,oc(i),a)}function d1(r){return Nl(r)&&r!=+r}function p1(r){if(X0(r))throw new Re(c);return Eh(r)}function g1(r){return r===null}function _1(r){return r==null}function Nl(r){return typeof r=="number"||Pt(r)&&rr(r)==ze}function Qi(r){if(!Pt(r)||rr(r)!=je)return!1;var i=Zs(r);if(i===null)return!0;var a=it.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Ys.call(a)==fg}var yc=Wr?vr(Wr):g0;function y1(r){return Al(r)&&r>=-W&&r<=W}var Cl=ji?vr(ji):_0;function To(r){return typeof r=="string"||!Ce(r)&&Pt(r)&&rr(r)==$e}function br(r){return typeof r=="symbol"||Pt(r)&&rr(r)==De}var Ei=Hn?vr(Hn):y0;function v1(r){return r===t}function m1(r){return Pt(r)&&Xt(r)==Te}function b1(r){return Pt(r)&&rr(r)==Ue}var w1=vo(Ga),E1=vo(function(r,i){return r<=i});function $l(r){if(!r)return[];if(fr(r))return To(r)?Hr(r):lr(r);if(Mi&&r[Mi])return eg(r[Mi]());var i=Xt(r),a=i==Ie?Ca:i==Oe?Vs:Si;return a(r)}function dn(r){if(!r)return r===0?r:0;if(r=$r(r),r===te||r===-te){var i=r<0?-1:1;return i*ee}return r===r?r:0}function Fe(r){var i=dn(r),a=i%1;return i===i?a?i-a:i:0}function Dl(r){return r?Kn(Fe(r),0,re):0}function $r(r){if(typeof r=="number")return r;if(br(r))return Y;if(bt(r)){var i=typeof r.valueOf=="function"?r.valueOf():r;r=bt(i)?i+"":i}if(typeof r!="string")return r===0?r:+r;r=Zu(r);var a=aa.test(r);return a||ua.test(r)?Ne(r.slice(2),a?2:8):oa.test(r)?Y:+r}function Ul(r){return Jr(r,dr(r))}function S1(r){return r?Kn(Fe(r),-W,W):r===0?r:0}function nt(r){return r==null?"":mr(r)}var I1=mi(function(r,i){if(Ji(i)||fr(i)){Jr(i,Vt(i),r);return}for(var a in i)it.call(i,a)&&Ki(r,a,i[a])}),Ll=mi(function(r,i){Jr(i,dr(i),r)}),Ao=mi(function(r,i,a,u){Jr(i,dr(i),r,u)}),O1=mi(function(r,i,a,u){Jr(i,Vt(i),r,u)}),x1=hn(Fa);function P1(r,i){var a=vi(r);return i==null?a:ph(a,i)}var T1=Ke(function(r,i){r=ut(r);var a=-1,u=i.length,g=u>2?i[2]:t;for(g&&nr(i[0],i[1],g)&&(u=1);++a<u;)for(var v=i[a],I=dr(v),A=-1,L=I.length;++A<L;){var J=I[A],X=r[J];(X===t||zr(X,gi[J])&&!it.call(r,J))&&(r[J]=v[J])}return r}),A1=Ke(function(r){return r.push(t,Zh),Gt(jl,t,r)});function R1(r,i){return Yu(r,me(i,3),Yr)}function N1(r,i){return Yu(r,me(i,3),Ha)}function C1(r,i){return r==null?r:Ma(r,me(i,3),dr)}function $1(r,i){return r==null?r:mh(r,me(i,3),dr)}function D1(r,i){return r&&Yr(r,me(i,3))}function U1(r,i){return r&&Ha(r,me(i,3))}function L1(r){return r==null?[]:uo(r,Vt(r))}function j1(r){return r==null?[]:uo(r,dr(r))}function vc(r,i,a){var u=r==null?t:Gn(r,i);return u===t?a:u}function F1(r,i){return r!=null&&rl(r,i,a0)}function mc(r,i){return r!=null&&rl(r,i,c0)}var M1=Wh(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=Js.call(i)),r[i]=a},wc(pr)),H1=Wh(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=Js.call(i)),it.call(r,i)?r[i].push(a):r[i]=[a]},me),q1=Ke(Vi);function Vt(r){return fr(r)?fh(r):Ka(r)}function dr(r){return fr(r)?fh(r,!0):v0(r)}function z1(r,i){var a={};return i=me(i,3),Yr(r,function(u,g,v){cn(a,i(u,g,v),u)}),a}function B1(r,i){var a={};return i=me(i,3),Yr(r,function(u,g,v){cn(a,g,i(u,g,v))}),a}var K1=mi(function(r,i,a){ho(r,i,a)}),jl=mi(function(r,i,a,u){ho(r,i,a,u)}),G1=hn(function(r,i){var a={};if(r==null)return a;var u=!1;i=vt(i,function(v){return v=xn(v,r),u||(u=v.length>1),v}),Jr(r,ic(r),a),u&&(a=Rr(a,T|S|P,M0));for(var g=i.length;g--;)Ja(a,i[g]);return a});function V1(r,i){return Fl(r,xo(me(i)))}var k1=hn(function(r,i){return r==null?{}:b0(r,i)});function Fl(r,i){if(r==null)return{};var a=vt(ic(r),function(u){return[u]});return i=me(i),Ah(r,a,function(u,g){return i(u,g[0])})}function W1(r,i,a){i=xn(i,r);var u=-1,g=i.length;for(g||(g=1,r=t);++u<g;){var v=r==null?t:r[Xr(i[u])];v===t&&(u=g,v=a),r=fn(v)?v.call(r):v}return r}function Y1(r,i,a){return r==null?r:Wi(r,i,a)}function J1(r,i,a,u){return u=typeof u=="function"?u:t,r==null?r:Wi(r,i,a,u)}var Ml=Xh(Vt),Hl=Xh(dr);function X1(r,i,a){var u=Ce(r),g=u||Tn(r)||Ei(r);if(i=me(i,4),a==null){var v=r&&r.constructor;g?a=u?new v:[]:bt(r)?a=fn(v)?vi(Zs(r)):{}:a={}}return(g?Pr:Yr)(r,function(I,A,L){return i(a,I,A,L)}),a}function Q1(r,i){return r==null?!0:Ja(r,i)}function Z1(r,i,a){return r==null?r:Dh(r,i,Za(a))}function ev(r,i,a,u){return u=typeof u=="function"?u:t,r==null?r:Dh(r,i,Za(a),u)}function Si(r){return r==null?[]:Na(r,Vt(r))}function tv(r){return r==null?[]:Na(r,dr(r))}function rv(r,i,a){return a===t&&(a=i,i=t),a!==t&&(a=$r(a),a=a===a?a:0),i!==t&&(i=$r(i),i=i===i?i:0),Kn($r(r),i,a)}function nv(r,i,a){return i=dn(i),a===t?(a=i,i=0):a=dn(a),r=$r(r),u0(r,i,a)}function iv(r,i,a){if(a&&typeof a!="boolean"&&nr(r,i,a)&&(i=a=t),a===t&&(typeof i=="boolean"?(a=i,i=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&i===t?(r=0,i=1):(r=dn(r),i===t?(i=r,r=0):i=dn(i)),r>i){var u=r;r=i,i=u}if(a||r%1||i%1){var g=hh();return Jt(r+g*(i-r+at("1e-"+((g+"").length-1))),i)}return ka(r,i)}var sv=bi(function(r,i,a){return i=i.toLowerCase(),r+(a?ql(i):i)});function ql(r){return bc(nt(r).toLowerCase())}function zl(r){return r=nt(r),r&&r.replace(nn,Yp).replace(Ea,"")}function ov(r,i,a){r=nt(r),i=mr(i);var u=r.length;a=a===t?u:Kn(Fe(a),0,u);var g=a;return a-=i.length,a>=0&&r.slice(a,g)==i}function av(r){return r=nt(r),r&&_t.test(r)?r.replace(Un,Jp):r}function cv(r){return r=nt(r),r&&jt.test(r)?r.replace(It,"\\$&"):r}var uv=bi(function(r,i,a){return r+(a?"-":"")+i.toLowerCase()}),hv=bi(function(r,i,a){return r+(a?" ":"")+i.toLowerCase()}),lv=Gh("toLowerCase");function fv(r,i,a){r=nt(r),i=Fe(i);var u=i?di(r):0;if(!i||u>=i)return r;var g=(i-u)/2;return yo(no(g),a)+r+yo(ro(g),a)}function dv(r,i,a){r=nt(r),i=Fe(i);var u=i?di(r):0;return i&&u<i?r+yo(i-u,a):r}function pv(r,i,a){r=nt(r),i=Fe(i);var u=i?di(r):0;return i&&u<i?yo(i-u,a)+r:r}function gv(r,i,a){return a||i==null?i=0:i&&(i=+i),Eg(nt(r).replace(Ot,""),i||0)}function _v(r,i,a){return(a?nr(r,i,a):i===t)?i=1:i=Fe(i),Wa(nt(r),i)}function yv(){var r=arguments,i=nt(r[0]);return r.length<3?i:i.replace(r[1],r[2])}var vv=bi(function(r,i,a){return r+(a?"_":"")+i.toLowerCase()});function mv(r,i,a){return a&&typeof a!="number"&&nr(r,i,a)&&(i=a=t),a=a===t?re:a>>>0,a?(r=nt(r),r&&(typeof i=="string"||i!=null&&!yc(i))&&(i=mr(i),!i&&fi(r))?Pn(Hr(r),0,a):r.split(i,a)):[]}var bv=bi(function(r,i,a){return r+(a?" ":"")+bc(i)});function wv(r,i,a){return r=nt(r),a=a==null?0:Kn(Fe(a),0,r.length),i=mr(i),r.slice(a,a+i.length)==i}function Ev(r,i,a){var u=y.templateSettings;a&&nr(r,i,a)&&(i=t),r=nt(r),i=Ao({},i,u,Qh);var g=Ao({},i.imports,u.imports,Qh),v=Vt(g),I=Na(g,v),A,L,J=0,X=i.interpolate||ii,Z="__p += '",ae=$a((i.escape||ii).source+"|"+X.source+"|"+(X===mt?sa:ii).source+"|"+(i.evaluate||ii).source+"|$","g"),ye="//# sourceURL="+(it.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Sa+"]")+`
`;r.replace(ae,function(Ee,ke,Qe,wr,ir,Er){return Qe||(Qe=wr),Z+=r.slice(J,Er).replace(la,Xp),ke&&(A=!0,Z+=`' +
__e(`+ke+`) +
'`),ir&&(L=!0,Z+=`';
`+ir+`;
__p += '`),Qe&&(Z+=`' +
((__t = (`+Qe+`)) == null ? '' : __t) +
'`),J=Er+Ee.length,Ee}),Z+=`';
`;var we=it.call(i,"variable")&&i.variable;if(!we)Z=`with (obj) {
`+Z+`
}
`;else if(na.test(we))throw new Re(d);Z=(L?Z.replace(Vr,""):Z).replace(er,"$1").replace(rn,"$1;"),Z="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(A?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var qe=Kl(function(){return rt(v,ye+"return "+Z).apply(t,I)});if(qe.source=Z,_c(qe))throw qe;return qe}function Sv(r){return nt(r).toLowerCase()}function Iv(r){return nt(r).toUpperCase()}function Ov(r,i,a){if(r=nt(r),r&&(a||i===t))return Zu(r);if(!r||!(i=mr(i)))return r;var u=Hr(r),g=Hr(i),v=eh(u,g),I=th(u,g)+1;return Pn(u,v,I).join("")}function xv(r,i,a){if(r=nt(r),r&&(a||i===t))return r.slice(0,nh(r)+1);if(!r||!(i=mr(i)))return r;var u=Hr(r),g=th(u,Hr(i))+1;return Pn(u,0,g).join("")}function Pv(r,i,a){if(r=nt(r),r&&(a||i===t))return r.replace(Ot,"");if(!r||!(i=mr(i)))return r;var u=Hr(r),g=eh(u,Hr(i));return Pn(u,g).join("")}function Tv(r,i){var a=V,u=se;if(bt(i)){var g="separator"in i?i.separator:g;a="length"in i?Fe(i.length):a,u="omission"in i?mr(i.omission):u}r=nt(r);var v=r.length;if(fi(r)){var I=Hr(r);v=I.length}if(a>=v)return r;var A=a-di(u);if(A<1)return u;var L=I?Pn(I,0,A).join(""):r.slice(0,A);if(g===t)return L+u;if(I&&(A+=L.length-A),yc(g)){if(r.slice(A).search(g)){var J,X=L;for(g.global||(g=$a(g.source,nt(Or.exec(g))+"g")),g.lastIndex=0;J=g.exec(X);)var Z=J.index;L=L.slice(0,Z===t?A:Z)}}else if(r.indexOf(mr(g),A)!=A){var ae=L.lastIndexOf(g);ae>-1&&(L=L.slice(0,ae))}return L+u}function Av(r){return r=nt(r),r&&wt.test(r)?r.replace(vn,ig):r}var Rv=bi(function(r,i,a){return r+(a?" ":"")+i.toUpperCase()}),bc=Gh("toUpperCase");function Bl(r,i,a){return r=nt(r),i=a?t:i,i===t?Zp(r)?ag(r):Kp(r):r.match(i)||[]}var Kl=Ke(function(r,i){try{return Gt(r,t,i)}catch(a){return _c(a)?a:new Re(a)}}),Nv=hn(function(r,i){return Pr(i,function(a){a=Xr(a),cn(r,a,pc(r[a],r))}),r});function Cv(r){var i=r==null?0:r.length,a=me();return r=i?vt(r,function(u){if(typeof u[1]!="function")throw new Tr(l);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var g=-1;++g<i;){var v=r[g];if(Gt(v[0],this,u))return Gt(v[1],this,u)}})}function $v(r){return i0(Rr(r,T))}function wc(r){return function(){return r}}function Dv(r,i){return r==null||r!==r?i:r}var Uv=kh(),Lv=kh(!0);function pr(r){return r}function Ec(r){return Sh(typeof r=="function"?r:Rr(r,T))}function jv(r){return Oh(Rr(r,T))}function Fv(r,i){return xh(r,Rr(i,T))}var Mv=Ke(function(r,i){return function(a){return Vi(a,r,i)}}),Hv=Ke(function(r,i){return function(a){return Vi(r,a,i)}});function Sc(r,i,a){var u=Vt(i),g=uo(i,u);a==null&&!(bt(i)&&(g.length||!u.length))&&(a=i,i=r,r=this,g=uo(i,Vt(i)));var v=!(bt(a)&&"chain"in a)||!!a.chain,I=fn(r);return Pr(g,function(A){var L=i[A];r[A]=L,I&&(r.prototype[A]=function(){var J=this.__chain__;if(v||J){var X=r(this.__wrapped__),Z=X.__actions__=lr(this.__actions__);return Z.push({func:L,args:arguments,thisArg:r}),X.__chain__=J,X}return L.apply(r,wn([this.value()],arguments))})}),r}function qv(){return Xe._===this&&(Xe._=dg),this}function Ic(){}function zv(r){return r=Fe(r),Ke(function(i){return Ph(i,r)})}var Bv=tc(vt),Kv=tc(Wu),Gv=tc(xa);function Gl(r){return cc(r)?Pa(Xr(r)):w0(r)}function Vv(r){return function(i){return r==null?t:Gn(r,i)}}var kv=Yh(),Wv=Yh(!0);function Oc(){return[]}function xc(){return!1}function Yv(){return{}}function Jv(){return""}function Xv(){return!0}function Qv(r,i){if(r=Fe(r),r<1||r>W)return[];var a=re,u=Jt(r,re);i=me(i),r-=re;for(var g=Ra(u,i);++a<r;)i(a);return g}function Zv(r){return Ce(r)?vt(r,Xr):br(r)?[r]:lr(ll(nt(r)))}function em(r){var i=++lg;return nt(r)+i}var tm=_o(function(r,i){return r+i},0),rm=rc("ceil"),nm=_o(function(r,i){return r/i},1),im=rc("floor");function sm(r){return r&&r.length?co(r,pr,qa):t}function om(r,i){return r&&r.length?co(r,me(i,2),qa):t}function am(r){return Xu(r,pr)}function cm(r,i){return Xu(r,me(i,2))}function um(r){return r&&r.length?co(r,pr,Ga):t}function hm(r,i){return r&&r.length?co(r,me(i,2),Ga):t}var lm=_o(function(r,i){return r*i},1),fm=rc("round"),dm=_o(function(r,i){return r-i},0);function pm(r){return r&&r.length?Aa(r,pr):0}function gm(r,i){return r&&r.length?Aa(r,me(i,2)):0}return y.after=jy,y.ary=El,y.assign=I1,y.assignIn=Ll,y.assignInWith=Ao,y.assignWith=O1,y.at=x1,y.before=Sl,y.bind=pc,y.bindAll=Nv,y.bindKey=Il,y.castArray=Yy,y.chain=ml,y.chunk=i_,y.compact=s_,y.concat=o_,y.cond=Cv,y.conforms=$v,y.constant=wc,y.countBy=py,y.create=P1,y.curry=Ol,y.curryRight=xl,y.debounce=Pl,y.defaults=T1,y.defaultsDeep=A1,y.defer=Fy,y.delay=My,y.difference=a_,y.differenceBy=c_,y.differenceWith=u_,y.drop=h_,y.dropRight=l_,y.dropRightWhile=f_,y.dropWhile=d_,y.fill=p_,y.filter=_y,y.flatMap=my,y.flatMapDeep=by,y.flatMapDepth=wy,y.flatten=gl,y.flattenDeep=g_,y.flattenDepth=__,y.flip=Hy,y.flow=Uv,y.flowRight=Lv,y.fromPairs=y_,y.functions=L1,y.functionsIn=j1,y.groupBy=Ey,y.initial=m_,y.intersection=b_,y.intersectionBy=w_,y.intersectionWith=E_,y.invert=M1,y.invertBy=H1,y.invokeMap=Iy,y.iteratee=Ec,y.keyBy=Oy,y.keys=Vt,y.keysIn=dr,y.map=So,y.mapKeys=z1,y.mapValues=B1,y.matches=jv,y.matchesProperty=Fv,y.memoize=Oo,y.merge=K1,y.mergeWith=jl,y.method=Mv,y.methodOf=Hv,y.mixin=Sc,y.negate=xo,y.nthArg=zv,y.omit=G1,y.omitBy=V1,y.once=qy,y.orderBy=xy,y.over=Bv,y.overArgs=zy,y.overEvery=Kv,y.overSome=Gv,y.partial=gc,y.partialRight=Tl,y.partition=Py,y.pick=k1,y.pickBy=Fl,y.property=Gl,y.propertyOf=Vv,y.pull=x_,y.pullAll=yl,y.pullAllBy=P_,y.pullAllWith=T_,y.pullAt=A_,y.range=kv,y.rangeRight=Wv,y.rearg=By,y.reject=Ry,y.remove=R_,y.rest=Ky,y.reverse=fc,y.sampleSize=Cy,y.set=Y1,y.setWith=J1,y.shuffle=$y,y.slice=N_,y.sortBy=Ly,y.sortedUniq=F_,y.sortedUniqBy=M_,y.split=mv,y.spread=Gy,y.tail=H_,y.take=q_,y.takeRight=z_,y.takeRightWhile=B_,y.takeWhile=K_,y.tap=sy,y.throttle=Vy,y.thru=Eo,y.toArray=$l,y.toPairs=Ml,y.toPairsIn=Hl,y.toPath=Zv,y.toPlainObject=Ul,y.transform=X1,y.unary=ky,y.union=G_,y.unionBy=V_,y.unionWith=k_,y.uniq=W_,y.uniqBy=Y_,y.uniqWith=J_,y.unset=Q1,y.unzip=dc,y.unzipWith=vl,y.update=Z1,y.updateWith=ev,y.values=Si,y.valuesIn=tv,y.without=X_,y.words=Bl,y.wrap=Wy,y.xor=Q_,y.xorBy=Z_,y.xorWith=ey,y.zip=ty,y.zipObject=ry,y.zipObjectDeep=ny,y.zipWith=iy,y.entries=Ml,y.entriesIn=Hl,y.extend=Ll,y.extendWith=Ao,Sc(y,y),y.add=tm,y.attempt=Kl,y.camelCase=sv,y.capitalize=ql,y.ceil=rm,y.clamp=rv,y.clone=Jy,y.cloneDeep=Qy,y.cloneDeepWith=Zy,y.cloneWith=Xy,y.conformsTo=e1,y.deburr=zl,y.defaultTo=Dv,y.divide=nm,y.endsWith=ov,y.eq=zr,y.escape=av,y.escapeRegExp=cv,y.every=gy,y.find=yy,y.findIndex=dl,y.findKey=R1,y.findLast=vy,y.findLastIndex=pl,y.findLastKey=N1,y.floor=im,y.forEach=bl,y.forEachRight=wl,y.forIn=C1,y.forInRight=$1,y.forOwn=D1,y.forOwnRight=U1,y.get=vc,y.gt=t1,y.gte=r1,y.has=F1,y.hasIn=mc,y.head=_l,y.identity=pr,y.includes=Sy,y.indexOf=v_,y.inRange=nv,y.invoke=q1,y.isArguments=Wn,y.isArray=Ce,y.isArrayBuffer=n1,y.isArrayLike=fr,y.isArrayLikeObject=Nt,y.isBoolean=i1,y.isBuffer=Tn,y.isDate=s1,y.isElement=o1,y.isEmpty=a1,y.isEqual=c1,y.isEqualWith=u1,y.isError=_c,y.isFinite=h1,y.isFunction=fn,y.isInteger=Al,y.isLength=Po,y.isMap=Rl,y.isMatch=l1,y.isMatchWith=f1,y.isNaN=d1,y.isNative=p1,y.isNil=_1,y.isNull=g1,y.isNumber=Nl,y.isObject=bt,y.isObjectLike=Pt,y.isPlainObject=Qi,y.isRegExp=yc,y.isSafeInteger=y1,y.isSet=Cl,y.isString=To,y.isSymbol=br,y.isTypedArray=Ei,y.isUndefined=v1,y.isWeakMap=m1,y.isWeakSet=b1,y.join=S_,y.kebabCase=uv,y.last=Cr,y.lastIndexOf=I_,y.lowerCase=hv,y.lowerFirst=lv,y.lt=w1,y.lte=E1,y.max=sm,y.maxBy=om,y.mean=am,y.meanBy=cm,y.min=um,y.minBy=hm,y.stubArray=Oc,y.stubFalse=xc,y.stubObject=Yv,y.stubString=Jv,y.stubTrue=Xv,y.multiply=lm,y.nth=O_,y.noConflict=qv,y.noop=Ic,y.now=Io,y.pad=fv,y.padEnd=dv,y.padStart=pv,y.parseInt=gv,y.random=iv,y.reduce=Ty,y.reduceRight=Ay,y.repeat=_v,y.replace=yv,y.result=W1,y.round=fm,y.runInContext=U,y.sample=Ny,y.size=Dy,y.snakeCase=vv,y.some=Uy,y.sortedIndex=C_,y.sortedIndexBy=$_,y.sortedIndexOf=D_,y.sortedLastIndex=U_,y.sortedLastIndexBy=L_,y.sortedLastIndexOf=j_,y.startCase=bv,y.startsWith=wv,y.subtract=dm,y.sum=pm,y.sumBy=gm,y.template=Ev,y.times=Qv,y.toFinite=dn,y.toInteger=Fe,y.toLength=Dl,y.toLower=Sv,y.toNumber=$r,y.toSafeInteger=S1,y.toString=nt,y.toUpper=Iv,y.trim=Ov,y.trimEnd=xv,y.trimStart=Pv,y.truncate=Tv,y.unescape=Av,y.uniqueId=em,y.upperCase=Rv,y.upperFirst=bc,y.each=bl,y.eachRight=wl,y.first=_l,Sc(y,function(){var r={};return Yr(y,function(i,a){it.call(y.prototype,a)||(r[a]=i)}),r}(),{chain:!1}),y.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){y[r].placeholder=y}),Pr(["drop","take"],function(r,i){Ye.prototype[r]=function(a){a=a===t?1:Kt(Fe(a),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Jt(a,u.__takeCount__):u.__views__.push({size:Jt(a,re),type:r+(u.__dir__<0?"Right":"")}),u},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Pr(["filter","map","takeWhile"],function(r,i){var a=i+1,u=a==$||a==le;Ye.prototype[r]=function(g){var v=this.clone();return v.__iteratees__.push({iteratee:me(g,3),type:a}),v.__filtered__=v.__filtered__||u,v}}),Pr(["head","last"],function(r,i){var a="take"+(i?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Pr(["initial","tail"],function(r,i){var a="drop"+(i?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(pr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,i){return typeof r=="function"?new Ye(this):this.map(function(a){return Vi(a,r,i)})}),Ye.prototype.reject=function(r){return this.filter(xo(me(r)))},Ye.prototype.slice=function(r,i){r=Fe(r);var a=this;return a.__filtered__&&(r>0||i<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),i!==t&&(i=Fe(i),a=i<0?a.dropRight(-i):a.take(i-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Yr(Ye.prototype,function(r,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),g=y[u?"take"+(i=="last"?"Right":""):i],v=u||/^find/.test(i);g&&(y.prototype[i]=function(){var I=this.__wrapped__,A=u?[1]:arguments,L=I instanceof Ye,J=A[0],X=L||Ce(I),Z=function(ke){var Qe=g.apply(y,wn([ke],A));return u&&ae?Qe[0]:Qe};X&&a&&typeof J=="function"&&J.length!=1&&(L=X=!1);var ae=this.__chain__,ye=!!this.__actions__.length,we=v&&!ae,qe=L&&!ye;if(!v&&X){I=qe?I:new Ye(this);var Ee=r.apply(I,A);return Ee.__actions__.push({func:Eo,args:[Z],thisArg:t}),new Ar(Ee,ae)}return we&&qe?r.apply(this,A):(Ee=this.thru(Z),we?u?Ee.value()[0]:Ee.value():Ee)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(r){var i=ks[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);y.prototype[r]=function(){var g=arguments;if(u&&!this.__chain__){var v=this.value();return i.apply(Ce(v)?v:[],g)}return this[a](function(I){return i.apply(Ce(I)?I:[],g)})}}),Yr(Ye.prototype,function(r,i){var a=y[i];if(a){var u=a.name+"";it.call(yi,u)||(yi[u]=[]),yi[u].push({name:i,func:a})}}),yi[go(t,oe).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=Ag,Ye.prototype.reverse=Rg,Ye.prototype.value=Ng,y.prototype.at=oy,y.prototype.chain=ay,y.prototype.commit=cy,y.prototype.next=uy,y.prototype.plant=ly,y.prototype.reverse=fy,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=dy,y.prototype.first=y.prototype.head,Mi&&(y.prototype[Mi]=hy),y},pi=cg();Rt?((Rt.exports=pi)._=pi,ct._=pi):Xe._=pi}).call(ls)})(bu,bu.exports);var q3=Object.defineProperty,z3=Object.defineProperties,B3=Object.getOwnPropertyDescriptors,_d=Object.getOwnPropertySymbols,K3=Object.prototype.hasOwnProperty,G3=Object.prototype.propertyIsEnumerable,yd=(n,e,t)=>e in n?q3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,No=(n,e)=>{for(var t in e||(e={}))K3.call(e,t)&&yd(n,t,e[t]);if(_d)for(var t of _d(e))G3.call(e,t)&&yd(n,t,e[t]);return n},V3=(n,e)=>z3(n,B3(e));function Lr(n,e,t){let s;const o=wu(n);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${H3}?chainId=eip155:${o}&projectId=${t}`),s}function wu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function jp(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function k3(n,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function W3(n={},e={}){const t=vd(n),s=vd(e);return bu.exports.merge(t,s)}function vd(n){var e,t,s,o;const c={};if(!Ti(n))return c;for(const[l,d]of Object.entries(n)){const _=ju(l)?[l]:d.chains,p=d.methods||[],w=d.events||[],T=d.rpcMap||{},S=Do(l);c[S]=V3(No(No({},c[S]),d),{chains:Lc(_,(e=c[S])==null?void 0:e.chains),methods:Lc(p,(t=c[S])==null?void 0:t.methods),events:Lc(w,(s=c[S])==null?void 0:s.events),rpcMap:No(No({},T),(o=c[S])==null?void 0:o.rpcMap)})}return c}function Y3(n){return n.includes(":")?n.split(":")[2]:n}function J3(n){const e={};for(const[t,s]of Object.entries(n)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],d=ju(t)?[t]:s.chains?s.chains:jp(s.accounts);e[t]={chains:d,methods:o,events:c,accounts:l}}return e}const Fp={},Dt=n=>Fp[n],Bc=(n,e)=>{Fp[n]=e};class X3{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Lr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Lr(e,this.namespace);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}}class Q3{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=wu(e);if(!this.httpProviders[s]){const o=t||Lr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Lr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=wu(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class Z3{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Lr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Lr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}}class e5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Lr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Lr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}}class t5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}}class r5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Lr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Lr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}}class n5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Lr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Lr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $n(new ni(s,Dt("disableProviderPing")))}}var i5=Object.defineProperty,s5=Object.defineProperties,o5=Object.getOwnPropertyDescriptors,md=Object.getOwnPropertySymbols,a5=Object.prototype.hasOwnProperty,c5=Object.prototype.propertyIsEnumerable,bd=(n,e,t)=>e in n?i5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Co=(n,e)=>{for(var t in e||(e={}))a5.call(e,t)&&bd(n,t,e[t]);if(md)for(var t of md(e))c5.call(e,t)&&bd(n,t,e[t]);return n},Kc=(n,e)=>s5(n,o5(e));class Vu{constructor(e){this.events=new Iu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||pd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Vu(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Co({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:$t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=J3(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Up)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(tn(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await D3.init({logger:this.providerOpts.logger||pd,relayUrl:this.providerOpts.relayUrl||j3,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Do(t)))];Bc("client",this.client),Bc("events",this.events),Bc("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=k3(t,this.session),o=jp(s),c=W3(this.namespaces,this.optionalNamespaces),l=Kc(Co({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new Q3({namespace:l});break;case"solana":this.rpcProviders[t]=new Z3({namespace:l});break;case"cosmos":this.rpcProviders[t]=new e5({namespace:l});break;case"polkadot":this.rpcProviders[t]=new X3({namespace:l});break;case"cip34":this.rpcProviders[t]=new t5({namespace:l});break;case"elrond":this.rpcProviders[t]=new r5({namespace:l});break;case"multiversx":this.rpcProviders[t]=new n5({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&tn(o)&&this.events.emit("accountsChanged",o.map(Y3))}else s.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Kc(Co({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Kc(Co({},$t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Dn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>Do(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=Do(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${gd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${gd}/${e}`)}}const u5=Vu,h5="wc",l5="ethereum_provider",f5=`${h5}@2:${l5}:`,d5="https://rpc.walletconnect.com/v1/",Eu=["eth_sendTransaction","personal_sign"],p5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Su=["chainChanged","accountsChanged"],g5=["message","disconnect","connect"];var _5=Object.defineProperty,y5=Object.defineProperties,v5=Object.getOwnPropertyDescriptors,wd=Object.getOwnPropertySymbols,m5=Object.prototype.hasOwnProperty,b5=Object.prototype.propertyIsEnumerable,Ed=(n,e,t)=>e in n?_5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fs=(n,e)=>{for(var t in e||(e={}))m5.call(e,t)&&Ed(n,t,e[t]);if(wd)for(var t of wd(e))b5.call(e,t)&&Ed(n,t,e[t]);return n},Sd=(n,e)=>y5(n,v5(e));function Bo(n){return Number(n[0].split(":")[1])}function Gc(n){return`0x${n.toString(16)}`}function w5(n){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:d}=n;if(!tn(e))throw new Error("Invalid chains");const _={chains:e,methods:s||Eu,events:c||Su,rpcMap:fs({},e.length?{[Bo(e)]:d[Bo(e)]}:{})},p=c==null?void 0:c.filter(P=>!Su.includes(P)),w=s==null?void 0:s.filter(P=>!Eu.includes(P));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(w!=null&&w.length))return{required:e.length?_:void 0};const T=(p==null?void 0:p.length)&&(w==null?void 0:w.length)||!t,S={chains:[...new Set(T?_.chains.concat(t||[]):t)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:p5))],events:[...new Set(_.events.concat(l||g5))],rpcMap:d};return{required:e.length?_:void 0,optional:t.length?S:void 0}}class ku{constructor(){this.events=new jr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=f5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new ku;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=w5(this.rpc);try{const o=await new Promise(async(l,d)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Sd(fs({namespaces:fs({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{d(new Error(p.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const c=JE(o.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:Gc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Gc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Sd(fs({},$t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Gc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=o.length?(e==null?void 0:e.methods)||Eu:[],_=o.length?(e==null?void 0:e.events)||Su:[],p=(e==null?void 0:e.optionalMethods)||[],w=(e==null?void 0:e.optionalEvents)||[],T=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),S=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(P=>this.formatChainId(P)),optionalChains:c.map(P=>this.formatChainId(P)),methods:d,events:_,optionalMethods:p,optionalEvents:w,rpcMap:T,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:S,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Bo(this.rpc.chains):Bo(this.rpc.optionalChains),this.signer=await u5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await bm(()=>import("./index-6c915465.js").then(o=>o.i),["assets/index-6c915465.js","assets/index-c9329193.js","assets/index-db7a3c62.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(fs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&tn(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&tn(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${d5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const C5=ku;export{C5 as EthereumProvider,g5 as OPTIONAL_EVENTS,p5 as OPTIONAL_METHODS,Su as REQUIRED_EVENTS,Eu as REQUIRED_METHODS,ku as default};
