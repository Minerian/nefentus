import{r as s,M as H,e as K,j as e,J as X,B as Y,P as R,i as O,K as q,I as C,Q as J,R as Q,W as z,C as Z,S as ee}from"./index-ceef141d.js";import{S as te}from"./signupByEmail-714c1bac.js";import{v as G}from"./vendorDashboardApi-f4cbd3df.js";import"./recaptcha-wrapper-235491ee.js";import"./zod-26008f98.js";import"./error-08a7b626.js";const ae="_card_2tbea_1",se="_imageWrapper_2tbea_7",oe="_image_2tbea_7",re="_overlay_2tbea_22",ce="_icons_2tbea_32",le="_body_2tbea_46",de="_name_2tbea_50",ne="_description_2tbea_55",ie="_price_2tbea_62",ue="_buttonMain_2tbea_68",pe="_button_2tbea_68",me="_modal_2tbea_88",_e="_modalInputs_2tbea_94",be="_modalButtons_2tbea_100",ge="_inputWrapper_2tbea_111",fe="_input_2tbea_111",Pe="_top_2tbea_131",he="_row_2tbea_138",xe="_modalSubtitle_2tbea_161",Se="_inputItem_2tbea_166",l={card:ae,imageWrapper:se,image:oe,overlay:re,icons:ce,body:le,name:de,description:ne,price:ie,buttonMain:ue,button:pe,modal:me,modalInputs:_e,modalButtons:be,inputWrapper:ge,input:fe,top:Pe,row:he,modalSubtitle:xe,inputItem:Se},je="/nefentus/assets/edit-d7a86c72.svg",Me=({onClickDelete:k=()=>{},product:r={},update:y})=>{var n;const[N,f]=s.useState(!1),[P,j]=s.useState(r.name),[h,M]=s.useState(r.description),[p,i]=s.useState(r.price),[m,T]=s.useState(r.stock),[d,D]=s.useState(null),[E,v]=s.useState(!1),[w,x]=s.useState(!1),S=new G,{setInfoMessage:L,setErrorMessage:_,clearMessages:t}=s.useContext(H),{t:a}=K(),$=async()=>{if(!P){_(a("products.error.name"));return}if(!h){_(a("products.error.description"));return}if(!p){_(a("products.error.price"));return}let b=null;b=parseFloat(p),b||_(a("products.error.priceAsFloat"));const I=await S.upsertProduct(r.id,P,h,p,m,d),B=I.id;let F=!0;E&&(d?(console.log("Uploading image for product id: "+B),F=await S.uploadProductImage(B,d)):F=await S.deleteProductImage(B,d),v(!1)),I&&F?r.id!==null?L(a("products.createProductModal.updatedSuccessfully")):L(a("products.createProductModal.addedSuccessfully")):r.id!==null?_(a("products.createProductModal.updateError")):_(a("products.createProductModal.addError")),f(!1),y(),t()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`card ${l.card}`,children:[e.jsxs("div",{className:l.imageWrapper,children:[e.jsxs("div",{className:l.icons,children:[e.jsx("img",{src:je,alt:"Edit product",onClick:()=>f(!0)}),e.jsx("img",{src:X,alt:"Delete product",onClick:k})]}),r.image&&e.jsx("img",{src:r.image,alt:r.title,className:l.image}),e.jsx("div",{className:l.overlay})]}),e.jsxs("div",{className:l.body,children:[e.jsx("div",{className:l.name,children:r.name}),e.jsx("p",{className:l.description,children:r.description}),e.jsxs("p",{className:l.price,children:["$",r.price]}),e.jsx(Y,{link:`${window.location.origin}/product/${r.link}`,children:a("general.open")})]})]}),e.jsxs(R,{show:N,title:a("products.editProduct"),onConfirm:$,onClose:()=>f(!1),confirmTitle:a("general.confirm"),cancelTitle:a("general.cancel"),children:[e.jsx(O,{}),e.jsx("div",{className:l.inputWrapper,children:e.jsxs("div",{className:l.modalInputs,children:[e.jsx(q,{label:a("products.createProductModal.imageLabel"),onUpload:b=>{D(b),v(!0),x(!0)},onDelete:()=>{D(null),v(!0)},value:(n=r==null?void 0:r.s3Key)==null?void 0:n.split("_")[1],dashboard:!0}),e.jsx(C,{dashboard:!0,label:a("products.createProductModal.nameLabel")+"*",placeholder:a("products.createProductModal.namePlaceholder"),value:P,setState:j}),e.jsx(J,{dashboard:!0,label:a("products.createProductModal.descriptionLabel")+"*",placeholder:a("products.createProductModal.descriptionPlaceholder"),value:h,setState:M,rows:2}),e.jsx(C,{dashboard:!0,label:a("products.createProductModal.priceLabel")+"*",placeholder:a("products.createProductModal.pricePlaceholder"),value:p,setState:i,number:!0}),e.jsx(C,{dashboard:!0,label:a("products.createProductModal.stockLabel"),placeholder:a("products.createProductModal.stockPlaceholder"),value:m,setState:T,number:!0})]})})]}),e.jsx(Q,{open:w,file:d,onClose:()=>x(!1),onSave:b=>{x(!1),D(z(b,d.name))}})]})},ve="_titleHeader_10kpr_1",we="_row_10kpr_7",Ie="_modalInputs_10kpr_14",Ce="_modal_10kpr_14",ke="_modalButtons_10kpr_59",ye="_button_10kpr_71",Ne="_buttons_10kpr_82",A={titleHeader:ve,row:we,modalInputs:Ie,modal:Ce,modalButtons:ke,button:ye,buttons:Ne},De=()=>{const[k,r]=s.useState([]),[y,N]=s.useState(""),[f,P]=s.useState(""),[j,h]=s.useState(""),[M,p]=s.useState(""),[i,m]=s.useState(null),[T,d]=s.useState(!1),[D,E]=s.useState(!1),[v,w]=s.useState(!1),[x,S]=s.useState(null),[L,_]=s.useState(!1),{t}=K(),a=new G,{setInfoMessage:$,setErrorMessage:n,clearMessages:b}=s.useContext(H);s.useEffect(()=>{I()},[L]);async function I(){const o=await a.getProducts();if(o){const c=await Promise.all(o.map(u=>a.getSignedImagePath(u.id))),g=o.map((u,W)=>({...u,image:c[W]}));r(g)}}const B=()=>{U(null)},F=async()=>{if(!y){n(t("products.error.name"));return}if(!f){n(t("products.error.description"));return}if(!j){n(t("products.error.price"));return}let o=null;o=parseFloat(j),o||n(t("products.error.priceAsFloat"));let c=M;(M===null||M==="")&&(c=-1);const g=await a.upsertProduct(x,y,f,j,c,i);let u=!0;if(g&&T){const W=g.id;i?(console.log("Uploading image for product id: "+W),u=await a.uploadProductImage(W,i)):u=await a.deleteProductImage(W,i),d(!1)}g&&u?$(t(x!==null?"products.createProductModal.updatedSuccessfully":"products.createProductModal.addedSuccessfully")):n(t(x!==null?"products.createProductModal.updateError":"products.createProductModal.addError")),I(),w(!1)},V=async o=>{await a.deleteProduct(o)?$(t("products.createProductModal.deletedSuccessfully")):n(t("products.createProductModal.deletedError")),I()};function U(o){if(o){const c=k.find(u=>u.id===o);S(o),N(c.name),P(c.description),h(c.price),p(c.stock);let g=null;c.s3Key&&(g=c.s3Key.split("_").pop()),m(g),w("update")}else S(null),N(""),P(""),h(""),p(""),m(null),w("add")}return e.jsxs(e.Fragment,{children:[e.jsx(O,{}),e.jsxs(Z,{children:[e.jsx("div",{className:A.titleHeader,children:e.jsx(ee,{title:t("products.totalProducts"),description:t("products.subtitle1").concat(` ${k.length.toString()} `).concat(t("products.subtitle2")),product:!0,onCreate:B})}),e.jsx("div",{className:A.row,children:k.map(o=>e.jsx(Me,{product:o,onClickEdit:()=>U(o.id),onClickDelete:()=>V(o.id),update:()=>_(!L)},o.id))})]}),e.jsx("div",{children:e.jsxs(R,{show:v,title:t("products.createProductModal.createProduct"),onClose:()=>{b(),w(!1),S(null)},onConfirm:()=>F(),cancelTitle:t("general.cancel"),confirmTitle:t(v==="add"?"general.add":"general.update"),children:[e.jsx(O,{}),e.jsx("div",{className:A.modal,children:e.jsxs("div",{className:A.modalInputs,children:[e.jsx(q,{label:t("products.createProductModal.imageLabel"),onUpload:o=>{m(o),d(!0),E(!0)},onDelete:()=>{m(null),d(!0)},value:i,dashboard:!0}),e.jsx(C,{dashboard:!0,label:t("products.createProductModal.nameLabel")+"*",placeholder:t("products.createProductModal.namePlaceholder"),value:y,setState:N}),e.jsx(J,{dashboard:!0,label:t("products.createProductModal.descriptionLabel")+"*",placeholder:t("products.createProductModal.descriptionPlaceholder"),value:f,setState:P,rows:2}),e.jsx(C,{dashboard:!0,label:t("products.createProductModal.priceLabel")+"*",placeholder:t("products.createProductModal.pricePlaceholder"),value:j,setState:h,number:!0}),e.jsx(C,{dashboard:!0,label:t("products.createProductModal.stockLabel"),placeholder:t("products.createProductModal.stockPlaceholder"),value:M,setState:p,number:!0})]})})]})}),e.jsx(Q,{open:D,file:i,onClose:()=>E(!1),onSave:o=>{E(!1),m(z(o,i.name))}})]})},Ae=()=>e.jsxs("div",{children:[e.jsx(De,{}),e.jsx(te,{})]});export{Ae as default};
